{"version":3,"sources":["webpack:///./src/store.js","webpack:///./src/util.js","webpack:///./src/hash_impl_common.js","webpack:///./src/code_blocks.js","webpack:///./src/py_obj_parsing.js","webpack:///./src/inputs.js","webpack:///./src/common_formatters.js","webpack:///./src/chapter2_hash_table_functions.js","webpack:///./src/new_demos.js","webpack:///./src/icons/_ArrowLeft.js","webpack:///./src/player.js","webpack:///./src/icons/keyboard_arrow_left.svg","webpack:///./src/icons/keyboard_arrow_right.svg","webpack:///./src/icons/pause.svg","webpack:///./src/icons/play_arrow.svg","webpack:///./src/probing_visualization.js","webpack:///./src/chapter1_simplified_hash.js","webpack:///./src/theory.js","webpack:///./src/app.js","webpack:///./src/images/big-logo.svg","webpack:///./src/index.js"],"names":["globalSettings","observable","codePlaySpeed","maxCodePlaySpeed","setCodePlaySpeed","action","speed","console","log","setMaxCodePlaySpeed","maxSpeed","win","width","height","scrollY","jsLoaded","setAll","setScrollY","setWH","w","h","CrossFade","_React$Component","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","value","React","ReactCSSTransitionReplace","transitionName","transitionEnterTimeout","transitionLeaveTimeout","this","props","children","DynamicP","_React$PureComponent","_super2","_this","_defineProperty","_assertThisInitialized","call","setState","highlight","ref","current","getBoundingClientRect","timeoutId","state","resizeReaction","reaction","undefined","className","classNames","MyErrorBoundary","style","minHeight","marginBottom","clearTimeout","setTimeout","removeHighlight","HIGHLIGHT_TIMEOUT","updateHeight","oldKey","newKey","only","firstRender","_objectSpread","DebounceWhenOutOfView","observer","_class","_React$Component2","_super3","DebounceWhenOutOfViewImpl","_extends","_React$Component3","_super4","_this2","childProps","childFunc","updateGeometry","checkDebounceProps","rect","top","window","updateChildProps","DEBOUNCE_TIMEOUT","isVisible","bottom","windowHeight","linebreaks","s","split","map","l","i","concat","flat","MyFallbackComponent","_ref","componentStack","error","backgroundColor","href","message","ErrorBoundary","onError","FallbackComponent","squashUpdates","func","queue","epoch","currentEpoch","push","length","ChapterComponent","_React$Component4","_super5","_this3","_len","args","Array","_key","name","_this4","throttled","incId","setterFuncs","updateStateDebounced","_ref2","idKey","id","_throttle","Subcontainerize","_ref3","_step","accumulatedChildren","res","dropAccumulated","ebCount","wrapEbIfNeeded","child","type","EXTRA_ERROR_BOUNDARY","_iterator","_createForOfIteratorHelper","n","done","FULL_WIDTH","err","e","f","insidePythonDictUxSettings","defaultUxSettings","TIME_SLIDER_THROTTLE_TIME","CODE_SCROLL_DEBOUNCE_TIME","THROTTLE_SELECTION_TRANSITIONS","THROTTLE_SELECTION_TIMEOUT","MAX_CODE_PLAY_SPEED","getUxSettings","singularOrPluralRus","num","singular","plural1","plural2","Error","r100","r10","randint","a","b","Math","round","random","randomChoice","array","floor","randomMeaningfulString","RANDOM_STRINGS","LETTERS","randomString3len","repr","obj","allowNull","isNone","isDummy","BigNumber","isBigNumber","toFixed","JSON","stringify","displayStr","quoteString","toString","Int64","jsNumInt32","JS_NUM_MAX_SIZE","data","signBit","bit","SIZE","other","_carryOverAll","carry","newData","j","sign","complement","inc","decPower","decRes","String","fromCharCode","charCodeAt","join","pyHashStringAndUnicode","magic","mul","xor","eq","toStringDestroying","pyHashUnicode","pyHashLong","twoToPyLong_SHIFT","pow","BASE","_PyHASH_MODULUS","minus","x","lt","negated","digits","gt","d","mod","idiv","reverse","times","plus","modulo","gte","pyHash","o","_hashCode","BreakpointFunction","_breakpoints","_extraBpContext","point","bp","extraBpContext","computeIdx","hashCodeBig","len","HashBreakpointFunction","_BreakpointFunction","DummyClass","NoneClass","DUMMY","None","EQ","o1","o2","computePerturb","hashCode","perturbShift","perturb","renderPythonCode","codeString","lowAst","low","unified","use","rehypestringify","SimpleCodeBlock","dangerouslySetInnerHTML","__html","registerLanguage","pythonHl","library","add","faPlay","faStepForward","faStepBackward","faFastForward","faFastBackward","faPause","faRedoAlt","DEFAULT_BOX_GEOMETRY","boxGeometry","boxSize","boxPadding","spacingX","spacingY","fontSize","borderRadius","labelFontSize","SMALLER_BOX_GEOMETRY","LARGER_BOX_GEOMETRY","computeBoxTransformProperty","idx","y","z","pyObjToReactKey","ActiveBoxSelectionUnthrottled","opacity","_this$props","extraClassName","status","transitionDuration","color","yOffset","classes","borderColor","transform","setInnerRef","ActiveBoxSelectionThrottledHelper","node","transitionId","onTransitionEnd","propsId","_this$props2","handleRef","addEventListener","handleTransitionEnd","once","capture","SingleBoxSelection","restProps","_objectWithoutProperties","_excluded","SelectionGroup","individualSelectionsProps","transitionRunning","transitionStarting","isSelectionThrottled","_this$state","_this$props3","_excluded2","extraProps","TRANSITION_DURATION","handleStartingTransition","_this5","selectionTimeout","min","statusAllowsTransition","Box","_React$PureComponent2","shortenedValue","extraType","test","maxLen","cutCharsCount","substring","isEmpty","content","extraStyle","boxStatus","_this$props4","removedOffset","extraStyleWhenAdding","createdOffset","yRel","classesContent","extraTypeSpan","_this$shortDisplayedS","shortDisplayedString","lineHeight","padding","SlotSelection","_React$PureComponent3","_this$props5","LineOfBoxesSelection","_React$PureComponent4","_super6","_React$createElement","_this$props6","count","BBRecord","ImmutableRecord","modId","box","group","someProps","BaseBoxesComponent","_React$PureComponent5","_super7","_this6","gcModId","max","keyData","activeBoxSelection1","activeBoxSelection1status","activeBoxSelection2","activeBoxSelection2status","lastIdx","lastIdx2","needProcessCreatedAfterRender","needReflow","modificationId","lastBoxId","removingValueToGroupToKeyToId","gcTimeout","staticDebugLogState","_this7","needGarbageCollection","currentModificationId","updateModIdForGC","ANIMATION_DURATION_TIMEOUT","boxes","keys","get","sort","b1","b2","scrollTop","reflow","onExpectedWidthChange","t1","performance","now","_step2","toMerge","_iterator2","entries","_step2$value","_slicedToArray","oldData","mergeDeep","targetModId","updatedCount","_step3","_iterator3","_step3$value","nextProps","mrState","markRemoved","Selection","selectionClass","boxFactory","boxFontSizeOverride","actualGeometry","_step4","_iterator4","_step4$value","newState","nextArray","nextArrayPreConversion","convertNextArray","isImmutableListOrMap","toJS","t2","arrayBoxKeys","getKeys","_step8","_iterator8","_step8$value","_step8$value$","ImmutableMap","lastNextArray","lastNextArrayPreConversion","_step5","nextArrayKeys","newRemovingValueToGroupToKeyToId","asMutable","nextKeysSet","Set","_flatten","_iterator5","_step5$value","has","setIn","newBox","notExistingKeyToData","_step6","_iterator6","_step6$value","_step6$value$","newStatus","notSoDeepDel","keyToRecycledBox","instaRemovedKeys","recycleId","groupOfKeyToId","keyToId","keyWithRecycledId","size","_step7","_iterator7","_step7$value","keySeq","first","potentialKeyToId","getIn","potentialGroupToKeyToId","firstGroup","newKeyData","deleteAll","asImmutable","currentState","gcState","garbageCollect","getOrModSelection","selection","oldIdx","_idx","selectionProps","keyTemplate","_getOrModSelection2","selection1color","idx2","_getOrModSelection4","selection2color","totalTiming","bbTiming","m","e1","e2","e3","subm2","deleteIn","_step9","removed","_iterator9","_step9$value","_i2","_Object$entries","Object","_Object$entries$_i","k","v","warn","ImmutableList","isList","isMap","deepGet","path","_step10","_iterator10","part","TetrisFactory","lines","opts","fixedGeometry","_React$PureComponent6","_super8","Tetris","innerRef","windowWidth","_getExpectedHeight","selectGeometry","_step11","maxBoxSizeIsDefault","_iterator11","line","_React$PureComponent7","_super9","_this8","scrollbarRef","scrollbar","update","_step12","_this9","elems","labels","labelsEnabled","_ref4","_iterator12","_loop","_step12$value","_step12$value$","Component","_step12$value$$","linesData","dataName","idxName","idx2Name","subProps","component","updateScrollbar","tetrisRowMarginBottom","VIS_MARGIN","_Component$getExpecte","getExpectedGeometry","rowMarginBottom","rowHeight","rowsNumber","every","label","index","expectedNumLabels","actualNumLabels","compensateTopPadding","position","SmoothScrollbar","alwaysShowTracks","overflowX","overflow","_sum","_ref6","_ref7","_ref7$","CodeBlockWithActiveLineAndAnnotations","_React$PureComponent8","_super10","_this10","memoizeOne","code","_toConsumableArray","_ref8","_ref9","hlCode","_padEnd","_this10$getScrollTopT","getScrollTopTarget","scrollTopTarget","needsUpdating","ssRef","scrollTo","offset","_debounce","updateScroll","visibleBreakpoints","activeBp","highlightedExplanationContent","hlLines","_highlightLines","isAnyLineHighlighted","bpPoint","explanation","isCurrentLineHighlighted","_visibleBreakpoints$b","prevBp","desc","formatBpDesc","_step13","_iterator13","hlCodeHtml","formattedLine","paddingTop","lineVerticalPadding","paddingBottom","withShortExplanation","_step14","pointToLevel","_iterator14","_step14$value","level","_step15","_iterator15","breakpoints","_step15$value","time","recursionLevel","visibleBpPoint","getVisibleBreakpoints","_this$getCodeWithExpl","getCodeWithExplanationHtmlLines","mobileHeaderTitle","maxHeight","_step16","totalLines","activeLine","_iterator16","_step16$value","_step16$value$","scrollHeight","containerHeight","getSize","container","estimatedLineHeight","activeLinePos","updateScrollDebounced","TimeSliderWithControls","_class2","_super11","_this11","stop","handleTimeChange","userInteracted","autoPlaying","newTime","maxTime","AUTOPLAY_BASE_TIMEOUT","autoPlayNextStep","getAutoplayTimeout","timeoutStarted","unixtimestamp","repeatPlay","Date","getTime","stillDefaultAutoplay","autoplayByDefault","autoPlay","_this12","marks","button","onClick","iconId","FontAwesomeIcon","icon","timeControls","firstStep","prevStep","playIcon","nextStep","lastStep","speedControls","speeds","_loop2","isActive","active","checked","onChange","setSpeed","Slider","handleSliderValueChange","dotStyle","handleStyle","marginTop","railStyle","trackStyle","VisualizedCode","_super12","_this13","userAdjustedToMax","breakpointsUpdatedCounter","throttleTime","handleTimeChangeThrottled","serverSide","smallerFont","codeHeight","StateVisualization","stateVisualization","extraSpace","getExpectedHeight","keepTimeOnNewBreakpoints","bpIdx","comment","HashBoxesComponent","_React$PureComponent9","_super14","_ref10","_ref10$boxGeometry","counterList","CounterList","keyPart","cnt","HashBoxesBrokenComponent","_React$PureComponent10","_super15","MAX_BOXES","_ref11","_ref11$boxGeometry","slice","subValue","counters","Map","counter","set","LineOfBoxesComponent","_React$PureComponent12","_super17","_this$props7","kvHack","_excluded3","getKeysForKVPairs","linesCount","_step17","_iterator17","_step17$value","values","isArray","_step18","currentKeys","_iterator18","_step18$value","_array$i","valuePart","_zip","_ref13","_ref14","_props$boxGeometry","PyParsingError","_Error","text","pos","isStr","textEn","en","_wrapNativeSuper","PyObjParser","literal","c","isWhiteSpaceOrEol","expectedChar","throwErr","skipWhitespace","consume","maybeConsume","textRu","posToInclude","ru","allowedSeparators","fromDict","allowNonesInError","isNextNone","_parseNoneOrThrowUnknownIdentifier","_parseStringOrNumber","startPos","includes","parseNumber","parseString","minSize","consumeWS","_parseStringOrNumberOrNone","allowDuplicates","extraValueValidator","maybeConsumeWS","_this$_parseStringOrN","val","valStartPos","existingVal","originalPos","nonDecimalErrorStringEn","nonDecimalErrorStringRu","isCurrentWhitespaceOrEol","isNaN","quote","next","_checkTrailingChars","parser","parseFunc","checkTrailingChars","parsePyString","parsePyNumber","parsePyList","parseList","parsePyStringOrNumberOrNone","dumpSimplePyObj","dumpPyList","strItems","item","faUndoAlt","ParsableInputBase","event","valueRaw","target","lastError","parseValue","valueId","dumpValue","inputComponentRef","lastScrollLeft","ParsableInputBlock","_ParsableInputBase","scrollLeft","forceUpdate","ctx","document","createElement","getContext","font","_i","_prop","p","getComputedStyle","getPropertyValue","measureText","_this$inputComponentR","clientWidth","charWidth","visibleLeft","ceil","visibleRight","totalVisible","relativePos","_padStart","offsetWidth","errorText","formatErrorMessage","divClassNames","handleChange","onSelect","handleSelect","measureCharWidth","ParsableInputInline","_ParsableInputBase2","_len2","_key2","_this3$state$anotherV","last","anotherValue","bind","lastErrorText","ParsableInputInlineImpl","tryAnotherClick","tryAnotherButtonDiv","inputClassName","Manager","Reference","Popper","placement","arrowProps","data-placement","ParsableInputAutogrowing","_ParsableInputBase3","AutosizeInput","minWidth","ParsableInput","autogrowing","inline","PyListInput","_dumpStringOrNumOrNone","PyNumberInput","_ref5","_excluded4","PyStringInput","_excluded5","PySNNInput","_excluded8","BlockInputToolbar","wrapperRef","bottomBoundary","_excluded9","tallScreen","squareishScreen","Sticky","innerZ","enabled","BlockInputToolbarImpl","offsetHeight","instantUpdates","_updateStack","valuesStack","valuesStackIndex","commitValueIfNecessary","forceSetValue","_step$value","v1","v2","hackyPossibleWorkingDeepEqual","stack","Input","input","undoCount","redoCount","updateDisabled","inputProps","setInputComponentRef","initialValue","handleIUChange","invisible","handleUpdateClick","disabled","handleUndoClick","handleRedoClick","chapter1_2_FormatCheckCollision","fmtCollisionCount","commonFormatCheckCollisionLoopEndedPart","_defaultIsEmpty","commonFormatCheckNotFound","tryN","faTrashAlt","HASH_CREATE_NEW_CODE","ARRAY_CHANCE","MEANINGFUL_CHANCE","NUMBER_CHANCE","roll","HashCreateNew","_HashBreakpointFuncti","_fromKeys","_size","fromKeys","List","hashCodes","addBP","fromKeysIdx","HashCreateNewStateVisualization","formatHashCreateNewAndInsert","HASH_SEARCH_CODE","formatHashRemoveSearch","fmtIsRemove","HashNormalStateVisualization","HashNormalStateVisualizationSmallBoxes","HASH_REMOVE_CODE","HashRemoveOrSearch","_HashBreakpointFuncti2","_hashCodes","_keys","isRemoveMode","isException","result","HASH_RESIZE_CODE","HashResize","_HashBreakpointFuncti3","newHashCodes","newKeys","zip","_step2$value$","formatHashResize","HashResizeStateVisualization","HashInsert","_HashBreakpointFuncti4","HashExamples","string","integer","Ops","hcn","_hcn$run2","run","getBreakpoints","searchedObj","hs","_hs$run","objToRemove","hr","_hr$run","hres","_hres$run2","objToInsert","hi","_hi$run2","ListDescription","countStr","filter","countNum","HashResizeInPlaceAnimation","isStart","buttonIcon","buttonLabel","_this$state$breakpoin","_this$state$breakpoin2","paddingLeft","runAnimation","Chapter2_HashTableFunctions","_ChapterComponent","createNew","hasKey","_Ops$remove","remove","resize","newRes","runCreateNew","searchRes","runSearch","removeRes","runRemove","resizeRes","runResize","trim","setter","BUBBLE_SORT_CODE","BubbleSort","_a","granular","swapped","jplus1","aj","ajplus1","BubbleSortVisualisationFactory","withLabel","formatComparison","num1","num2","QuickSort","_BreakpointFunction4","quickSort","_start","_stop","start","pivot","trunc","left","right","_al","_ar","savedPivot","savedLeft","savedRight","savedStop","savedStart","ArrowLeft","viewBox","fill","xmlns","PlayerInput","errorMsg","ERROR_COLOR","pattern","getPattern","classnames","intValidator","Player","_this2$props","navigatingHome","sliderTime","SLIDER_MULTIPLIER","localStorage","setItem","lessonId","onStateChange","saveSliderTimeToLS","SLIDER_AUTOPLAY_UPDATE_MS","delta","SLIDER_AUTOPLAY_BASE_MS","lastTimeChange","newSliderTime","singleAutoPlayIteration","resetTimer","forceAutoPlay","track","getElementsByClassName","handle","classList","_transitionHackStarted","nodeName","keyCode","isNext","isPrev","isSpace","preventDefault","hackTransition","toggleAutoPlay","showingTheory","timeStr","getItem","inputs","resetToZero","programInputs","originalRawInputs","onInputChangeHandlers","ls","INPUTS_LS_PREFIX","rawValue","_this2$props2","componentRef","removeHackTransition","handleKeyboard","removeEventListener","Redirect","to","codeVisWidth","inputsHeight","playerHeaderStyle","mobileVisWrapperStyle","mobileSliderStyle","totalWidth","MAX_WIDTH","approximateSliderAndControlsHeight","isMobile","expectedVisHeight","playerHeaderTitle","charAt","toUpperCase","display","alignItems","navigateHome","src","border","cursor","d3","assign","require","TINY_PROBING_BOX_GEOMETRY","boxSpacing","ProbingVisualizationImpl","gChild","transitionToBpIdx","nextState","waitForTransition","shouldUpdate","computedHeight","TOP_SPACE","BOTTOM_SPACE","fixedHeight","adjustTop","slotsCount","markerUnits","markerWidth","markerHeight","refX","refY","orient","setRef","links","startBoxIdx","startIdx","linksStartIdx","nextIdxRepeatedAdjustment","nextIdx","transitionTime","oldLinks","oldBoxSize","oldNextIdxRepeatedAdjustment","TRANSITION_TIME","t","transition","duration","lastTransitionId","on","transitionEnd","g","select","lineFunction","curve","curveMonotoneX","boxSizeChanged","rects","selectAll","range","enter","append","attr","merge","arrowLinePoints","i1","i2","repeatedAdj","ystart","yend","ymid","xstartAdjust","xendAdjust","xstart","xend","arrowLinePointsAsArray","getLinkColor","perturbLink","getLinkArrow","updatePaths","enterPaths","exitPaths","exit","end","lp","each","totalLength","getTotalLength","selected","classed","_d2","attrTween","oldEnd","oldRepeatedAdj","oldLp","ip","interpolateArray","d3render","_initOrUpd","selectProbingGeometry","ProbingVisualization","GenerateProbingLinks","_slotsCount","algo","PERTURB_SHIFT","visitedIdx","prevPerturbLink","nIdx","SIMPLE_LIST_SEARCH","_parseSmallInt","chapter1valueRangeValidator","PySmallIntInput","formatSimpleListSearchBreakpointDescription","number","atIdx","found","arg","SimpleListSearchStateVisualization","UnnamedListVisualizationImpl","UnnamedListVisualization","SIMPLIFIED_INSERT_ALL_BROKEN_CODE","SIMPLIFIED_INSERT_ALL_CODE","SimplifiedInsertAll","_overwritten","_originalList","startSize","isBroken","overrideSize","fmtIsBroken","originalList","newList","fmtMissingNumbers","newListWithReplacements","originalListIdx","newListIdx","prevNumber","updateIn","arr","insert","formatSimplifiedInsertAllDescription","SimplifiedInsertStateVisualization","SimplifiedInsertBrokenStateVisualization","SIMPLIFIED_SEARCH_CODE","HideSpanWhenJsLoaded","tag","SimplifiedSearch","_BreakpointFunction2","_newList","_number","formatSimplifiedSearchDescription","SimplifiedSearchStateVisualization","DynamicSimplifiedInsertAllBrokenOverwrittenExample","exampleOverwrite","includedList","originalNumbers","addedNumber","_overwrittenNumbers$","overwrittenNumbers","n1","n2","anStr","numbers","sia","ss","searchedNumber","defaultBPInfo","newBP","extraInfo","simpleListSearch","RANDOM_NUMBER_CHANCE","CHAPTER1_MAXNUM","Chapter1_SimplifiedHash","_this3$runSimplifiedI","runSimplifiedInsertAllBroken","newNumbers","_this3$runSimplifiedI2","createNewBroken","linearSearch","simpleSearchNumber","simplifiedHashSearchNumber","slsRes","runSimpleListSearch","siaBrokenRes","generateAlternativeDataForInsertAllBroken","siaRes","runSimplifiedInsertAll","ssRes","runSimplifiedSearch","probingSimple","runProbingSimple","contents","CollisionsTheory","probingLinks","ProbingVisualizationAndDescription","SimplifiedHashTheory","HashTheory","BubbleSortTheory","QuickSortTheory","getWindowDimensions","documentElement","clientHeight","logViewportStats","innerWidth","innerHeight","vv","visualViewport","_getWindowDimensions","App","dimensions","mounted","handleWindowSizeChange","Router","Switch","Route","Lesson","MainPage","QuickSortVisualisation","BubbleSortVisualisation","chapter1","chapter2","SIMPLIFIED_HASH_ORIGINAL_LIST_INPUT","default","SORTS_LIST_INPUT","HASH_FROM_KEYS_INPUT","LESSONS","bubble_sort","mainPagePaneHeaderTitle","mainPagePaneClassName","mobilePlayerHeaderTitle","bs","runBubbleSort","toNumber","aj1","theory","quick_sort","qs","runQuickSort","simplified_hash_collisions","original_list","simplified_hash_create","simplified_hash_search","hash_create","from_keys","hash_search","_chapter2$runCreateNe","hash_remove","_chapter2$runCreateNe2","hash_resize","_chapter2$runCreateNe3","LessonPane","navigatingPlayer","lesson","navigatePlayer","withRouter","match","params","alt","browser","bowser","getParser","navigator","userAgent","parse","parsedResult","engine","osName","os","platformType","platform","settings","insidePythonDictBrowser","initUxSettings","root","getElementById","ReactDOM","render"],"mappings":"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","file":"main.c98ea796e4162fd75f28.js","sourcesContent":["import {observable, action} from 'mobx';\r\n\r\nexport let globalSettings = observable({\r\n    codePlaySpeed: 1,\r\n    maxCodePlaySpeed: 8,\r\n});\r\n\r\nglobalSettings.setCodePlaySpeed = action(function setCodePlaySpeed(speed) {\r\n    console.log('action setCodePlaySpeed', speed);\r\n    globalSettings.codePlaySpeed = speed;\r\n});\r\n\r\nglobalSettings.setMaxCodePlaySpeed = action(function setCodePlaySpeed(maxSpeed) {\r\n    console.log('action setMaxCodePlaySpeed', maxSpeed);\r\n    globalSettings.maxCodePlaySpeed = maxSpeed;\r\n});\r\n\r\nexport let win = observable({\r\n    width: null,\r\n    height: null,\r\n    scrollY: 0,\r\n    jsLoaded: false,\r\n});\r\n\r\nwin.setAll = action(function(width, height, scrollY, jsLoaded) {\r\n    win.width = width;\r\n    win.height = height;\r\n    win.scrollY = scrollY;\r\n    win.jsLoaded = jsLoaded;\r\n});\r\n\r\nwin.setScrollY = action(function setScrollY(scrollY) {\r\n    win.scrollY = scrollY;\r\n});\r\n\r\nwin.setWH = action(function setWH(w, h) {\r\n    console.log('setWH', w, h);\r\n    win.width = w;\r\n    win.height = h;\r\n});\r\n","import _ from 'lodash';\r\nimport * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport {reaction} from 'mobx';\r\nimport {win} from './store';\r\n\r\nimport classNames from 'classnames';\r\n\r\nimport {ErrorBoundary} from 'react-error-boundary';\r\nimport bowser from 'bowser';\r\nimport ReactCSSTransitionReplace from 'react-css-transition-replace';\r\n\r\nexport const OLIVE = '#3D9970';\r\nexport const RED = '#FF4136';\r\nexport const BLUE = '#0074D9';\r\n\r\nexport const COLOR_FOR_READ_OPS = '#13920b';\r\n\r\nexport function doubleRAF(callback) {\r\n    window.requestAnimationFrame(() => {\r\n        window.requestAnimationFrame(callback);\r\n    });\r\n}\r\n\r\nexport class CrossFade extends React.Component {\r\n    render() {\r\n        return (\r\n            <ReactCSSTransitionReplace\r\n                transitionName=\"cross-fade\"\r\n                transitionEnterTimeout={200}\r\n                transitionLeaveTimeout={200}\r\n            >\r\n                {this.props.children}\r\n            </ReactCSSTransitionReplace>\r\n        );\r\n    }\r\n}\r\n\r\nexport class DynamicP extends React.PureComponent {\r\n    HIGHLIGHT_TIMEOUT = 1500;\r\n\r\n    // TODO: hacky margin hack\r\n    constructor() {\r\n        super();\r\n        this.ref = React.createRef();\r\n        this.timeoutId = null;\r\n        this.state = {highlight: false, key: null};\r\n\r\n        this.resizeReaction = reaction(() => win.width, () => this.setState({height: undefined}));\r\n    }\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n        const oldKey = state.key;\r\n        const newKey = React.Children.only(props.children).key;\r\n        // CrossFade / ReactCSSTransitionReplace relies on key changing\r\n        if (oldKey !== newKey) {\r\n            const firstRender = oldKey == null;\r\n            return {...state, key: newKey, highlight: !firstRender};\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const className = classNames('dynamic-p-inner-wrapper', {highlight: this.state.highlight});\r\n        return (\r\n            <MyErrorBoundary>\r\n                <div className={className} ref={this.ref} style={{minHeight: this.state.height}}>\r\n                    <CrossFade>{this.props.children}</CrossFade>\r\n                </div>\r\n                <div style={{marginBottom: 16}} />\r\n            </MyErrorBoundary>\r\n        );\r\n    }\r\n\r\n    removeHighlight = () => {\r\n        this.setState({\r\n            highlight: false,\r\n        });\r\n    };\r\n\r\n    updateHeight = () => {\r\n        const {height} = this.ref.current.getBoundingClientRect();\r\n        this.setState({height});\r\n    };\r\n\r\n    componentDidUpdate() {\r\n        if (this.state.highlight) {\r\n            if (this.timeoutId != null) {\r\n                clearTimeout(this.timeoutId);\r\n            }\r\n            this.timeoutId = setTimeout(this.removeHighlight, this.HIGHLIGHT_TIMEOUT);\r\n        }\r\n        this.updateHeight();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.updateHeight();\r\n    }\r\n}\r\n\r\n@observer\r\nexport class DebounceWhenOutOfView extends React.Component {\r\n    render() {\r\n        return <DebounceWhenOutOfViewImpl {...this.props} scrollY={win.scrollY} />;\r\n    }\r\n}\r\n\r\nconst LEEWAY_Y = 100;\r\nclass DebounceWhenOutOfViewImpl extends React.Component {\r\n    DEBOUNCE_TIMEOUT = 500;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.ref = React.createRef();\r\n        this.timeoutId = null;\r\n\r\n        this.state = {};\r\n    }\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n        let isVisible;\r\n        if (state.height != null && state.top != null) {\r\n            const top = state.top;\r\n            const bottom = state.top + state.height;\r\n            const {windowHeight, scrollY} = props;\r\n            isVisible =\r\n                (scrollY - LEEWAY_Y <= top && top <= scrollY + windowHeight + LEEWAY_Y) ||\r\n                (scrollY - LEEWAY_Y <= bottom && bottom <= scrollY + windowHeight + LEEWAY_Y);\r\n        }\r\n\r\n        if (isVisible == null || state.isVisible == null || isVisible || state.isVisible) {\r\n            return {\r\n                isVisible,\r\n                childProps: props.childProps,\r\n            };\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const childProps = this.state.childProps;\r\n        return this.props.childFunc(childProps, this.ref);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.updateGeometry();\r\n        this.checkDebounceProps();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.updateGeometry();\r\n        this.checkDebounceProps();\r\n    }\r\n\r\n    updateGeometry() {\r\n        const node = this.ref.current;\r\n        const rect = node.getBoundingClientRect();\r\n        const {height} = rect;\r\n        const top = window.scrollY + rect.top;\r\n        console.log('DebounceWhenOutOfView updateGeometry top', top);\r\n        this.setState(state => {\r\n            if (state.height !== height || state.top !== top) {\r\n                return {height, top};\r\n            } else {\r\n                return null;\r\n            }\r\n        });\r\n    }\r\n\r\n    updateChildProps = () => {\r\n        const childProps = this.props.childProps;\r\n        this.setState(state => {\r\n            if (childProps !== state.childProps) {\r\n                return {\r\n                    childProps,\r\n                };\r\n            } else {\r\n                return null;\r\n            }\r\n        });\r\n    };\r\n\r\n    checkDebounceProps() {\r\n        if (this.timeoutId) {\r\n            clearTimeout(this.timeoutId);\r\n        }\r\n        if (this.props.childProps !== this.state.childProps) {\r\n            this.timeoutId = setTimeout(this.updateChildProps, this.DEBOUNCE_TIMEOUT);\r\n        }\r\n    }\r\n}\r\n\r\nfunction linebreaks(s) {\r\n    return s\r\n        .split('\\n')\r\n        .map((l, i) => [l, <br key={`br-${i}`} />])\r\n        .flat();\r\n}\r\n\r\nfunction MyFallbackComponent({componentStack, error}) {\r\n    return (\r\n        <div style={{backgroundColor: 'pink'}}>\r\n            <h3 className=\"text-danger\">\r\n                An error occured. This should not happen. Please file a bug report{' '}\r\n                <a href=\"https://github.com/eleweek/inside_python_dict\">on github</a>{' '}\r\n            </h3>\r\n            <p>{linebreaks(error.message)}</p>\r\n            <h6 className=\"text-danger\">Component stack</h6>\r\n            <p>{linebreaks(componentStack)}</p>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport function MyErrorBoundary(props) {\r\n    const onError = (error, componentStack) => {\r\n        console.error('ErrorBoundary caught error\\n\\n', error, '\\n\\n\\nComponent stack', componentStack);\r\n    };\r\n\r\n    return (\r\n        <ErrorBoundary onError={onError} FallbackComponent={MyFallbackComponent}>\r\n            {props.children}\r\n        </ErrorBoundary>\r\n    );\r\n}\r\n\r\n// TODO: This does not seem to be better than _.debounce(..., 0)\r\n// TODO: should probably get rid of this function and use debounce()\r\nfunction squashUpdates(func) {\r\n    let queue = [];\r\n    let epoch = 0;\r\n    return value => {\r\n        let currentEpoch = epoch;\r\n        queue.push(value);\r\n        setTimeout(() => {\r\n            if (queue.length > 0 && currentEpoch === epoch) {\r\n                func(queue[queue.length - 1]);\r\n                queue = [];\r\n                epoch++;\r\n            }\r\n        }, 0);\r\n    };\r\n}\r\n\r\nexport class ChapterComponent extends React.Component {\r\n    setterFuncs = {};\r\n\r\n    setter(name, throttled = false, incId = false) {\r\n        if (!(name in this.setterFuncs)) {\r\n            let updateState;\r\n            if (!incId) {\r\n                updateState = value => this.setState({[name]: value});\r\n            } else {\r\n                updateState = value =>\r\n                    this.setState(state => {\r\n                        const idKey = `${name}IdHack`;\r\n                        let id = state[idKey];\r\n                        id++;\r\n                        return {[name]: value, [idKey]: id};\r\n                    });\r\n            }\r\n            const updateStateDebounced = squashUpdates(updateState);\r\n            if (throttled) {\r\n                this.setterFuncs[name] = _.throttle(updateStateDebounced, 50);\r\n            } else {\r\n                this.setterFuncs[name] = updateStateDebounced;\r\n            }\r\n        }\r\n        return this.setterFuncs[name];\r\n    }\r\n}\r\n\r\nexport function Subcontainerize({children}) {\r\n    let accumulatedChildren = [];\r\n    let res = [];\r\n    const dropAccumulated = () => {\r\n        if (accumulatedChildren.length > 0) {\r\n            res.push(\r\n                <div className=\"subcontainer\" key={`subcontainer-${res.length}`}>\r\n                    {accumulatedChildren}\r\n                </div>\r\n            );\r\n            accumulatedChildren = [];\r\n        }\r\n    };\r\n    let ebCount = 0;\r\n    const wrapEbIfNeeded = child => {\r\n        if (child.type && child.type.EXTRA_ERROR_BOUNDARY) {\r\n            return <MyErrorBoundary key={child.key || `subcontainerize-eb-${++ebCount}`}>{child}</MyErrorBoundary>;\r\n        } else {\r\n            return child;\r\n        }\r\n    };\r\n\r\n    for (let child of children) {\r\n        if (typeof child.type === 'string' || typeof child.type === 'undefined' || !child.type.FULL_WIDTH) {\r\n            accumulatedChildren.push(wrapEbIfNeeded(child));\r\n        } else {\r\n            dropAccumulated();\r\n            res.push(wrapEbIfNeeded(child));\r\n        }\r\n    }\r\n\r\n    dropAccumulated();\r\n\r\n    return res;\r\n}\r\n\r\nexport class BootstrapAlert extends React.Component {\r\n    ALERT_REMOVAL_TIMEOUT = 150;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.state = {\r\n            dismissed: false,\r\n            dismissedDone: false,\r\n        };\r\n    }\r\n\r\n    dismiss = () => {\r\n        this.setState({dismissed: true});\r\n        setTimeout(() => this.setState({dismissedDone: true}), this.ALERT_REMOVAL_TIMEOUT);\r\n    };\r\n\r\n    render() {\r\n        let {hide, sticky, alertType, boldText, regularText} = this.props;\r\n        alertType = alertType || 'warning';\r\n\r\n        if (!this.state.dismissedDone) {\r\n            return (\r\n                <div\r\n                    className={classNames(\r\n                        'alert',\r\n                        `alert-${alertType}`,\r\n                        {'alert-dismissible': !this.props.nondismissible},\r\n                        'fade',\r\n                        {'force-stick-to-top': sticky && !hide},\r\n                        {show: !this.state.dismissed && !hide},\r\n                        this.props.extraclassName\r\n                    )}\r\n                >\r\n                    {this.props.children}\r\n                    {!this.props.nondismissible ? (\r\n                        <button type=\"button\" className=\"close\" onClick={this.dismiss}>\r\n                            <span>&times;</span>\r\n                        </button>\r\n                    ) : null}\r\n                </div>\r\n            );\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n}\r\n\r\nconst defaultUxSettings = {\r\n    TIME_SLIDER_THROTTLE_TIME: 50,\r\n    CODE_SCROLL_DEBOUNCE_TIME: 200,\r\n    THROTTLE_SELECTION_TRANSITIONS: true,\r\n    THROTTLE_SELECTION_TIMEOUT: 150,\r\n    MAX_CODE_PLAY_SPEED: 8,\r\n};\r\n\r\nlet insidePythonDictUxSettings;\r\n\r\nexport function initUxSettings() {\r\n    const browser = bowser.getParser(window.navigator.userAgent).parse().parsedResult;\r\n    console.log('Detected browser', browser);\r\n\r\n    const engine = browser.engine.name;\r\n    const osName = browser.os.name;\r\n    const platformType = browser.platform.type;\r\n    console.log('Detected engine', engine, 'on', osName);\r\n    let settings = {...defaultUxSettings};\r\n\r\n    // 'Throttling' transitions for selection is important because they can be buggy as heck\r\n    // The problem is jumpiness (if transform: translate(...) is changed while transition is running, it resets)\r\n    // This works fine in Chrome/Blink-based browsers\r\n    // (I think there is a similar problem for boxes, but it is less acute, because boxes transitions are longer)\r\n    switch (engine) {\r\n        case 'Blink':\r\n            settings.THROTTLE_SELECTION_TRANSITIONS = false;\r\n            settings.THROTTLE_SELECTION_TIMEOUT = 0;\r\n            break;\r\n        case 'Gecko': {\r\n            settings.THROTTLE_SELECTION_TRANSITIONS = true;\r\n            switch (osName) {\r\n                // Somehow Firefox doesn't do this stuff nearly as bad on Linux\r\n                case 'Linux':\r\n                    settings.THROTTLE_SELECTION_TIMEOUT = 125;\r\n                    break;\r\n                // It seems to be as bad on macOS as on Windows (maybe somewhat worse on macOS)\r\n                // It's pretty bad on mobile too\r\n                case 'macOS':\r\n                    settings.THROTTLE_SELECTION_TIMEOUT = 'transitionend';\r\n                    break;\r\n                default:\r\n                    settings.THROTTLE_SELECTION_TIMEOUT = 275; // almost 'transitionend'\r\n                    break;\r\n            }\r\n            break;\r\n        }\r\n        case 'EdgeHTML':\r\n            settings.THROTTLE_SELECTION_TRANSITIONS = true;\r\n            // 150 is kind of ok, but 225-275 seems better\r\n            settings.THROTTLE_SELECTION_TIMEOUT = 250;\r\n            break;\r\n        case 'WebKit': {\r\n            settings.THROTTLE_SELECTION_TRANSITIONS = true;\r\n            switch (osName) {\r\n                case 'Linux':\r\n                    settings.THROTTLE_SELECTION_TIMEOUT = 150;\r\n                    break;\r\n                case 'macOS':\r\n                    settings.THROTTLE_SELECTION_TIMEOUT = 'transitionend';\r\n                    break;\r\n                default:\r\n                    settings.THROTTLE_SELECTION_TIMEOUT = 275;\r\n                    break;\r\n            }\r\n            break;\r\n        }\r\n    }\r\n\r\n    switch (engine) {\r\n        case 'Blink':\r\n        case 'WebKit':\r\n            // kind of ended up optimizing for chrome\r\n            settings.TIME_SLIDER_THROTTLE_TIME = null;\r\n            settings.CODE_SCROLL_DEBOUNCE_TIME = 150;\r\n            settings.MAX_CODE_PLAY_SPEED = 16;\r\n            break;\r\n        case 'Gecko':\r\n            settings.TIME_SLIDER_THROTTLE_TIME = null;\r\n            // Firefox doesn't seems to tolerate auto-scrolling\r\n            settings.CODE_SCROLL_DEBOUNCE_TIME = 200;\r\n            break;\r\n    }\r\n\r\n    if (platformType === 'mobile') {\r\n        settings.MAX_CODE_PLAY_SPEED = Math.min(settings.MAX_CODE_PLAY_SPEED, 8);\r\n    }\r\n\r\n    insidePythonDictUxSettings = settings;\r\n    window.insidePythonDictBrowser = browser;\r\n    console.log('UX settings', getUxSettings());\r\n}\r\n\r\nexport function getUxSettings() {\r\n    if (typeof window === 'undefined' || !insidePythonDictUxSettings) {\r\n        return defaultUxSettings;\r\n    }\r\n    return insidePythonDictUxSettings;\r\n}\r\n\r\nexport function singularOrPlural(num, singular, plural) {\r\n    return num === 1 ? singular : plural;\r\n}\r\n\r\nexport function singularOrPluralRus(num, singular, plural1, plural2) {\r\n    if (num < 0) {\r\n        throw new Error('Negative number');\r\n    }\r\n    const r100 = num % 100;\r\n    if (10 <= r100 && r100 <= 20) {\r\n        return plural2;\r\n    }\r\n\r\n    if (r100 % 10 === 1) {\r\n        return singular;\r\n    }\r\n\r\n    const r10 = r100 % 10;\r\n    if (2 <= r10 && r10 <= 4) {\r\n        return plural1;\r\n    }\r\n\r\n    return plural2;\r\n}\r\n\r\nexport function randint(a, b) {\r\n    if (b <= a) {\r\n        throw new Error(`randInt called with b (${b}) <= a (${a})`);\r\n    }\r\n    // TODO: check round/floor/ceil stuff\r\n    // since it may not generate uniformly distributed numbers\r\n    return a + Math.round(Math.random() * (b - a + 1));\r\n}\r\n\r\nexport function randomChoice(array) {\r\n    // TODO: check rounding\r\n    return array[Math.floor(Math.random() * array.length)];\r\n}\r\n\r\nexport function randomMeaningfulString() {\r\n    return randomChoice(RANDOM_STRINGS);\r\n}\r\n\r\nconst LETTERS = 'abcdefghijklmnopqrstuvwxyz';\r\n\r\nexport function randomString3len() {\r\n    return randomChoice(LETTERS) + randomChoice(LETTERS) + randomChoice(LETTERS);\r\n}\r\n\r\nexport const isClient = process.env.NODE_ENV !== 'ssr';\r\n\r\n// This is useful for set first few values of a random()-like function\r\n// Useful for SSR\r\nexport function fixFirstValues(func, values) {\r\n    let calledCounter = 0;\r\n    return function() {\r\n        let res;\r\n        if (calledCounter < values.length) {\r\n            res = values[calledCounter];\r\n        } else {\r\n            res = func.apply(null, arguments);\r\n        }\r\n\r\n        calledCounter++;\r\n\r\n        return res;\r\n    };\r\n}\r\n\r\nexport function isDefinedSmallBoxScreen(windowWidth, windowHeight) {\r\n    return windowWidth && windowHeight && (windowWidth < 950 || windowHeight < 520);\r\n}\r\n\r\nconst RANDOM_STRINGS = [\r\n    'bash',\r\n    'cat',\r\n    'chmod',\r\n    'cp',\r\n    'date',\r\n    'df',\r\n    'echo',\r\n    'ed',\r\n    'expr',\r\n    'link',\r\n    'ls',\r\n    'mkdir',\r\n    'mv',\r\n    'ps',\r\n    'pwd',\r\n    'rm',\r\n    'rmdir',\r\n    'sh',\r\n    'sleep',\r\n    'test',\r\n    'zsh',\r\n    'alias',\r\n    'apply',\r\n    'at',\r\n    'atrm',\r\n    'awk',\r\n    'batch',\r\n    'bg',\r\n    'bzip2',\r\n    'cd',\r\n    'clear',\r\n    'cmp',\r\n    'curl',\r\n    'cut',\r\n    'diff',\r\n    'dig',\r\n    'du',\r\n    'egrep',\r\n    'env',\r\n    'ex',\r\n    'fg',\r\n    'file',\r\n    'find',\r\n    'grep',\r\n    'grn',\r\n    'gzip',\r\n    'head',\r\n    'iconv',\r\n    'less',\r\n    'make',\r\n    'more',\r\n    'nc',\r\n    'open',\r\n    'sed',\r\n    'sort',\r\n    'ssh',\r\n    'stat',\r\n    'sudo',\r\n    'tail',\r\n    'tar',\r\n    'tee',\r\n    'time',\r\n    'top',\r\n    'tr',\r\n    'uname',\r\n    'uniq',\r\n    'unzip',\r\n    'wc',\r\n    'whois',\r\n    'xxd',\r\n    'yes',\r\n];\r\n","import {BigNumber} from 'bignumber.js';\r\nimport _ from 'lodash';\r\n\r\nexport function repr(obj, allowNull = false) {\r\n    let res;\r\n    if (typeof obj === 'number') {\r\n        res = ['int', obj];\r\n    } else if (typeof obj === 'string') {\r\n        res = ['string', obj];\r\n    } else if (isNone(obj)) {\r\n        res = ['none'];\r\n    } else if (isDummy(obj)) {\r\n        res = ['dummy'];\r\n    } else if (BigNumber.isBigNumber(obj)) {\r\n        res = ['bignumber.js', obj.toFixed()];\r\n    } else if (obj === null && allowNull) {\r\n        res = ['jsnull', obj];\r\n    } else {\r\n        throw new Error(`Unknown key: ${JSON.stringify(obj)}`);\r\n    }\r\n\r\n    return JSON.stringify(res);\r\n}\r\n\r\nexport function displayStr(obj, quoteString = true) {\r\n    if (typeof obj === 'number' || isNone(obj) || isDummy(obj)) {\r\n        return obj.toString();\r\n    } else if (BigNumber.isBigNumber(obj)) {\r\n        return obj.toFixed();\r\n    } else if (typeof obj === 'string') {\r\n        if (quoteString) {\r\n            return JSON.stringify(obj);\r\n        } else {\r\n            return obj;\r\n        }\r\n    } else {\r\n        throw new Error(`Unknown key: ${JSON.stringify(obj)}`);\r\n    }\r\n}\r\n\r\nclass Int64 {\r\n    SIZE = 64;\r\n    JS_NUM_MAX_SIZE = 32;\r\n\r\n    constructor(jsNumInt32 = 0) {\r\n        this.JS_NUM_MAX_SIZE = 32;\r\n\r\n        this.data = [];\r\n        let signBit = jsNumInt32 >= 0 ? 0 : 1;\r\n\r\n        for (let i = 0; i < this.JS_NUM_MAX_SIZE; ++i) {\r\n            let bit = jsNumInt32 & (1 << i) ? 1 : 0;\r\n            this.data.push(bit);\r\n        }\r\n\r\n        for (let i = this.JS_NUM_MAX_SIZE; i < this.SIZE; ++i) {\r\n            this.data.push(signBit);\r\n        }\r\n    }\r\n\r\n    xor(other) {\r\n        for (let i = 0; i < this.SIZE; ++i) {\r\n            this.data[i] ^= other.data[i];\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    sign() {\r\n        return this.data[this.data.length - 1] == 1 ? -1 : 1;\r\n    }\r\n\r\n    inc() {\r\n        this.data[0] += 1;\r\n        this._carryOverAll();\r\n    }\r\n\r\n    eq(other) {\r\n        for (let i = 0; i < this.SIZE; ++i) {\r\n            if (this.data[i] != other.data[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    add(other) {\r\n        let carry = 0;\r\n        for (let i = 0; i < this.SIZE; ++i) {\r\n            this.data[i] += other.data[i] + carry;\r\n            carry = (this.data[i] / 2) | 0;\r\n            this.data[i] %= 2;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    complement() {\r\n        for (let i = 0; i < this.SIZE; ++i) {\r\n            this.data[i] = this.data[i] == 0 ? 1 : 0;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    mul(other) {\r\n        let newData = [];\r\n\r\n        for (let i = 0; i < this.SIZE; ++i) {\r\n            newData[i] = 0;\r\n        }\r\n\r\n        for (let i = 0; i < this.SIZE; ++i) {\r\n            if (this.data[i] === 0) {\r\n                continue;\r\n            }\r\n\r\n            for (let j = 0; j < this.SIZE - i; ++j) {\r\n                newData[i + j] += this.data[i] * other.data[j];\r\n            }\r\n        }\r\n\r\n        this.data = newData;\r\n        this._carryOverAll();\r\n\r\n        return this;\r\n    }\r\n\r\n    toNumber() {\r\n        let res = 0;\r\n        for (let i = 0; i < 32; ++i) {\r\n            if (this.data[i]) {\r\n                res |= 1 << i;\r\n            }\r\n        }\r\n\r\n        return res;\r\n    }\r\n\r\n    toStringDestroying() {\r\n        let sign = this.sign();\r\n        if (sign < 0) {\r\n            this.complement().inc();\r\n        }\r\n\r\n        let decPower = [1];\r\n        let decRes = [0];\r\n        for (let i = 0; i < this.SIZE; ++i) {\r\n            let carry = 0;\r\n            if (this.data[i]) {\r\n                for (let j = 0; j < decPower.length; ++j) {\r\n                    if (j >= decRes.length) decRes.push(0);\r\n\r\n                    decRes[j] += decPower[j] + carry;\r\n                    carry = (decRes[j] / 10) | 0;\r\n                    decRes[j] %= 10;\r\n                }\r\n            }\r\n            if (carry) {\r\n                decRes.push(carry);\r\n            }\r\n\r\n            carry = 0;\r\n            for (let j = 0; j < decPower.length; ++j) {\r\n                decPower[j] = decPower[j] * 2 + carry;\r\n                carry = (decPower[j] / 10) | 0;\r\n                decPower[j] %= 10;\r\n            }\r\n            if (carry) {\r\n                decPower.push(carry);\r\n            }\r\n        }\r\n\r\n        this.data = null;\r\n\r\n        let res = [];\r\n        if (sign < 0) res.push('-');\r\n        for (let j = decRes.length - 1; j >= 0; j--) {\r\n            res.push(String.fromCharCode('0'.charCodeAt(0) + decRes[j]));\r\n        }\r\n\r\n        return res.join('');\r\n    }\r\n\r\n    _carryOverAll() {\r\n        let carry = 0;\r\n        for (let i = 0; i < this.SIZE; ++i) {\r\n            this.data[i] += carry;\r\n            carry = (this.data[i] / 2) | 0;\r\n            this.data[i] %= 2;\r\n        }\r\n    }\r\n}\r\n\r\nfunction pyHashStringAndUnicode(s) {\r\n    let res = new Int64(s.charCodeAt(0) << 7);\r\n    let magic = new Int64(1000003);\r\n\r\n    for (let i = 0; i < s.length; ++i) {\r\n        res.mul(magic).xor(new Int64(s.charCodeAt(i)));\r\n    }\r\n\r\n    res.xor(new Int64(s.length));\r\n\r\n    if (res.eq(new Int64(-1))) {\r\n        return '-2';\r\n    } else {\r\n        return res.toStringDestroying();\r\n    }\r\n}\r\n\r\nexport function pyHashString(s) {\r\n    let sUtf8 = unescape(encodeURIComponent(s));\r\n    return pyHashStringAndUnicode(sUtf8);\r\n}\r\n\r\nexport function pyHashUnicode(s) {\r\n    return pyHashStringAndUnicode(s);\r\n}\r\n\r\nexport function pyHashLong(num) {\r\n    const twoToPyLong_SHIFT = BigNumber(2).pow(30);\r\n    const BASE = twoToPyLong_SHIFT;\r\n    const _PyHASH_MODULUS = BigNumber(2)\r\n        .pow(61)\r\n        .minus(1);\r\n\r\n    let x = BigNumber(0);\r\n    let sign = 1;\r\n    if (num.lt(0)) {\r\n        sign = -1;\r\n        num = num.negated();\r\n    }\r\n\r\n    let digits = [];\r\n    while (num.gt(0)) {\r\n        const d = num.mod(BASE);\r\n        num = num.idiv(BASE);\r\n        digits.push(d);\r\n    }\r\n\r\n    for (const d of digits.reverse()) {\r\n        x = x\r\n            .times(twoToPyLong_SHIFT)\r\n            .plus(d)\r\n            .modulo(_PyHASH_MODULUS);\r\n    }\r\n\r\n    if (sign < 0) {\r\n        x = x.negated();\r\n    }\r\n    if (x.gte(BigNumber(2).pow(63))) {\r\n        x = BigNumber(2)\r\n            .pow(64)\r\n            .minus(x);\r\n    }\r\n\r\n    if (x.eq(-1)) {\r\n        x = BigNumber(-2);\r\n    }\r\n\r\n    return x;\r\n}\r\n\r\nexport function pyHash(o) {\r\n    if (typeof o === 'string') {\r\n        return BigNumber(pyHashUnicode(o));\r\n    } else if (typeof o === 'number') {\r\n        // TODO:\r\n        // throw new Error(`Plain JS numbers are not supported, use BigNumber`)\r\n        return pyHashLong(BigNumber(o));\r\n    } else if (BigNumber.isBigNumber(o)) {\r\n        return pyHashLong(o);\r\n    } else if (isNone(o)) {\r\n        // TODO: for None hash seems to be always different\r\n        return BigNumber(o._hashCode);\r\n    } else {\r\n        throw new Error('pyHash called with an object of unknown type: ' + JSON.stringify(o));\r\n    }\r\n}\r\n\r\nexport class BreakpointFunction {\r\n    constructor() {\r\n        this._breakpoints = [];\r\n        this._extraBpContext = null;\r\n    }\r\n\r\n    addBP(point) {\r\n        let bp = {\r\n            point: point,\r\n        };\r\n\r\n        for (let key in this) {\r\n            if (key[0] !== '_') {\r\n                const value = this[key];\r\n                if (value !== undefined && typeof value !== 'function') {\r\n                    bp[key] = value;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this._extraBpContext) {\r\n            for (let key in this._extraBpContext) {\r\n                bp[key] = this._extraBpContext[key];\r\n            }\r\n        }\r\n\r\n        this._breakpoints.push(bp);\r\n    }\r\n\r\n    setExtraBpContext(extraBpContext) {\r\n        this._extraBpContext = extraBpContext;\r\n    }\r\n\r\n    getBreakpoints() {\r\n        return this._breakpoints;\r\n    }\r\n}\r\n\r\nexport function joinBreakpoints(breakpointsList, prefixes) {\r\n    const bps = [];\r\n    const maxTime = Math.max(...breakpointsList.map(l => l.length));\r\n    for (let i = 0; i < maxTime; ++i) {\r\n        const newBp = {};\r\n        for (const [breakpoints, prefix] of _.zip(breakpointsList, prefixes)) {\r\n            const bp = breakpoints[Math.min(i, breakpoints.length - 1)];\r\n            for (let key in bp) {\r\n                newBp[prefix + '_' + key] = bp[key];\r\n            }\r\n        }\r\n        bps.push(newBp);\r\n    }\r\n    console.log(bps);\r\n    return bps;\r\n}\r\n\r\nexport function computeIdx(hashCodeBig, len) {\r\n    return +hashCodeBig\r\n        .mod(len)\r\n        .plus(len)\r\n        .mod(len)\r\n        .toString();\r\n}\r\n\r\nexport class HashBreakpointFunction extends BreakpointFunction {\r\n    computeIdx(hashCodeBig, len) {\r\n        return computeIdx(hashCodeBig, len);\r\n    }\r\n}\r\n\r\nclass DummyClass {\r\n    toString() {\r\n        return 'DUMMY';\r\n    }\r\n}\r\n\r\nclass NoneClass {\r\n    _hashCode = '-9223372036581563745';\r\n\r\n    toString() {\r\n        return 'None';\r\n    }\r\n}\r\n\r\nexport const DUMMY = new DummyClass();\r\nexport const None = new NoneClass();\r\n\r\nexport function isNone(o) {\r\n    return o instanceof NoneClass;\r\n}\r\n\r\nexport function isDummy(o) {\r\n    return o instanceof DummyClass;\r\n}\r\n\r\nexport function EQ(o1, o2) {\r\n    if (BigNumber.isBigNumber(o1) && (BigNumber.isBigNumber(o2) || typeof o2 === 'number')) {\r\n        return o1.eq(o2);\r\n    } else if (BigNumber.isBigNumber(o2) && typeof o1 === 'number') {\r\n        return o2.eq(o1);\r\n    }\r\n\r\n    return o1 === o2;\r\n}\r\n\r\nfunction signedToUnsigned(num) {\r\n    if (num.lt(0)) {\r\n        return num.plus(BigNumber(2).pow(64));\r\n    } else {\r\n        return num;\r\n    }\r\n}\r\n\r\nexport function computePerturb(hashCode) {\r\n    return signedToUnsigned(hashCode);\r\n}\r\n\r\nexport function nextIdxPerturb(idx, perturb, size) {\r\n    return +BigNumber(5 * idx + 1)\r\n        .plus(perturb)\r\n        .mod(size)\r\n        .toString();\r\n}\r\n\r\nexport function perturbShift(perturb) {\r\n    return perturb.idiv(BigNumber(2).pow(5)); // >>= 5\r\n}\r\n","import _ from 'lodash';\nimport classNames from 'classnames';\nimport memoizeOne from 'memoize-one';\nimport * as React from 'react';\n\nimport {BigNumber} from 'bignumber.js';\n\nimport low from 'lowlight/lib/core';\n\nimport unified from 'unified';\nimport rehypestringify from 'rehype-stringify';\n\nimport pythonHl from 'highlight.js/lib/languages/python';\nlow.registerLanguage('python', pythonHl);\n\nimport HighLightJStyle from 'highlight.js/styles/default.css';\n\nimport Slider from 'rc-slider/lib/Slider';\nimport 'rc-slider/assets/index.css';\n\nimport SmoothScrollbar from 'react-smooth-scrollbar';\n\nimport {MyErrorBoundary, getUxSettings, DebounceWhenOutOfView, RED, BLUE, isDefinedSmallBoxScreen} from './util';\nimport {isNone, isDummy, repr, displayStr} from './hash_impl_common';\nimport {globalSettings} from './store';\nimport {observer} from 'mobx-react';\n\nimport {library} from '@fortawesome/fontawesome-svg-core';\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\nimport {faPlay} from '@fortawesome/free-solid-svg-icons/faPlay';\nimport {faStepForward} from '@fortawesome/free-solid-svg-icons/faStepForward';\nimport {faStepBackward} from '@fortawesome/free-solid-svg-icons/faStepBackward';\nimport {faFastForward} from '@fortawesome/free-solid-svg-icons/faFastForward';\nimport {faFastBackward} from '@fortawesome/free-solid-svg-icons/faFastBackward';\nimport {faPause} from '@fortawesome/free-solid-svg-icons/faPause';\nimport {faRedoAlt} from '@fortawesome/free-solid-svg-icons/faRedoAlt';\nimport {\n    List as ImmutableList,\n    Map as ImmutableMap,\n    fromJS as immutableFromJS,\n    Record as ImmutableRecord,\n} from 'immutable';\n\nlibrary.add(faPlay);\nlibrary.add(faStepForward);\nlibrary.add(faStepBackward);\nlibrary.add(faFastForward);\nlibrary.add(faFastBackward);\nlibrary.add(faPause);\nlibrary.add(faRedoAlt);\n\nfunction reflow(node) {\n    if (!node) {\n        console.error('Not reflowing non-existant node!');\n        return;\n    }\n    node && node.scrollTop;\n}\n\nfunction renderPythonCode(codeString) {\n    let lowAst = low.highlight('python', codeString).value;\n\n    const processor = unified().use(rehypestringify);\n    return processor.stringify({\n        type: 'root',\n        children: lowAst,\n    });\n}\n\nexport function dummyFormat(bp) {\n    /* return JSON.stringify(bp); */\n    return '';\n}\n\nexport function SimpleCodeBlock(props) {\n    return (\n        <pre className=\"simple-code-block hl-left pl-2\">\n            <code dangerouslySetInnerHTML={{__html: renderPythonCode(props.children)}} />\n        </pre>\n    );\n}\n\nexport function SimpleCodeInline(props) {\n    return <code dangerouslySetInnerHTML={{__html: renderPythonCode(props.children)}} />;\n}\n\nexport const DEFAULT_BOX_GEOMETRY = {\n    boxGeometry: {boxSize: 40, boxPadding: 2, spacingX: 1, spacingY: 5, fontSize: 12, borderRadius: 10},\n    labelFontSize: 16,\n};\n\nexport const SMALLER_BOX_GEOMETRY = {\n    boxGeometry: {boxSize: 30, boxPadding: 1, spacingX: 1, spacingY: 4, fontSize: 9, borderRadius: 7.5},\n    labelFontSize: 12,\n};\n\nexport const LARGER_BOX_GEOMETRY = {\n    boxGeometry: {boxSize: 50, boxPadding: 1, spacingX: 1, spacingY: 4, fontSize: 15, borderRadius: 12},\n    labelFontSize: 16,\n};\n\nfunction computeBoxTransformProperty(idx, y, boxSize, spacingX, z = 0) {\n    let x = (spacingX + boxSize) * idx;\n    return `translate3d(${x}px, ${y}px, ${z}px)`;\n}\n\nfunction pyObjToReactKey(obj) {\n    return repr(obj, false);\n}\n\nclass ActiveBoxSelectionUnthrottled extends React.PureComponent {\n    render() {\n        let {extraClassName, idx, status, transitionDuration, color, boxSize, spacingX, borderRadius} = this.props;\n        let yOffset = this.props.yOffset || 0;\n\n        const animatedClass = 'active-box-selection-animated';\n        let classes = ['active-box-selection', extraClassName, animatedClass];\n\n        let opacity;\n        switch (status) {\n            case 'removing':\n                opacity = 0;\n                break;\n            case 'created':\n                opacity = 0.15;\n                break;\n            case 'adding':\n                opacity = 1;\n                break;\n        }\n        const style = {\n            opacity: opacity,\n            transitionDuration: `${transitionDuration}ms`,\n            borderColor: color,\n            width: boxSize,\n            height: boxSize,\n            borderRadius,\n            // TODO: the part after : is weird/wrong\n            transform: idx != null ? computeBoxTransformProperty(idx, yOffset, boxSize, spacingX) : undefined,\n        };\n        return <div ref={this.props.setInnerRef} className={classNames(classes)} style={style} />;\n    }\n}\n\nclass ActiveBoxSelectionThrottledHelper extends React.Component {\n    handleRef = (node) => {\n        this.node = node;\n    };\n\n    render() {\n        let {idx, status, extraClassName, yOffset, color, boxSize, spacingX, borderRadius} = this.props;\n        return (\n            <ActiveBoxSelectionUnthrottled\n                setInnerRef={this.handleRef}\n                extraClassName={extraClassName}\n                idx={idx}\n                status={status}\n                yOffset={yOffset}\n                color={color}\n                boxSize={boxSize}\n                spacingX={spacingX}\n                borderRadius={borderRadius}\n                transitionDuration={this.props.transitionDuration}\n            />\n        );\n    }\n\n    handleTransitionEnd = (transitionId) => {\n        this.props.onTransitionEnd(this.props.propsId);\n    };\n\n    componentDidUpdate() {\n        if (this.props.onTransitionEnd) {\n            this.node.addEventListener('transitionend', () => this.handleTransitionEnd(this.props.propsId), {\n                once: true,\n                capture: false,\n            });\n        }\n    }\n}\n\nfunction SingleBoxSelection({idx, status, boxSize, spacingX, spacingY, borderRadius, ...restProps}) {\n    return (\n        <SelectionGroup\n            idx={idx}\n            status={status}\n            individualSelectionsProps={[{key: 0, ...restProps}]}\n            boxSize={boxSize}\n            borderRadius={borderRadius}\n            spacingX={spacingX}\n            spacingY={spacingY}\n        />\n    );\n}\n\nclass SelectionGroup extends React.Component {\n    TRANSITION_DURATION = 500;\n\n    constructor() {\n        super();\n        this.state = {\n            transitionRunning: false,\n            transitionStarting: false,\n            epoch: 0,\n        };\n    }\n\n    render() {\n        const isSelectionThrottled = getUxSettings().THROTTLE_SELECTION_TRANSITIONS;\n\n        const {idx, status} = this.state;\n\n        const {individualSelectionsProps, ...restProps} = this.props;\n        return individualSelectionsProps.map((extraProps) => (\n            <ActiveBoxSelectionThrottledHelper\n                {...extraProps}\n                {...restProps}\n                idx={idx}\n                status={status}\n                transitionDuration={this.TRANSITION_DURATION}\n                propsId={isSelectionThrottled && this.state.epoch}\n                onTransitionEnd={isSelectionThrottled && this.handleTransitionEnd}\n            />\n        ));\n    }\n\n    handleTransitionEnd = (epoch) => {\n        if (epoch === this.state.epoch) {\n            this.setState((state) => {\n                if (state.transitionRunning) {\n                    return {transitionRunning: false};\n                } else {\n                    return null;\n                }\n            });\n        }\n    };\n\n    componentDidUpdate() {\n        if (this.state.transitionRunning && this.state.transitionStarting) {\n            this.setState((state) => {\n                return {\n                    transitionStarting: false,\n                };\n            });\n            this.handleStartingTransition();\n        }\n    }\n\n    handleStartingTransition() {\n        let selectionTimeout = getUxSettings().THROTTLE_SELECTION_TIMEOUT;\n        if (typeof selectionTimeout !== 'number') {\n            selectionTimeout = this.TRANSITION_DURATION + 20;\n        } else {\n            selectionTimeout = Math.min(this.TRANSITION_DURATION + 20, selectionTimeout);\n        }\n        const currentEpoch = this.state.epoch;\n        setTimeout(() => {\n            if (currentEpoch === this.state.epoch) {\n                this.handleTransitionEnd(currentEpoch);\n            }\n        }, selectionTimeout);\n    }\n\n    static getDerivedStateFromProps(props, state) {\n        const isSelectionThrottled = getUxSettings().THROTTLE_SELECTION_TRANSITIONS;\n        if (isSelectionThrottled) {\n            if (!state.transitionRunning && (state.idx !== props.idx || state.status !== props.status)) {\n                const statusAllowsTransition = state.status === 'adding' && props.status === 'adding';\n                let newState = {\n                    idx: props.idx,\n                    status: props.status,\n                    transitionRunning: statusAllowsTransition,\n                    transitionStarting: statusAllowsTransition,\n                    epoch: state.epoch + 1,\n                };\n                return newState;\n            } else {\n                return null;\n            }\n        } else {\n            return {idx: props.idx, status: props.status};\n        }\n    }\n}\n\nclass Box extends React.PureComponent {\n    shortDisplayedString(value) {\n        const extraType =\n            value === 'DUMMY' ||\n            value === 'EMPTY' ||\n            value === '' ||\n            (typeof value === 'string' && /^[-+]?[0-9]+$/.test(value));\n        let isEmpty = false;\n        const maxLen = extraType ? 8 : 12;\n        // TODO: add hover?\n        let s = displayStr(value, false);\n        let shortenedValue;\n        if (s.length <= maxLen) {\n            shortenedValue = [s];\n        } else {\n            const cutCharsCount = extraType ? 3 : 4;\n\n            if (cutCharsCount === 4) {\n                shortenedValue = [\n                    s.substring(0, cutCharsCount),\n                    <br key=\"br1\" />,\n                    '\\u22EF',\n                    <br key=\"br2\" />,\n                    s.substring(s.length - cutCharsCount, s.length),\n                ];\n            } else {\n                shortenedValue = [\n                    s.substring(0, cutCharsCount),\n                    '\\u2026',\n                    s.substring(s.length - cutCharsCount, s.length),\n                ];\n            }\n        }\n        return {\n            shortenedValue,\n            extraType,\n            isEmpty,\n        };\n    }\n\n    render() {\n        const {\n            value,\n            idx,\n            status,\n            extraStyleWhenAdding,\n            removedOffset,\n            createdOffset,\n            boxSize,\n            spacingX,\n            fontSize,\n            spacingY,\n            borderRadius,\n            boxPadding,\n        } = this.props;\n        const yOffset = (this.props.yRel || 0) * (boxSize + spacingY);\n\n        let classes = ['box', {'box-animated': status !== 'removed' && status !== 'created'}];\n        let classesContent = [...classes];\n        let content;\n        if (value != null) {\n            const {shortenedValue, extraType} = this.shortDisplayedString(value);\n            let extraTypeSpan;\n            let style = {fontSize: this.props.fontSize * 0.75};\n            if (\n                shortenedValue.length === 1 &&\n                shortenedValue[0] === '' /* TODO FIXME: this check is kidna ugly & is a leaky abstraction */\n            ) {\n                extraTypeSpan = (\n                    <span className=\"box-content-extra-type\" style={style}>\n                        (empty str)\n                    </span>\n                );\n            } else {\n                extraTypeSpan = extraType ? (\n                    <span className=\"box-content-extra-type\" style={style}>\n                        (str)\n                    </span>\n                ) : null;\n            }\n            classes.push('box-full');\n            content = (\n                <span className=\"box-content\">\n                    {shortenedValue} {extraTypeSpan}\n                </span>\n            );\n        } else {\n            classes.push('box-empty');\n        }\n\n        let y;\n        let extraStyle;\n        let boxStatus;\n        switch (status) {\n            case 'removed':\n                boxStatus = 'box-removed';\n                break;\n            case 'removing':\n                boxStatus = 'box-removing';\n                y = value != null ? yOffset - (removedOffset != null ? removedOffset : boxSize) : yOffset;\n                break;\n            case 'created':\n                boxStatus = 'box-created';\n                y = value != null ? yOffset - (createdOffset != null ? createdOffset : boxSize) : yOffset;\n                break;\n            case 'adding':\n                y = yOffset;\n                extraStyle = this.props.extraStyleWhenAdding;\n                break;\n        }\n\n        classes.push(boxStatus);\n        classesContent.push(boxStatus);\n\n        return (\n            <>\n                <div\n                    style={{\n                        transform:\n                            status !== 'removed'\n                                ? computeBoxTransformProperty(idx, y, boxSize, spacingX, 0)\n                                : 'translate(0px, 0px)',\n                        width: boxSize,\n                        height: boxSize,\n                        fontSize: fontSize,\n                        lineHeight: `${fontSize}px`,\n                        borderRadius,\n                        padding: boxPadding,\n                        ...extraStyle,\n                    }}\n                    className={classNames(classes)}\n                />\n                {content && (\n                    <div\n                        style={{\n                            transform:\n                                status !== 'removed'\n                                    ? computeBoxTransformProperty(idx, y, boxSize, spacingX, 5)\n                                    : 'translate(0px, 0px)',\n                            width: boxSize,\n                            height: boxSize,\n                            fontSize: fontSize,\n                            lineHeight: `${fontSize}px`,\n                            borderRadius,\n                            padding: boxPadding,\n                            ...extraStyle,\n                        }}\n                        className={classNames(classesContent, 'box-content-wrapper')}\n                    >\n                        {content}\n                    </div>\n                )}\n            </>\n        );\n    }\n}\n\nclass SlotSelection extends React.PureComponent {\n    render() {\n        const {extraClassName, idx, status, color, boxSize, spacingX, spacingY, borderRadius} = this.props;\n\n        const individualSelectionsProps = [\n            {\n                key: `${extraClassName}-hashCode`,\n                extraClassName,\n                color,\n                yOffset: 0,\n            },\n            {key: `${extraClassName}-key`, extraClassName, color, yOffset: boxSize + spacingY},\n            {\n                key: `${extraClassName}-value`,\n                extraClassName,\n                color,\n                yOffset: 2 * (boxSize + spacingY),\n            },\n        ];\n\n        return (\n            <SelectionGroup\n                individualSelectionsProps={individualSelectionsProps}\n                idx={idx}\n                status={status}\n                boxSize={boxSize}\n                spacingX={spacingX}\n                spacingY={spacingY}\n                borderRadius={borderRadius}\n            />\n        );\n    }\n}\n\nclass LineOfBoxesSelection extends React.PureComponent {\n    render() {\n        const {extraClassName, idx, status, count, color, boxSize, spacingX, spacingY, borderRadius} = this.props;\n\n        let individualSelectionsProps = [];\n        for (let i = 0; i < this.props.count; ++i) {\n            individualSelectionsProps.push({\n                key: `${extraClassName}-${i}`,\n                extraClassName,\n                color,\n                yOffset: i * (boxSize + spacingY),\n            });\n        }\n\n        return (\n            <SelectionGroup\n                individualSelectionsProps={individualSelectionsProps}\n                idx={idx}\n                status={status}\n                boxSize={boxSize}\n                spacingX={spacingX}\n                spacingY={spacingY}\n                spacingY={spacingY}\n                borderRadius={borderRadius}\n            />\n        );\n    }\n}\n\nconst BBRecord = ImmutableRecord({\n    status: null,\n    modId: null,\n    box: null,\n    value: null,\n    group: null,\n    id: null,\n    idx: null,\n    someProps: null,\n});\n\nclass BaseBoxesComponent extends React.PureComponent {\n    static ANIMATION_DURATION_TIMEOUT = 500;\n\n    constructor() {\n        super();\n\n        this.state = {\n            keyData: null,\n            activeBoxSelection1: null,\n            activeBoxSelection1status: null,\n            activeBoxSelection2: null,\n            activeBoxSelection2status: null,\n            lastIdx: null,\n            lastIdx2: null,\n            needProcessCreatedAfterRender: false,\n            needReflow: false,\n            firstRender: true,\n            modificationId: 0,\n            lastBoxId: 0,\n            removingValueToGroupToKeyToId: null,\n        };\n        this.ref = React.createRef();\n        this.gcTimeout = null;\n    }\n\n    static markRemoved(state, targetModId) {\n        let updatedCount = 0;\n        let toMerge = {};\n        let gcModId = state.gcModId;\n        if (targetModId) {\n            gcModId = Math.max(gcModId, targetModId);\n        }\n        console.log('BaseBoxesComponent markRemoved', gcModId);\n        for (const [key, data] of state.keyData.entries()) {\n            if (data.status === 'removing' && data.modId <= gcModId) {\n                updatedCount++;\n                toMerge[key] = {\n                    box: React.cloneElement(data.box, {status: 'removed'}),\n                    status: 'removed',\n                };\n            }\n        }\n        if (updatedCount > 0) {\n            console.log('BaseBoxesComponent.markRemoved() removed', updatedCount);\n            return {\n                keyData: state.keyData.mergeDeep(toMerge),\n                needReflow: true,\n                gcModId,\n            };\n        } else {\n            return null;\n        }\n    }\n\n    // FIXME: this function\n    // FIXME: you may not like it, but this is what peak engineering looks like\n    static getDerivedStateFromProps(nextProps, state) {\n        const t1 = performance.now();\n        // BaseBoxesComponent.staticDebugLogState(state);\n\n        // Some boxes are already timed out, so mark them as such\n        if (!state.firstRender) {\n            const mrState = BaseBoxesComponent.markRemoved(state);\n            if (mrState) {\n                state = {...state, ...mrState};\n            }\n        }\n\n        const modificationId = state.modificationId + 1;\n        const gcModId = state.gcModId;\n        const Selection = nextProps.selectionClass;\n        const boxFactory = nextProps.boxFactory;\n        const boxGeometry = nextProps.boxGeometry;\n\n        const boxFontSizeOverride = nextProps.boxFontSizeOverride;\n\n        const actualGeometry = {...boxGeometry};\n        if (boxFontSizeOverride) {\n            actualGeometry.fontSize = boxFontSizeOverride;\n        }\n\n        const geometryChanged = !state.firstRender && boxGeometry !== state.boxGeometry;\n        if (geometryChanged) {\n            const toMerge = {};\n            for (const [key, data] of state.keyData.entries()) {\n                toMerge[key] = {box: React.cloneElement(data.box, {...actualGeometry})};\n            }\n            state = {...state, keyData: state.keyData.mergeDeep(toMerge), boxGeometry};\n        }\n\n        let nextArray = nextProps.array;\n        let nextArrayPreConversion = nextArray;\n        const convertNextArray = () => {\n            if (isImmutableListOrMap(nextArray)) {\n                // TODO: use Immutable.js api?\n                // console.log('immutable.js next provided');\n                const _tna = performance.now();\n                nextArray = nextArray.toJS();\n                // console.log('toJS() timing', performance.now() - _tna);\n            } else {\n                // console.warn('nextArray non-immutable');\n            }\n        };\n        let lastBoxId = state.lastBoxId;\n\n        let newState;\n        const t2 = performance.now();\n        console.log('BaseBoxesComponent::gdsp before update state timing', t2 - t1);\n        if (!state.firstRender) {\n            // This should help when setState is called after needProcessCreatedAfterRender = true\n            // (And also can possible help sometimes when a slider is dragged)\n            if (nextArrayPreConversion !== state.lastNextArrayPreConversion) {\n                convertNextArray();\n                nextArray = nextArray || [];\n                const nextArrayKeys = nextProps.getKeys(nextArray);\n\n                let newRemovingValueToGroupToKeyToId = state.removingValueToGroupToKeyToId.asMutable();\n                let toMerge = {};\n\n                let nextKeysSet = new Set(_.flatten(nextArrayKeys));\n\n                let needGarbageCollection = false;\n                // First check boxes that will be removed\n                // FIXME: some are already removed, it might be a good idea to maintain a list of \"present\" boxes\n                for (let [key, oldData] of state.keyData.entries()) {\n                    if (!nextKeysSet.has(key)) {\n                        const status = oldData.status;\n                        if (status !== 'removing' && status !== 'removed') {\n                            const group = oldData.group;\n                            const value = oldData.value;\n                            const box = React.cloneElement(oldData.box, {status: 'removing'});\n                            toMerge[key] = {status: 'removing', modId: modificationId, box};\n                            newRemovingValueToGroupToKeyToId.setIn([repr(value, true), group, key], {\n                                id: oldData.id,\n                                idx: oldData.idx,\n                            });\n                            needGarbageCollection = true;\n                        }\n                    }\n                }\n\n                const newBox = (key, idx, someProps, group, value) => {\n                    needProcessCreatedAfterRender = true;\n                    needReflow = true;\n                    const id = (++lastBoxId).toString();\n                    const box = <Box idx={idx} status=\"created\" key={id} {...actualGeometry} {...someProps} />;\n                    toMerge[key] = new BBRecord({\n                        status: 'created',\n                        id,\n                        box,\n                        modId: modificationId,\n                        group,\n                        value,\n                        idx,\n                        someProps,\n                    });\n                };\n\n                let needProcessCreatedAfterRender = false;\n                let needReflow = false;\n\n                // const t3 = performance.now();\n                // console.log('BaseBoxesComponent::gdsp before processing adding stage1', t3 - t2);\n                let notExistingKeyToData = {};\n                for (let idx = 0; idx < nextArray.length; ++idx) {\n                    const keys = nextArrayKeys[idx];\n                    const idxBoxesProps = boxFactory(keys, nextArray[idx]);\n                    for (const [group, [key, someProps]] of idxBoxesProps.entries()) {\n                        const value = someProps.value;\n\n                        const oldData = state.keyData.get(key);\n\n                        if (!oldData) {\n                            // if box does not exist at all\n                            // Then there are two options\n                            if (value != null) {\n                                // There may be an opportunity to recycle non-empty boxes\n                                notExistingKeyToData[key] = {value, group, idx, someProps};\n                            } else {\n                                // But empty boxes should be recreated. It may make sense to recycle\n                                // non-empty boxes as well, but in the current explanation there are no patterns\n                                // where it'd help (empty box keys are very regular and have index in it)\n                                newBox(key, idx, someProps, group, value);\n                            }\n                        } else {\n                            // if box already exists\n                            const status = oldData.status;\n                            // potential FIXME: does not properly compare someProps, may not update boxes if someProps become more important\n                            if (\n                                status !== 'adding' ||\n                                oldData.idx !== idx ||\n                                oldData.someProps.yOffset !== someProps.yOffset ||\n                                oldData.someProps.yRel !== someProps.yRel\n                            ) {\n                                // Box is changed, time to update it\n                                const box = oldData.box;\n                                const newStatus = status === 'removed' ? 'created' : 'adding';\n                                if (newStatus === 'created') {\n                                    needProcessCreatedAfterRender = true;\n                                    needReflow = true;\n                                }\n                                const newBox = React.cloneElement(box, {\n                                    idx,\n                                    status: newStatus,\n                                    ...someProps,\n                                });\n                                toMerge[key] = {\n                                    box: newBox,\n                                    status: newStatus,\n                                    modId: modificationId,\n                                    idx,\n                                    someProps,\n                                };\n                                BaseBoxesComponent.notSoDeepDel(newRemovingValueToGroupToKeyToId, [\n                                    repr(value, true),\n                                    group,\n                                    key,\n                                ]);\n                            }\n                        }\n                    }\n                }\n\n                let keyToRecycledBox = {};\n                let instaRemovedKeys = [];\n\n                const recycleId = (key, idx, value, groupOfKeyToId, keyToId) => {\n                    let keyWithRecycledId;\n                    if (keyToId.size > 1) {\n                        for (let [key, {idx: otherIdx}] of keyToId.entries()) {\n                            // TODO: the best value could probably be selected based as argmin(abs(otherIdx - idx))\n                            // TODO: but for now this feels good enough, since it does not swap two boxes with the same value\n                            if (otherIdx === idx) {\n                                keyWithRecycledId = key;\n                                break;\n                            }\n                        }\n                    }\n                    if (keyWithRecycledId == null) {\n                        keyWithRecycledId = keyToId.keySeq().first();\n                    }\n                    keyToRecycledBox[key] = state.keyData.get(keyWithRecycledId).box;\n                    BaseBoxesComponent.notSoDeepDel(newRemovingValueToGroupToKeyToId, [\n                        repr(value, true),\n                        groupOfKeyToId,\n                        keyWithRecycledId,\n                    ]);\n                    instaRemovedKeys.push(keyWithRecycledId);\n                };\n\n                // const t4 = performance.now();\n                // console.log('BaseBoxesComponent::gdsp before processing recycling 1', t4 - t3);\n                // Do a first pass and attempt to recycle boxes in the same row\n                for (let key in notExistingKeyToData) {\n                    const data = notExistingKeyToData[key];\n                    const potentialKeyToId = newRemovingValueToGroupToKeyToId.getIn([\n                        repr(data.value, true),\n                        data.group,\n                    ]);\n                    if (potentialKeyToId) {\n                        recycleId(key, data.idx, data.value, data.group, potentialKeyToId);\n                    }\n                }\n\n                // const t5 = performance.now();\n                // console.log('BaseBoxesComponent::gdsp before processing recycling 2', t5 - t4);\n                // Do a second pass and attempt to recycle boxes in other rows\n                for (let key in notExistingKeyToData) {\n                    if (key in keyToRecycledBox) {\n                        continue;\n                    }\n                    const data = notExistingKeyToData[key];\n                    const potentialGroupToKeyToId = newRemovingValueToGroupToKeyToId.get(repr(data.value, true));\n                    if (potentialGroupToKeyToId) {\n                        // TODO: might be better to prefer keys and values for each others rather than select randoml\n                        //       (this might lead to box from hash codes being transferred to keys/values)\n                        const firstGroup = potentialGroupToKeyToId.keySeq().first();\n                        const keyToId = potentialGroupToKeyToId.get(firstGroup);\n                        recycleId(key, data.idx, data.value, firstGroup, keyToId);\n                    }\n                }\n                // const t6 = performance.now();\n                // console.log('BaseBoxesComponent::gdsp before processing recycling 3', t6 - t5);\n\n                for (let key in notExistingKeyToData) {\n                    const data = notExistingKeyToData[key];\n                    if (key in keyToRecycledBox) {\n                        // if found a recycled box\n                        const value = data.someProps.value;\n                        const box = keyToRecycledBox[key];\n                        const status = box.props.status;\n                        const id = box.key;\n                        const idx = data.idx;\n\n                        const newStatus = status === 'removed' ? 'created' : 'adding';\n                        if (newStatus === 'created') {\n                            needProcessCreatedAfterRender = true;\n                            needReflow = true;\n                        }\n\n                        const newBox = React.cloneElement(box, {\n                            idx: idx,\n                            status: newStatus,\n                            ...data.someProps,\n                        });\n                        toMerge[key] = new BBRecord({\n                            box: newBox,\n                            idx,\n                            id,\n                            status: newStatus,\n                            modId: modificationId,\n                            group: data.group,\n                            value: data.value,\n                            someProps: data.someProps,\n                        });\n                    } else {\n                        // if no recycled box found, then just create a new box\n                        newBox(key, data.idx, data.someProps, data.group, data.value);\n                    }\n                }\n                //const t7 = performance.now();\n                //console.log('BaseBoxesComponent::gdsp before merging', t7 - t6);\n\n                let newKeyData = state.keyData.mergeDeep(toMerge);\n                newKeyData = newKeyData.deleteAll(instaRemovedKeys);\n                // const t8 = performance.now();\n                // console.log('BaseBoxesComponent::gdsp after merging', t8 - t7);\n\n                newState = {\n                    keyData: newKeyData,\n                    removingValueToGroupToKeyToId: newRemovingValueToGroupToKeyToId.asImmutable(),\n                    firstRender: false,\n                    needProcessCreatedAfterRender: needProcessCreatedAfterRender,\n                    needReflow: needReflow,\n                    needGarbageCollection: needGarbageCollection,\n                    modificationId: modificationId,\n                    gcModId: gcModId,\n                    lastBoxId: lastBoxId,\n                    lastNextArrayPreConversion: nextArrayPreConversion,\n                    epoch: nextProps.epoch,\n                    boxGeometry: boxGeometry,\n                };\n            }\n        } else {\n            convertNextArray();\n            let keyData = {};\n            let arrayBoxKeys = nextProps.getKeys(nextArray);\n            for (let idx = 0; idx < nextArray.length; ++idx) {\n                const keys = arrayBoxKeys[idx];\n                const idxBoxesProps = boxFactory(keys, nextArray[idx]);\n                for (const [group, [key, someProps]] of idxBoxesProps.entries()) {\n                    const value = someProps.value;\n                    const id = (++lastBoxId).toString();\n                    const box = <Box idx={idx} key={id} status=\"adding\" {...boxGeometry} {...someProps} />;\n                    keyData[key] = new BBRecord({\n                        status: 'adding',\n                        modId: modificationId,\n                        box,\n                        id,\n                        group,\n                        value,\n                        someProps,\n                    });\n                }\n            }\n\n            newState = {\n                keyData: new ImmutableMap(keyData),\n                removingValueToGroupToKeyToId: new ImmutableMap(),\n                firstRender: false,\n                needProcessCreatedAfterRender: false,\n                needGarbageCollection: false,\n                gcModId: -1,\n                modificationId: modificationId,\n                lastBoxId: lastBoxId,\n                lastNextArray: nextArray,\n                epoch: nextProps.epoch,\n                boxGeometry: boxGeometry,\n            };\n        }\n\n        // This can be located in the beginning of the function, but I think it is better to move it here, b/c this might lead\n        //  to better recycling of boxes\n        //\n        // Epoch changes when the main \"toolbar input changes\". It is a hack to make dragging sliders work better\n        // Re-using old boxes rather than creating new ones seems to work better in most browsers (and much better in firefox)\n        if (!state.firstRender && state.epoch != nextProps.epoch) {\n            const currentState = newState != null ? newState : state;\n            const gcState = BaseBoxesComponent.garbageCollect(currentState, gcModId);\n            if (gcState) {\n                newState = {...currentState, ...gcState};\n            }\n        }\n\n        // Can happen when there is no change between arrays\n        if (newState == null) {\n            newState = {...state};\n        }\n\n        let activeBoxSelection1 = state.activeBoxSelection1;\n        let activeBoxSelection2 = state.activeBoxSelection2;\n\n        let activeBoxSelection1status = state.activeBoxSelection1status;\n        let activeBoxSelection2status = state.activeBoxSelection2status;\n\n        // FIXME: handling active selection is extremely ugly, should be rewritten in a much cleaner fashion\n        // FIXME: probably better to get rid of created/removing/adding statuses here\n        //\n        // TODO: it may be a good idea to combine it with Selection component\n        const getOrModSelection = (selection, extraClassName, oldIdx, _idx, status, color) => {\n            if (_idx == null) {\n                status = 'removing';\n            } else if (status === 'created' || _idx != null) {\n                status = 'adding';\n            }\n\n            const idx = _idx != null ? _idx : oldIdx;\n            if (!selection) {\n                return [\n                    <Selection\n                        {...nextProps.selectionProps}\n                        key={extraClassName}\n                        keyTemplate={extraClassName}\n                        extraClassName={extraClassName}\n                        idx={idx}\n                        status={status}\n                        color={color}\n                        {...boxGeometry}\n                    />,\n                    status,\n                ];\n            } else {\n                return [React.cloneElement(selection, {idx, status, ...boxGeometry}), status];\n            }\n        };\n\n        if (activeBoxSelection1 || nextProps.idx != null) {\n            [activeBoxSelection1, activeBoxSelection1status] = getOrModSelection(\n                activeBoxSelection1,\n                'active-box-selection-1',\n                state.lastIdx,\n                nextProps.idx,\n                activeBoxSelection1status,\n                nextProps.selection1color || RED\n            );\n        }\n\n        if (activeBoxSelection2 || nextProps.idx2 != null) {\n            [activeBoxSelection2, activeBoxSelection2status] = getOrModSelection(\n                activeBoxSelection2,\n                'active-box-selection-2',\n                state.lastIdx2,\n                nextProps.idx2,\n                activeBoxSelection2status,\n                nextProps.selection2color || BLUE\n            );\n        }\n\n        if (nextProps.idx != null) {\n            newState.lastIdx = nextProps.idx;\n        } else {\n            newState.lastIdx = state.lastIdx;\n        }\n\n        if (nextProps.idx2 != null) {\n            newState.lastIdx2 = nextProps.idx2;\n        } else {\n            newState.lastIdx2 = state.lastIdx2;\n        }\n\n        newState.activeBoxSelection1status = activeBoxSelection1status;\n        newState.activeBoxSelection2status = activeBoxSelection2status;\n        newState.activeBoxSelection1 = activeBoxSelection1;\n        newState.activeBoxSelection2 = activeBoxSelection2;\n\n        const totalTiming = performance.now() - t1;\n        if (typeof window !== 'undefined') {\n            if (!('bbTiming' in window)) {\n                window.bbTiming = 0;\n            }\n            window.bbTiming += totalTiming;\n        }\n        console.log('BaseBoxesComponent.getDerivedStateFromProps timing', totalTiming);\n        return newState;\n    }\n\n    static notSoDeepDel(m, [e1, e2, e3]) {\n        m = m.deleteIn([e1, e2, e3]);\n        let subm2 = m.getIn([e1, e2]);\n        if (subm2 !== undefined && subm2.size === 0) {\n            m = m.deleteIn([e1, e2]);\n            let subm1 = m.get(e1);\n            if (subm1.size === 0) {\n                m = m.delete(e1);\n            }\n        }\n        return m;\n    }\n\n    static garbageCollect(state, targetModId) {\n        console.log('Boxes garbageCollect() older than', targetModId);\n        const t1 = performance.now();\n\n        const removed = [];\n\n        let removingValueToGroupToKeyToId = state.removingValueToGroupToKeyToId.asMutable();\n        for (const [key, data] of state.keyData.entries()) {\n            if ((data.status === 'removing' || data.status === 'removed') && data.modId <= targetModId) {\n                removed.push(key);\n                const value = data.value;\n                const group = data.group;\n                BaseBoxesComponent.notSoDeepDel(removingValueToGroupToKeyToId, [repr(value, true), group, key]);\n            }\n        }\n\n        let newState = null;\n        if (removed.length > 0) {\n            newState = {\n                keyData: state.keyData.deleteAll(removed),\n                removingValueToGroupToKeyToId: removingValueToGroupToKeyToId.asImmutable(),\n                needGarbageCollection: false,\n            };\n        }\n        console.log('Boxes garbageCollect() collected', removed.length);\n\n        if (newState) {\n            console.log('Non-trivial garbageCollect timing', performance.now() - t1);\n        }\n\n        return newState;\n    }\n\n    // It is probably better to don't let unnecessary dom objects persist for too long\n    // But for now disabling, as this seems to make dragging the time slider faster\n    /*garbageCollectAfterAnimationDone = targetModId => {\n        this.gcTimeout = null;\n        this.setState(state => {\n            return BaseBoxesComponent.garbageCollect(state, targetModId);\n        });\n    };*/\n\n    debugLogState() {\n        BaseBoxesComponent.staticDebugLogState(this.state);\n    }\n\n    static staticDebugLogState(state) {\n        console.log('~~~~~~~~~~~~~~~');\n        console.log('debugLogState()');\n        for (let [k, v] of Object.entries(state)) {\n            console.log(k, v != null && typeof v.toJS === 'function' ? v.toJS() : v);\n            if (isImmutableListOrMap(v)) {\n                if (v.size > 200) {\n                    console.warn(`debugLogState(): ${k} size is too big: ${v.size}`);\n                }\n            }\n        }\n        console.log('~~~~~~~~~~~~~~~');\n    }\n\n    updateModIdForGC = (modId) => {\n        this.setState((state) => {\n            const gcModId = Math.max(state.gcModId, modId);\n            if (gcModId > state.gcModId) {\n                return {gcModId};\n            } else {\n                return null;\n            }\n        });\n    };\n\n    render() {\n        // console.log('BaseBoxesComponent.render()');\n        // this.debugLogState();\n        if (this.state.needGarbageCollection) {\n            /*console.log(\"Scheduling garbage collection\");\n            console.log(this.state);*/\n            const currentModificationId = this.state.modificationId;\n\n            /*if (this.gcTimeout) {\n                clearTimeout(this.gcTimeout);\n            }\n\n            this.gcTimeout = setTimeout(() => {\n                this.setState(state => {\n                    return BaseBoxesComponent.markRemoved(state, currentModificationId);\n                });\n            }, BaseBoxesComponent.ANIMATION_DURATION_TIMEOUT);*/\n\n            // The next line is very important, and this timer does not need to be heavily debounced\n            setTimeout(\n                () => this.updateModIdForGC(currentModificationId),\n                BaseBoxesComponent.ANIMATION_DURATION_TIMEOUT\n            );\n        }\n\n        const boxes = [];\n        for (let key of this.state.keyData.keys()) {\n            boxes.push(this.state.keyData.get(key).box);\n        }\n        boxes.sort((b1, b2) => (b1.key > b2.key ? 1 : b1.key < b2.key ? -1 : 0));\n        // console.log('BaseBoxesComponent rendered', boxes);\n\n        if (this.state.activeBoxSelection1) {\n            boxes.push(this.state.activeBoxSelection1);\n        }\n        if (this.state.activeBoxSelection2) {\n            boxes.push(this.state.activeBoxSelection2);\n        }\n\n        // TODO: set proper width\n        return (\n            <div className=\"hash-vis\" style={{height: this.props.height}} ref={this.ref}>\n                {boxes}\n            </div>\n        );\n    }\n\n    componentDidUpdate() {\n        const node = this.ref.current;\n        if (this.state.needReflow) {\n            reflow(node);\n            if (this.props.onExpectedWidthChange) {\n                this.props.onExpectedWidthChange();\n            }\n            // check to prevent extra setState\n            if (!this.state.needProcessCreatedAfterRender) {\n                this.setState({\n                    needReflow: false,\n                });\n            }\n        }\n\n        if (this.state.needProcessCreatedAfterRender) {\n            const t1 = performance.now();\n\n            this.setState((state) => {\n                const modificationId = state.modificationId + 1;\n\n                let toMerge = {};\n                for (let [key, oldData] of state.keyData.entries()) {\n                    if (oldData.status === 'created') {\n                        toMerge[key] = {\n                            status: 'adding',\n                            box: React.cloneElement(oldData.box, {status: 'adding'}),\n                            modId: modificationId,\n                        };\n                    }\n                }\n                return {\n                    keyData: state.keyData.mergeDeep(toMerge),\n                    needProcessCreatedAfterRender: false,\n                    needReflow: false,\n                    modificationId,\n                };\n            });\n            console.log(\n                'BaseBoxesComponent.componentDidUpdate needProcessCreatedAfterRender==true timing',\n                performance.now() - t1\n            );\n        }\n    }\n}\n\nfunction isImmutableListOrMap(obj) {\n    return ImmutableList.isList(obj) || ImmutableMap.isMap(obj);\n}\n\nfunction deepGet(obj, path) {\n    const parts = path.split('.');\n    let node = obj;\n    for (const part of parts) {\n        if (isImmutableListOrMap(node)) {\n            node = node.get(part);\n        } else {\n            node = node[part];\n        }\n    }\n\n    return node;\n}\n\nexport function TetrisFactory(lines, opts) {\n    const fixedGeometry = opts?.fixedGeometry;\n\n    return class extends React.PureComponent {\n        static FULL_WIDTH = true;\n        static EXTRA_ERROR_BOUNDARY = true;\n\n        static getExpectedHeight(windowWidth, windowHeight) {\n            return Tetris._getExpectedHeight(windowWidth, windowHeight, lines, fixedGeometry);\n        }\n\n        render() {\n            return (\n                <Tetris lines={lines} {...this.props} innerRef={this.props.innerRef} fixedGeometry={fixedGeometry} />\n            );\n        }\n    };\n}\n\nfunction selectGeometry(windowWidth, windowHeight, lines) {\n    // if (isDefinedSmallBoxScreen(windowWidth, windowHeight)) {\n    //     return SMALLER_BOX_GEOMETRY;\n    // } else {\n    //     return LARGER_BOX_GEOMETRY;\n    // }\n\n    // VERY HACKY\n    let maxBoxSizeIsDefault = false;\n    for (const line of lines) {\n        maxBoxSizeIsDefault = maxBoxSizeIsDefault || line[1][0].maxBoxSizeIsDefault;\n    }\n\n    if (windowWidth > 1000 && !maxBoxSizeIsDefault) {\n        return LARGER_BOX_GEOMETRY;\n    } else if (windowWidth > 800) {\n        return DEFAULT_BOX_GEOMETRY;\n    } else {\n        return SMALLER_BOX_GEOMETRY;\n    }\n}\n\nexport class Tetris extends React.PureComponent {\n    static VIS_MARGIN = 7; // should match .hash-vis-wrapper margin\n\n    static _getExpectedHeight(windowWidth, windowHeight, lines, fixedGeometry) {\n        // TODO: use linesData.marginBottom in computation\n        const {boxGeometry} = fixedGeometry || selectGeometry(windowWidth, windowHeight, lines);\n        const hackyPaddingSize = boxGeometry.boxSize * 0.75;\n        return (\n            hackyPaddingSize +\n            this.VIS_MARGIN * (lines.length - 1) +\n            _.sum(\n                lines.map(\n                    ([Component, [ld, d, i, i2, subProps]]) =>\n                        Component.getExpectedGeometry({boxGeometry, ...subProps}).height\n                )\n            )\n        );\n    }\n\n    constructor() {\n        super();\n        this.scrollbarRef = React.createRef();\n    }\n\n    updateScrollbar = () => {\n        this.scrollbarRef.current.scrollbar.update();\n        /*// TODO FIXME XXX this is a temporary workaround for some testing\n        setTimeout(() => {\n            this.scrollbarRef.current.scrollbar.update();\n        }, 2000);*/\n    };\n\n    render() {\n        const props = this.props;\n        let elems = [];\n        let labels = [];\n        let labelsEnabled = false;\n        const {boxGeometry, labelFontSize} =\n            this.props.fixedGeometry || selectGeometry(props.windowWidth, props.windowHeight, this.props.lines);\n        // console.log('selectBoxGeometry', boxGeometry, props.windowWidth, props.windowHeight);\n        for (let [i, [Component, [linesData, dataName, idxName, idx2Name, subProps]]] of props.lines.entries()) {\n            const component = (\n                <Component\n                    onExpectedWidthChange={this.updateScrollbar}\n                    array={deepGet(props.bp, dataName)}\n                    idx={props.bp[idxName]}\n                    idx2={props.bp[idx2Name]}\n                    epoch={props.epoch}\n                    boxGeometry={boxGeometry}\n                    {...subProps}\n                />\n            );\n\n            const tetrisRowMarginBottom = linesData.marginBottom || Tetris.VIS_MARGIN;\n            const {rowMarginBottom, rowHeight, height, rowsNumber} = Component.getExpectedGeometry({\n                boxGeometry,\n                ...subProps,\n            });\n            labelsEnabled = labelsEnabled || !linesData.labels.every((label) => label == null);\n\n            labels = labels.concat(\n                linesData.labels.map((label, index) => {\n                    const marginBottom =\n                        index === linesData.labels.length - 1 ? tetrisRowMarginBottom : rowMarginBottom;\n                    const expectedNumLabels = rowsNumber;\n                    const actualNumLabels = linesData.labels.length;\n                    if (actualNumLabels != expectedNumLabels && actualNumLabels != 1)\n                        throw new Error(`Mismatched number of labels`);\n                    return (\n                        <div\n                            className=\"tetris-label-div\"\n                            key={label}\n                            style={{\n                                fontSize: labelFontSize,\n                                height: actualNumLabels === expectedNumLabels ? rowHeight : height,\n                                marginBottom: marginBottom,\n                            }}\n                        >\n                            <span className=\"tetris-label\">{label || ''}</span>\n                        </div>\n                    );\n                })\n            );\n\n            elems.push(\n                <div className=\"tetris-row\" key={`row-${i}`} style={{marginBottom: tetrisRowMarginBottom}}>\n                    <div className=\"hash-vis-wrapper\" style={{height: height}}>\n                        {component}\n                    </div>\n                </div>\n            );\n        }\n\n        let style;\n        if (this.props.compensateTopPadding && this.props.compensateTopPadding > 0) {\n            style = {position: 'relative', top: -this.props.compensateTopPadding};\n        }\n        return (\n            <SmoothScrollbar alwaysShowTracks={true} style={style} ref={this.scrollbarRef}>\n                <div\n                    className=\"fix-animation\"\n                    ref={this.props.innerRef}\n                    style={{overflowX: this.props.overflow && 'scroll'}}\n                >\n                    <div className=\"tetris\">\n                        {labelsEnabled && <div className=\"tetris-labels\">{labels}</div>}\n                        <div className=\"tetris-rows\">{elems}</div>\n                    </div>\n                </div>\n            </SmoothScrollbar>\n        );\n    }\n\n    componentDidUpdate() {\n        this.updateScrollbar();\n    }\n\n    componentDidMount() {\n        this.updateScrollbar();\n    }\n}\n\nexport class CodeBlockWithActiveLineAndAnnotations extends React.PureComponent {\n    constructor() {\n        super();\n        this.ssRef = React.createRef();\n    }\n\n    _highlightLines = memoizeOne((code) => {\n        let lines = [];\n        let maxLen = Math.max(...code.map(([line, bpPoint]) => line.length));\n        for (let i = 0; i < code.length; ++i) {\n            const line = code[i][0];\n            const paddedLine = _.padEnd(line, maxLen);\n            const hlCode = renderPythonCode(paddedLine);\n            lines.push(hlCode);\n        }\n\n        return lines;\n    });\n\n    getCodeWithExplanationHtmlLines(visibleBreakpoints, activeBp) {\n        const t1 = performance.now();\n        const code = this.props.code;\n        const hlLines = this._highlightLines(code);\n        let lines = [];\n\n        let isAnyLineHighlighted = false;\n        let highlightedExplanationContent;\n        for (let i = 0; i < code.length; ++i) {\n            const bpPoint = code[i][1];\n\n            let explanation = '';\n            let isCurrentLineHighlighted = bpPoint === activeBp.point;\n            isAnyLineHighlighted |= isCurrentLineHighlighted;\n\n            if (bpPoint in visibleBreakpoints) {\n                const {bp, prevBp} = visibleBreakpoints[bpPoint];\n                let desc = null;\n                if (typeof this.props.formatBpDesc === 'function') {\n                    desc = this.props.formatBpDesc(bp, prevBp);\n                } else {\n                    for (const formatBpDesc of this.props.formatBpDesc) {\n                        desc = formatBpDesc(bp, prevBp);\n                        if (desc != null) break;\n                    }\n                }\n\n                if (desc == null) {\n                    throw new Error('Unknown bp type: ' + bpPoint);\n                }\n\n                if (desc) {\n                    explanation = (\n                        <span\n                            key=\"explanation\"\n                            className=\"code-explanation\"\n                            dangerouslySetInnerHTML={{__html: `\\u00A0\\u00A0\\u00A0\\u00A0\\u00A0${desc}`}}\n                        />\n                    );\n                    highlightedExplanationContent = desc;\n                }\n            }\n\n            let hlCodeHtml = hlLines[i];\n\n            let formattedLine = (\n                <pre className=\"code-line-container\" key=\"pre\">\n                    <code>\n                        <span dangerouslySetInnerHTML={{__html: hlCodeHtml}} />\n                    </code>\n                </pre>\n            );\n            lines.push(\n                <div\n                    className={classNames('line-with-annotation', isCurrentLineHighlighted && 'current-line-highlight')}\n                    key={`line-${i}`}\n                    style={{\n                        paddingTop: this.props.lineVerticalPadding,\n                        paddingBottom: this.props.lineVerticalPadding,\n                        lineHeight: 1.15,\n                    }}\n                >\n                    {formattedLine}\n                    {!this.props.withShortExplanation && explanation}\n                </div>\n            );\n        }\n        if (!isAnyLineHighlighted) {\n            throw new Error(`No line found corresponding to \"${activeBp.point}`);\n        }\n\n        return {lines, highlightedExplanationContent};\n    }\n\n    getVisibleBreakpoints(activeBp) {\n        const t1 = performance.now();\n        let visibleBreakpoints = {};\n        let pointToLevel = {};\n        for (let [line, bpPoint, level] of this.props.code) {\n            if (line === '' || bpPoint === '') {\n                continue;\n            }\n            if (level === undefined) {\n                pointToLevel = null;\n                break;\n            }\n            pointToLevel[bpPoint] = level;\n        }\n\n        let prevBp = null;\n        for (let [time, bp] of this.props.breakpoints.entries()) {\n            if (time > this.props.time) {\n                break;\n            }\n\n            if (bp.recursionLevel != null && bp.recursionLevel !== activeBp.recursionLevel) {\n                continue;\n            }\n            console.log('BP', time, bp);\n\n            if (bp.point in visibleBreakpoints) {\n                let level = pointToLevel[bp.point];\n                for (let visibleBpPoint in visibleBreakpoints) {\n                    if (pointToLevel[visibleBpPoint] >= level) {\n                        delete visibleBreakpoints[visibleBpPoint];\n                    }\n                }\n            }\n\n            visibleBreakpoints[bp.point] = {bp, prevBp};\n            prevBp = bp;\n        }\n\n        return visibleBreakpoints;\n    }\n\n    render() {\n        let activeBp = this.props.breakpoints[this.props.time];\n\n        const visibleBreakpoints = this.getVisibleBreakpoints(activeBp);\n        const {lines, highlightedExplanationContent} = this.getCodeWithExplanationHtmlLines(\n            visibleBreakpoints,\n            activeBp\n        );\n\n        return (\n            <>\n                <SmoothScrollbar\n                    ref={this.ssRef}\n                    alwaysShowTracks={true}\n                    className=\"code-block-with-annotations-scrollbar-container\"\n                >\n                    {this.props.mobileHeaderTitle && (\n                        <div className=\"mobile-header-title\">{this.props.mobileHeaderTitle}</div>\n                    )}\n                    <div\n                        style={{\n                            maxHeight: this.props.height,\n                            lineHeight: this.props.lineHeight,\n                            overflowX: this.props.overflow && 'scroll',\n                            fontSize: this.props.fontSize,\n                        }}\n                        className=\"code-block-with-annotations fix-animation\"\n                    >\n                        {lines}\n                    </div>\n                </SmoothScrollbar>\n                {this.props.withShortExplanation && (\n                    <div\n                        className=\"mobile-short-explanation\"\n                        dangerouslySetInnerHTML={{__html: highlightedExplanationContent}}\n                    />\n                )}\n            </>\n        );\n    }\n\n    getScrollTopTarget() {\n        const scrollbar = this.ssRef.current.scrollbar;\n        const totalLines = this.props.code.length;\n        let activeLine = 0;\n\n        // TODO: remove copy&paste\n        let activeBp = this.props.breakpoints[this.props.time];\n        for (let [i, [_, bpPoint]] of this.props.code.entries()) {\n            if (bpPoint === activeBp.point) {\n                activeLine = i;\n            }\n        }\n\n        if (!scrollbar.size) return {scrollTopTarget: null, needsUpdating: false};\n\n        const scrollHeight = scrollbar.size.content.height;\n        const scrollTop = scrollbar.scrollTop;\n        const containerHeight = scrollbar.getSize().container.height;\n        const estimatedLineHeight = scrollHeight / totalLines;\n\n        const scrollBottom = scrollTop + containerHeight;\n\n        const activeLinePos = (activeLine / totalLines) * scrollHeight;\n        const needsUpdating =\n            activeLinePos < scrollTop + 1.2 * estimatedLineHeight ||\n            activeLinePos > scrollBottom - 2.0 * estimatedLineHeight;\n\n        let scrollTopTarget = activeLinePos - containerHeight / 2;\n        if (scrollTopTarget < 0) {\n            scrollTopTarget = 0;\n        } else if (scrollTopTarget > scrollHeight) {\n            scrollTopTarget = scrollHeight;\n        }\n\n        return {scrollTopTarget, needsUpdating};\n    }\n\n    updateScroll = () => {\n        const {scrollTopTarget, needsUpdating} = this.getScrollTopTarget();\n        const scrollbar = this.ssRef.current.scrollbar;\n        if (needsUpdating) {\n            scrollbar.scrollTo(scrollbar.offset.x, scrollTopTarget, 500);\n        }\n    };\n\n    updateScrollDebounced = _.debounce(this.updateScroll, getUxSettings().CODE_SCROLL_DEBOUNCE_TIME);\n\n    componentDidUpdate() {\n        this.updateScrollDebounced();\n    }\n}\n\n// TODO: remove time from state?\n@observer\nclass TimeSliderWithControls extends React.Component {\n    AUTOPLAY_BASE_TIMEOUT = 1000;\n\n    constructor() {\n        super();\n        this.state = {time: null, autoPlaying: false, speed: 1, userInteracted: false};\n        this.timeoutId = null;\n        this.timeoutStarted = null;\n    }\n\n    unixtimestamp() {\n        return new Date().getTime();\n    }\n\n    static getDerivedStateFromProps(nextProps, state) {\n        return {time: nextProps.time};\n    }\n\n    handleSliderValueChange = (value) => {\n        this.stop();\n        this.handleTimeChange(value);\n    };\n\n    handleTimeChange = (value, userInteracted = true, autoPlaying = false) => {\n        this.setState((state) => ({time: value, autoPlaying, userInteracted: state.userInteracted || userInteracted}));\n        this.props.handleTimeChange(value);\n    };\n\n    prevStep = () => {\n        this.stop();\n        if (this.props.time > 0) {\n            const newTime = this.props.time - 1;\n            this.handleTimeChange(newTime);\n        }\n    };\n\n    nextStep = () => {\n        this.stop();\n        if (this.props.time < this.props.maxTime) {\n            const newTime = this.props.time + 1;\n            this.handleTimeChange(newTime);\n        }\n    };\n\n    firstStep = () => {\n        this.stop();\n        this.handleTimeChange(0);\n    };\n\n    lastStep = () => {\n        this.stop();\n        this.handleTimeChange(this.props.maxTime);\n    };\n\n    getAutoplayTimeout = (speed) => {\n        return this.AUTOPLAY_BASE_TIMEOUT / (speed || globalSettings.codePlaySpeed);\n    };\n\n    autoPlayNextStep = (userInteracted = false) => {\n        if (this.state.time < this.props.maxTime) {\n            let newTime = this.state.time + 1;\n            if (newTime < this.props.maxTime) {\n                this.timeoutId = setTimeout(this.autoPlayNextStep, this.getAutoplayTimeout());\n                this.timeoutStarted = this.unixtimestamp();\n            } else {\n                this.timeoutId = null;\n            }\n            this.handleTimeChange(newTime, userInteracted, newTime < this.props.maxTime);\n        }\n    };\n\n    repeatPlay = (userInteracted = true) => {\n        this.handleTimeChange(0, userInteracted, true);\n        this.timeoutId = setTimeout(this.autoPlayNextStep, this.getAutoplayTimeout());\n        this.timeoutStarted = this.unixtimestamp();\n    };\n\n    autoPlay = (userInteracted = true) => {\n        if (this.props.time < this.props.maxTime) {\n            this.autoPlayNextStep(userInteracted);\n        } else {\n            this.repeatPlay(userInteracted);\n        }\n    };\n\n    stop = () => {\n        if (this.timeoutId != null) {\n            clearTimeout(this.timeoutId);\n            this.timeoutId = null;\n            this.timeoutStarted = null;\n        }\n        if (this.state.autoPlaying || !this.state.userInteracted) {\n            this.setState({autoPlaying: false, userInteracted: true});\n        }\n    };\n\n    setSpeed = (speed) => {\n        if (speed !== globalSettings.speed) {\n            if (\n                this.state.autoPlaying &&\n                this.getAutoplayTimeout() - (this.unixtimestamp() - this.timeoutStarted) >\n                    this.getAutoplayTimeout(speed)\n            ) {\n                clearTimeout(this.timeoutId);\n                this.timeoutId = setTimeout(this.autoPlayNextStep, this.getAutoplayTimeout(speed));\n            }\n            globalSettings.setCodePlaySpeed(speed);\n        }\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        if (state.autoPlaying && props.time === props.maxTime) {\n            return {...state, autoPlaying: false};\n        } else {\n            return null;\n        }\n    }\n\n    componentDidUpdate() {\n        if (!this.state.autoPlaying && this.timeoutId) {\n            this.stop();\n        }\n        const stillDefaultAutoplay = this.props.autoplayByDefault && !this.state.userInteracted;\n        if (!this.state.autoPlaying && stillDefaultAutoplay) {\n            this.autoPlay(false);\n        }\n    }\n\n    componentDidMount() {\n        if (this.props.autoplayByDefault) {\n            this.autoPlay(false);\n        }\n    }\n\n    render() {\n        let marks = {};\n        if (this.props.maxTime < 25) {\n            for (let i = 0; i <= this.props.maxTime; ++i) {\n                marks[i] = '';\n            }\n        }\n        const time = this.props.time;\n\n        const button = (onClick, iconId) => {\n            return (\n                <button\n                    key={iconId}\n                    type=\"button\"\n                    className={classNames('btn', 'btn-outline-dark', 'slider-controls-button')}\n                    onClick={onClick}\n                >\n                    <FontAwesomeIcon key={`font-awesome-${iconId}`} icon={iconId} />\n                </button>\n            );\n        };\n\n        let timeControls = [];\n        timeControls.push(button(this.firstStep, 'fast-backward'));\n        timeControls.push(button(this.prevStep, 'step-backward'));\n        if (!this.state.autoPlaying) {\n            const playIcon = this.props.time === this.props.maxTime ? 'redo-alt' : 'play';\n            timeControls.push(button(this.autoPlay, playIcon));\n        } else {\n            timeControls.push(button(this.stop, 'pause'));\n        }\n        timeControls.push(button(this.nextStep, 'step-forward'));\n        timeControls.push(button(this.lastStep, 'fast-forward'));\n\n        let speedControls = [];\n\n        const speeds = [0.5, 1, 2, 4, 8, 16];\n        for (let i = 0; i < speeds.length; ++i) {\n            const speed = speeds[i];\n            if (speed > globalSettings.maxCodePlaySpeed) {\n                break;\n            }\n            const isActive = speed === globalSettings.codePlaySpeed;\n            let label = i === 0 ? `Autoplay speed ${speed}x` : `${speed}x`;\n            speedControls.push(\n                <label key={label} className={classNames('btn', 'btn-outline-dark', {active: isActive})}>\n                    <input type=\"radio\" checked={isActive} onChange={() => this.setSpeed(speed)} /> {label}\n                </label>\n            );\n        }\n\n        return (\n            <React.Fragment>\n                <div className=\"row\">\n                    <div className=\"col-sm-12 col-md-12\">\n                        <div className=\"btn-toolbar slider-controls\">\n                            <div className=\"btn-group btn-group-sm mr-2 mb-1\">{timeControls}</div>\n                            <div className=\"btn-group btn-group-sm btn-group-toggle mr-2 mb-1\">{speedControls}</div>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"row slider-row fix-animation\">\n                    <div className=\"col-md-6 col-sm-12\">\n                        <Slider\n                            marks={marks}\n                            onChange={this.handleSliderValueChange}\n                            min={0}\n                            max={this.props.maxTime}\n                            value={time}\n                            dotStyle={{\n                                top: -1,\n                                height: 12,\n                                width: 12,\n                            }}\n                            handleStyle={{\n                                height: 20,\n                                width: 20,\n                                marginTop: -6,\n                            }}\n                            railStyle={{height: 10}}\n                            trackStyle={{\n                                height: 10,\n                            }}\n                        />\n                    </div>\n                </div>\n            </React.Fragment>\n        );\n    }\n}\n\nexport class VisualizedCode extends React.Component {\n    static FULL_WIDTH = true;\n    static EXTRA_ERROR_BOUNDARY = true;\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            time: props.breakpoints.length - 1,\n            userAdjustedToMax: true,\n            breakpointsUpdatedCounter: 0,\n        };\n        const throttleTime = getUxSettings().TIME_SLIDER_THROTTLE_TIME;\n        if (throttleTime != null) {\n            this.handleTimeChangeThrottled = _.throttle(\n                this.handleTimeChange,\n                getUxSettings().TIME_SLIDER_THROTTLE_TIME\n            );\n        } else {\n            this.handleTimeChangeThrottled = this.handleTimeChange;\n        }\n    }\n\n    handleTimeChange = (time) => {\n        const userAdjustedToMax = time === this.props.breakpoints.length - 1;\n        this.setState({\n            time: time,\n            userAdjustedToMax,\n        });\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        if (props.breakpoints !== state.breakpoints) {\n            if (!props.keepTimeOnNewBreakpoints) {\n                return {\n                    ...state,\n                    breakpoints: props.breakpoints,\n                    time: props.breakpoints.length - 1,\n                    breakpointsUpdatedCounter: state.breakpointsUpdatedCounter + 1,\n                };\n            } else {\n                return {\n                    ...state,\n                    breakpoints: props.breakpoints,\n                    breakpointsUpdatedCounter: state.breakpointsUpdatedCounter + 1,\n                };\n            }\n        } else {\n            return null;\n        }\n    }\n\n    render() {\n        const windowWidth = this.props.windowWidth;\n        const windowHeight = this.props.windowHeight;\n\n        const tallScreen = windowHeight && windowHeight > 450;\n        const serverSide = windowHeight == null;\n        const smallerFont = tallScreen || serverSide;\n\n        let bp = this.props.breakpoints[this.state.time];\n        console.log('VC time', this.state.time, bp);\n        const StateVisualization = this.props.stateVisualization;\n\n        let codeHeight;\n        if (windowHeight) {\n            const approximateSliderAndControlsHeight = 100;\n            // Hacky extraspace. Usually 135, but add some more\n            // when play+speed controls and input toolbar get bigger height on narrower screen\n            const extraSpace = 135 + (this.props.windowHeight < 850 ? 50 : 0);\n            codeHeight =\n                this.props.windowHeight -\n                StateVisualization.getExpectedHeight(windowWidth, windowHeight) -\n                approximateSliderAndControlsHeight -\n                extraSpace;\n            if (codeHeight < 225) {\n                codeHeight += 50;\n            }\n            codeHeight = Math.max(codeHeight, smallerFont ? 125 : 90);\n        }\n\n        let time = this.props.keepTimeOnNewBreakpoints\n            ? this.state.userAdjustedToMax\n                ? this.props.breakpoints.length - 1\n                : Math.min(this.state.time, this.props.breakpoints.length - 1)\n            : this.state.time;\n\n        return (\n            <MyErrorBoundary>\n                <div className=\"visualized-code hl-left\">\n                    <TimeSliderWithControls\n                        handleTimeChange={this.handleTimeChangeThrottled}\n                        time={time}\n                        maxTime={this.props.breakpoints.length - 1}\n                        autoplayByDefault={this.props.autoplayByDefault}\n                    />\n                    <DebounceWhenOutOfView\n                        childProps={{\n                            /* TODO: probably better not figure out how to not construct this object every time */\n                            bp: bp,\n                            /* the breakpoints and bpIdx is for chapter4 probing visualization */\n                            breakpoints: this.props.breakpoints,\n                            bpIdx: time,\n                            epoch: this.state.breakpointsUpdatedCounter,\n                        }}\n                        windowHeight={windowHeight}\n                        childFunc={(props, innerRef) => (\n                            <StateVisualization\n                                {...props}\n                                innerRef={innerRef}\n                                windowWidth={windowWidth}\n                                windowHeight={windowHeight}\n                                overflow={serverSide}\n                            />\n                        )}\n                    />\n                    {this.props.comment}\n                    {this.props.code && (\n                        <div className=\"row code-block-row fix-animation\">\n                            <div className=\"col\">\n                                <CodeBlockWithActiveLineAndAnnotations\n                                    height={codeHeight}\n                                    time={time}\n                                    code={this.props.code}\n                                    overflow={serverSide}\n                                    fontSize={smallerFont ? 12 : 9}\n                                    lineHeight={smallerFont ? 1.15 : 0.8}\n                                    breakpoints={this.props.breakpoints}\n                                    formatBpDesc={this.props.formatBpDesc}\n                                />\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </MyErrorBoundary>\n        );\n    }\n}\n\nexport class ForeverAnimation extends React.Component {\n    constructor() {\n        super();\n        this.ref = React.createRef();\n    }\n\n    render() {\n        let bp = this.props.breakpoints[this.props.time];\n\n        const windowWidth = this.props.windowWidth;\n        const windowHeight = this.props.windowHeight;\n        const StateVisualization = this.props.stateVisualization;\n\n        return (\n            <StateVisualization\n                bp={bp}\n                epoch={0} /* Fixed to 0, too lazy to implement changing breakpoints here */\n                innerRef={this.ref}\n                windowWidth={windowWidth}\n                windowHeight={windowHeight}\n                overflow={true}\n            />\n        );\n    }\n}\n\nexport class HashBoxesComponent extends React.PureComponent {\n    static getExpectedGeometry({boxGeometry: {boxSize, spacingY}}) {\n        return {height: boxSize, rowHeight: boxSize, rowMarginBottom: spacingY, rowsNumber: 1};\n    }\n\n    static getKeys(array) {\n        let res = [];\n        let counterList = new CounterList();\n        for (let i = 0; i < array.length; ++i) {\n            const value = array[i];\n            if (value != null) {\n                const keyPart = pyObjToReactKey(value);\n                let cnt = counterList.inc(0, keyPart);\n                const key = `${keyPart}-${cnt}`;\n                res.push([key]);\n            } else {\n                res.push([`empty-${i}`]);\n            }\n        }\n        return res;\n    }\n\n    static boxFactory(keys, value) {\n        return [[keys[0], {value}]];\n    }\n\n    render() {\n        const height = HashBoxesComponent.getExpectedGeometry(this.props).height;\n        return (\n            <BaseBoxesComponent\n                {...this.props}\n                getKeys={HashBoxesComponent.getKeys}\n                boxFactory={HashBoxesComponent.boxFactory}\n                selectionClass={SingleBoxSelection}\n                height={height}\n            />\n        );\n    }\n}\n\nexport class HashBoxesBrokenComponent extends React.PureComponent {\n    static MAX_BOXES = 5;\n\n    static height(boxSize) {\n        return (HashBoxesBrokenComponent.MAX_BOXES - 0.5) * boxSize;\n    }\n\n    static getExpectedGeometry({boxGeometry: {boxSize, spacingY}}) {\n        return {\n            height: HashBoxesBrokenComponent.height(boxSize),\n            rowHeight: boxSize,\n            rowMarginBottom: spacingY,\n            rowsNumber: 1,\n        };\n    }\n\n    static getKeys(array) {\n        return array.map((value, idx) => {\n            if (value.length != 0) {\n                return value.slice(0, HashBoxesBrokenComponent.MAX_BOXES).map((subValue) => pyObjToReactKey(subValue));\n            } else {\n                return [`empty-${idx}`];\n            }\n        });\n    }\n\n    static boxFactory(keys, value) {\n        if (value.length != 0) {\n            return value.slice(0, HashBoxesBrokenComponent.MAX_BOXES).map((subValue, i) => {\n                return [\n                    keys[i],\n                    {\n                        value: subValue,\n                        yRel: 0.7 * (i > 0 ? 1 : 0) + i,\n                        extraStyleWhenAdding: {opacity: 1.0 / Math.pow(2.5, i)},\n                        removedOffset: i === 0 ? undefined : 0,\n                        createdOffset: i === 0 ? undefined : 0,\n                    },\n                ];\n            });\n        } else {\n            return [[keys[0], {value: null}]];\n        }\n    }\n\n    render() {\n        const {boxSize} = this.props.boxGeometry;\n        const height = HashBoxesBrokenComponent.height(boxSize);\n        return (\n            <BaseBoxesComponent\n                {...this.props}\n                getKeys={HashBoxesBrokenComponent.getKeys}\n                boxFactory={HashBoxesBrokenComponent.boxFactory}\n                selectionClass={SingleBoxSelection}\n                height={height}\n            />\n        );\n    }\n}\n\nexport class HashSlotsComponent extends React.PureComponent {\n    static getExpectedGeometry({boxGeometry: {boxSize, spacingY}}) {\n        return {height: 3 * boxSize + 2 * spacingY, rowHeight: boxSize, rowMarginBottom: spacingY, rowsNumber: 3};\n    }\n\n    static boxFactory(keys, value) {\n        const slot = value;\n        return [\n            [keys[1], {value: slot.key, yOffset: 0}],\n            [keys[2], {value: slot.value, yRel: 1}],\n            [keys[0], {value: slot.pyHashCode, yRel: 2}],\n        ];\n    }\n\n    // Relies on the fact that keys are unique\n    static getKeys(array) {\n        const emptyOrKey = (v, idx, name, keyKey) => {\n            if (v != null) {\n                const key = pyObjToReactKey(v);\n                return `${key}-${name}-${keyKey}`;\n            } else {\n                return `empty-${idx}-${name}`;\n            }\n        };\n        return array.map((slot, idx) => {\n            const keyKey = slot.key != null ? pyObjToReactKey(slot.key) : null;\n            return [\n                emptyOrKey(slot.pyHashCode, idx, 'hashCode', keyKey),\n                emptyOrKey(slot.key, idx, 'key', keyKey),\n                emptyOrKey(slot.value, idx, 'value', keyKey),\n            ];\n        });\n    }\n\n    render() {\n        const height = HashSlotsComponent.getExpectedGeometry(this.props).height;\n        return (\n            <BaseBoxesComponent\n                {...this.props}\n                getKeys={HashSlotsComponent.getKeys}\n                boxFactory={HashSlotsComponent.boxFactory}\n                selectionClass={SlotSelection}\n                height={height}\n            />\n        );\n    }\n}\n\nclass CounterList {\n    constructor() {\n        this.counters = [];\n    }\n\n    inc(group, value) {\n        // TODO: this is all ugly\n        // TODO: refactor into a proper defaultdict/defaultlist kind of data structure\n        if (group === this.counters.length) {\n            this.counters.push(new Map());\n        }\n\n        let counter = this.counters[group];\n        let cnt;\n        if (!counter.has(value)) {\n            cnt = 0;\n            counter.set(value, 0);\n        } else {\n            cnt = counter.get(value);\n            cnt++;\n            counter.set(value, cnt + 1);\n        }\n\n        return cnt;\n    }\n}\n\nexport class LineOfBoxesComponent extends React.PureComponent {\n    static getKeys(array) {\n        let counters = [];\n        let keys = [];\n        // Does not support nulls/\"empty\"\n        for (let [idx, values] of array.entries()) {\n            if (!Array.isArray(values)) {\n                values = [values];\n            }\n\n            let currentKeys = [];\n            let counterList = new CounterList();\n\n            for (let [j, value] of values.entries()) {\n                const keyPart = pyObjToReactKey(value);\n\n                let cnt = counterList.inc(j, keyPart);\n                const key = `${keyPart}-${j}-${cnt}`;\n                currentKeys.push(key);\n            }\n            keys.push(currentKeys);\n        }\n\n        return keys;\n    }\n\n    // TODO: This is a bit of a specific hack for key-value pairs\n    // TODO: maybe it should be refactored out elsewhere\n    //\n    // FIXME: also I forgot why I added it. I think it might be not useful\n    // FIXME: Or it might make better rearranging key-value pairs?\n    // FIXME: Yep, I think rearranging key-value pairs would be easier with this thing\n    // FIXME: ...I think...\n    static getKeysForKVPairs(array) {\n        let keys = [];\n        let counterList = new CounterList();\n        // Does not support nulls/\"empty\"\n        for (let i = 0; i < array.length; ++i) {\n            const [k, v] = array[i];\n\n            const keyPart = pyObjToReactKey(k);\n            const cnt = counterList.inc(0, keyPart);\n            const valuePart = pyObjToReactKey(v);\n            keys.push([`${keyPart}-${cnt}-key`, `${keyPart}-${cnt}-${valuePart}-value`]);\n        }\n\n        return keys;\n    }\n\n    static boxFactory(keys, values) {\n        if (keys.length === 1) {\n            return [[keys[0], {value: values}]];\n        }\n\n        return _.zip(keys, values).map(([key, value], j) => {\n            return [key, {value, yRel: j}];\n        });\n    }\n\n    static getExpectedGeometry(props) {\n        const linesCount = props.linesCount || 1;\n        const {boxSize, spacingY} = props.boxGeometry;\n        return {\n            height: linesCount * boxSize + (linesCount - 1) * spacingY,\n            rowHeight: boxSize,\n            rowMarginBottom: spacingY,\n            rowsNumber: linesCount,\n        };\n    }\n\n    render() {\n        const height = LineOfBoxesComponent.getExpectedGeometry(this.props).height;\n        const {kvHack, ...restProps} = this.props;\n        return (\n            <BaseBoxesComponent\n                {...restProps}\n                getKeys={!kvHack ? LineOfBoxesComponent.getKeys : LineOfBoxesComponent.getKeysForKVPairs}\n                boxFactory={LineOfBoxesComponent.boxFactory}\n                selectionClass={LineOfBoxesSelection}\n                selectionProps={{count: this.props.linesCount || 1}}\n                height={height}\n            />\n        );\n    }\n}\n","import {None, isNone, EQ} from './hash_impl_common';\r\n\r\nimport {BigNumber} from 'bignumber.js';\r\n\r\nclass PyParsingError extends Error {\r\n    constructor(text, pos) {\r\n        // super(`${text} (at position ${pos})`);\r\n        const isStr = typeof text === 'string';\r\n        const textEn = isStr ? text : text.en;\r\n        super(textEn);\r\n        this.pos = pos;\r\n        this.text = isStr ? {en: textEn} : text;\r\n    }\r\n}\r\n\r\nconst digitsMinusPlus = '-+0123456789';\r\nconst minusPlus = '-+';\r\n\r\n// TODO: add mode for validating stuff: e.g. parseString() should throw on `\"string contents\" stuff after`\r\nexport class PyObjParser {\r\n    constructor(literal) {\r\n        this.s = literal;\r\n        this.pos = 0;\r\n    }\r\n\r\n    skipWhitespace() {\r\n        while (this.pos < this.s.length && /\\s/.test(this.s[this.pos])) {\r\n            this.pos++;\r\n        }\r\n    }\r\n\r\n    current() {\r\n        return this.s[this.pos];\r\n    }\r\n\r\n    next() {\r\n        return this.s[this.pos + 1];\r\n    }\r\n\r\n    isWhiteSpaceOrEol(c) {\r\n        return c == null || /\\s/.test(c);\r\n    }\r\n\r\n    isCurrentWhitespaceOrEol() {\r\n        return this.isWhiteSpaceOrEol(this.current());\r\n    }\r\n\r\n    consume(expectedChar) {\r\n        const c = this.current();\r\n        if (c == null) {\r\n            this.throwErr(\r\n                `Encountered unexpected EOL, expected ${expectedChar}`,\r\n                `Неожиданный конец данных, ожидается ${expectedChar}`\r\n            );\r\n        }\r\n\r\n        if (c !== expectedChar) {\r\n            this.throwErr(\r\n                `Expected \\`${expectedChar}\\`, got \\`${c}\\``,\r\n                `Ожидается \\`${expectedChar}\\` вместо \\`${c}\\``\r\n            );\r\n        }\r\n        this.pos++;\r\n    }\r\n\r\n    consumeWS(expectedChar) {\r\n        this.skipWhitespace();\r\n        this.consume(expectedChar);\r\n    }\r\n\r\n    maybeConsume(expectedChar) {\r\n        if (this.current() === expectedChar) {\r\n            this.consume(expectedChar);\r\n        }\r\n    }\r\n\r\n    maybeConsumeWS(expectedChar) {\r\n        this.skipWhitespace();\r\n        this.maybeConsume(expectedChar);\r\n    }\r\n\r\n    throwErr(textEn, textRu, pos) {\r\n        // TODO FIXME: pos computation looks way too complicated\r\n        let posToInclude = pos != null ? pos : this.pos;\r\n        posToInclude = Math.min(posToInclude, this.s.length - 1);\r\n        if (posToInclude < 0) posToInclude = 0;\r\n        throw new PyParsingError({en: textEn, ru: textRu}, posToInclude);\r\n    }\r\n\r\n    _parseStringOrNumberOrNone(allowedSeparators, fromDict, allowNonesInError) {\r\n        // TODO: The whole None parsing and error reporting for unwrapped strings\r\n        // TODO: is a bit of a mess\r\n        if (this.isNextNone(allowedSeparators)) {\r\n            return this._parseNoneOrThrowUnknownIdentifier(allowedSeparators);\r\n        }\r\n        return this._parseStringOrNumber(allowedSeparators, fromDict, allowNonesInError);\r\n    }\r\n\r\n    _parseStringOrNumber(allowedSeparators, fromDict = true, allowNonesInError = false) {\r\n        this.skipWhitespace();\r\n        let startPos = this.pos;\r\n        const c = this.current();\r\n        if (fromDict) {\r\n            if (c === '{' || c === '[') {\r\n                this.throwErr(\r\n                    'Nested lists and dictionaries are not supported. Only strings and ints are.',\r\n                    'Вложенные списки и словари не поддерживаются'\r\n                );\r\n            }\r\n            if (c == null) {\r\n                this.throwErr('Dict literal added abruptly - expected value', 'Неожиданный конец словаря');\r\n            }\r\n        }\r\n\r\n        if (digitsMinusPlus.includes(c)) {\r\n            return {res: this.parseNumber(allowedSeparators), startPos};\r\n        } else if (`\"'`.includes(c)) {\r\n            return {res: this.parseString(), startPos};\r\n        } else {\r\n            this.throwErr(\r\n                `Expected value - string, integer${\r\n                    allowNonesInError ? ' or None' : ''\r\n                }. If you wanted a string, wrap it in quotes`,\r\n                `Ожидается строка или целое${allowNonesInError ? ' или None' : ''}. Строки должны быть в кавычках.`\r\n            );\r\n        }\r\n    }\r\n\r\n    parseDict(minSize = null) {\r\n        const allowedSeparators = ',:}';\r\n        const c = this.current();\r\n\r\n        this.consumeWS('{');\r\n        let res = [];\r\n        this.skipWhitespace();\r\n        while (this.current() !== '}') {\r\n            if (this.current() == null) {\r\n                this.throwErr(\r\n                    'Dict literal ended abruptly - no closing }',\r\n                    'Неожиданный конец словаря, нет закрывающей }'\r\n                );\r\n            }\r\n            let key = this._parseStringOrNumberOrNone(allowedSeparators).res;\r\n            this.consumeWS(':');\r\n            let value = this._parseStringOrNumberOrNone(allowedSeparators).res;\r\n            res.push([key, value]);\r\n\r\n            this.skipWhitespace();\r\n            if (this.current() !== '}' && this.current() != null) this.consume(',');\r\n        }\r\n        this.consumeWS('}');\r\n        if (minSize != null) {\r\n            if (res.length < minSize) {\r\n                if (minSize > 1) {\r\n                    this.throwErr(`There should be at least ${minSize} pairs`, `Должно быть не меньше ${minSize} пар`);\r\n                } else {\r\n                    this.throwErr(`The data cannot be empty`, 'Пустые данные');\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n\r\n    parseList(allowDuplicates = true, minSize = null, extraValueValidator) {\r\n        const allowedSeparators = ',]';\r\n        const c = this.current();\r\n\r\n        console.log('parseList', c, this.s);\r\n        this.maybeConsumeWS('[');\r\n        let res = [];\r\n        this.skipWhitespace();\r\n        while (this.current() !== ']') {\r\n            // if (this.current() == null) {\r\n            //     this.throwErr('List literal ended abruptly - no closing ]');\r\n            // }\r\n            if (this.current() == null) {\r\n                break;\r\n            }\r\n            let {res: val, startPos: valStartPos} = this._parseStringOrNumberOrNone(allowedSeparators);\r\n            if (!allowDuplicates) {\r\n                for (let existingVal of res) {\r\n                    if (EQ(val, existingVal)) {\r\n                        this.throwErr(\r\n                            'Duplicates are not allowed in this list',\r\n                            'В списке не должно быть дублированных значений'\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n            if (extraValueValidator) {\r\n                const error = extraValueValidator(val);\r\n                if (error) {\r\n                    this.throwErr(error.en, error.ru, valStartPos);\r\n                }\r\n            }\r\n            res.push(val);\r\n            this.skipWhitespace();\r\n            if (this.current() !== ']' && this.current() != null) this.maybeConsume(',');\r\n            this.skipWhitespace();\r\n        }\r\n        this.maybeConsumeWS(']');\r\n        if (minSize != null) {\r\n            if (res.length < minSize) {\r\n                if (minSize > 1) {\r\n                    this.throwErr(\r\n                        `In this chapter, the list need to have length at least ${minSize}`,\r\n                        `Список должен быть длиной не меньше ${minSize}`\r\n                    );\r\n                } else {\r\n                    this.throwErr(`In this chapter, the list cannot be empty`, 'Список не может быть пустым');\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n\r\n    parseNumber(allowedSeparators = '') {\r\n        this.skipWhitespace();\r\n        if (this.current() == null) {\r\n            this.throwErr(\"Number can't be empty\", 'Число не может быть пустым');\r\n        }\r\n\r\n        const originalPos = this.pos;\r\n        while (digitsMinusPlus.includes(this.current())) {\r\n            this.pos++;\r\n        }\r\n\r\n        if (this.current() === '.') {\r\n            this.throwErr('Floats are not supported', 'Флоаты пока не поддерживаются');\r\n        }\r\n\r\n        if (this.current() === 'e') {\r\n            this.throwErr('Floats in scientific notation are not supported', 'Флоаты пока не поддерживаются');\r\n        }\r\n\r\n        const nonDecimalErrorStringEn = 'Non-decimal bases are not supported';\r\n        const nonDecimalErrorStringRu = 'Поддерживаются только числа в десятичной системе счисления';\r\n        if (this.current() === 'x') {\r\n            this.throwErr(nonDecimalErrorStringEn, nonDecimalErrorStringRu);\r\n        }\r\n        if (!this.isCurrentWhitespaceOrEol() && (!allowedSeparators || !allowedSeparators.includes(this.current()))) {\r\n            // TODO: a bit more descriptive? and a bit less hacky?\r\n            this.throwErr('Invalid syntax: number with non-digit characters', 'В числе должны быть только цифры');\r\n        }\r\n\r\n        const num = this.s.slice(originalPos, this.pos);\r\n        if (num[0] === '0' && num.length > 1) {\r\n            this.throwErr(nonDecimalErrorStringEn, nonDecimalErrorStringRu);\r\n        }\r\n        // TODO: python parses numbers like ++1, -+--1, etc properly\r\n        if (isNaN(+num)) {\r\n            this.throwErr('Invalid number', 'Невалидное число', originalPos);\r\n        }\r\n        return BigNumber(num);\r\n    }\r\n\r\n    parseString() {\r\n        // TODO: handle escape characters\r\n        // TODO: handle/throw an error on triple-quoted strings\r\n        this.skipWhitespace();\r\n        const c = this.current();\r\n        if (c !== \"'\" && c !== '\"') {\r\n            this.throwErr(\r\n                'String must be wrapped in quotation characters (either `\\'` or `\"`)',\r\n                'Строки должны быть в кавычках'\r\n            );\r\n        }\r\n        const quote = c;\r\n        this.consume(quote);\r\n\r\n        const originalPos = this.pos;\r\n        let res = [];\r\n        while (this.current() != null && this.current() !== quote) {\r\n            if (this.current() === '\\\\') {\r\n                if (this.next() !== '\\\\' && this.next() !== '\"') {\r\n                    this.throwErr(\r\n                        'The only supported escape sequences are for \\\\\\\\ and \\\\\"',\r\n                        'Такие escape-последовательности не поддерживаются',\r\n                        this.pos + 1\r\n                    );\r\n                }\r\n                res.push(this.next());\r\n                this.pos += 2;\r\n            } else {\r\n                res.push(this.current());\r\n                this.pos++;\r\n            }\r\n        }\r\n        this.consume(quote);\r\n        return res.join('');\r\n    }\r\n\r\n    isNextNone(allowedSeparators = '') {\r\n        this.skipWhitespace();\r\n        return (\r\n            this.s.slice(this.pos, this.pos + 4) === 'None' &&\r\n            (this.isWhiteSpaceOrEol(this.s[this.pos + 4]) || allowedSeparators.includes(this.s[this.pos + 4]))\r\n        );\r\n    }\r\n\r\n    // Quite hacky\r\n    _parseNoneOrThrowUnknownIdentifier(allowedSeparators) {\r\n        this.skipWhitespace();\r\n        if (this.isNextNone(allowedSeparators)) {\r\n            const startPos = this.pos;\r\n            this.pos += 4;\r\n            return {res: None, startPos};\r\n        }\r\n        this.throwErr(\r\n            'Unknown identifier (if you wanted a string, wrap it in quotation marks - `\"` or `\\'`)',\r\n            'Строки должны быть в кавычках'\r\n        );\r\n    }\r\n\r\n    checkTrailingChars() {\r\n        this.skipWhitespace();\r\n        if (this.pos < this.s.length) {\r\n            this.throwErr('Trailing characters', 'Лишние символы');\r\n        }\r\n    }\r\n}\r\n\r\nfunction _checkTrailingChars(parser, parseFunc) {\r\n    const res = parseFunc();\r\n    parser.checkTrailingChars();\r\n    return res;\r\n}\r\n\r\nexport function parsePyString(s) {\r\n    let parser = new PyObjParser(s);\r\n    return _checkTrailingChars(parser, () => parser.parseString());\r\n}\r\n\r\nexport function parsePyNumber(s) {\r\n    let parser = new PyObjParser(s);\r\n    return _checkTrailingChars(parser, () => parser.parseNumber());\r\n}\r\n\r\nexport function parsePyDict(s, minSize = null) {\r\n    let parser = new PyObjParser(s);\r\n    return _checkTrailingChars(parser, () => parser.parseDict(minSize));\r\n}\r\n\r\nexport function parsePyList(s, allowDuplicates = true, minSize = null, extraValueValidator) {\r\n    let parser = new PyObjParser(s);\r\n    return _checkTrailingChars(parser, () => parser.parseList(allowDuplicates, minSize, extraValueValidator));\r\n}\r\n\r\nexport function parsePyStringOrNumber(s) {\r\n    let parser = new PyObjParser(s);\r\n    return _checkTrailingChars(parser, () => parser._parseStringOrNumber(null, false).res);\r\n}\r\n\r\nexport function parsePyStringOrNumberOrNone(s) {\r\n    let parser = new PyObjParser(s);\r\n    return _checkTrailingChars(parser, () => parser._parseStringOrNumberOrNone(null, false, true).res);\r\n}\r\n\r\n// TODO: Dump functions are very hacky right now\r\n\r\nexport function dumpSimplePyObj(o) {\r\n    if (isNone(o)) {\r\n        return 'None';\r\n    }\r\n    if (BigNumber.isBigNumber(o)) {\r\n        return o.toString();\r\n    }\r\n    return JSON.stringify(o);\r\n}\r\n\r\nexport function dumpPyList(l) {\r\n    let strItems = [];\r\n    for (let item of l) {\r\n        strItems.push(dumpSimplePyObj(item));\r\n    }\r\n    return '[' + strItems.join(', ') + ']';\r\n}\r\n\r\nexport function dumpPyDict(d) {\r\n    let strItems = [];\r\n    for (let [k, v] of d) {\r\n        strItems.push(`${dumpSimplePyObj(k)}: ${dumpSimplePyObj(v)}`);\r\n    }\r\n    return '{' + strItems.join(', ') + '}';\r\n}\r\n","import * as React from 'react';\r\nimport _ from 'lodash';\r\nimport {BigNumber} from 'bignumber.js';\r\nimport Sticky from 'react-stickynode';\r\nimport {\r\n    parsePyList,\r\n    dumpPyList,\r\n    dumpPyDict,\r\n    parsePyDict,\r\n    parsePyNumber,\r\n    parsePyString,\r\n    parsePyStringOrNumber,\r\n    parsePyStringOrNumberOrNone,\r\n} from './py_obj_parsing';\r\nimport {isNone} from './hash_impl_common';\r\nimport {isClient} from './util';\r\n\r\nimport classNames from 'classnames';\r\nimport AutosizeInput from 'react-input-autosize';\r\nimport {Manager, Reference, Popper} from 'react-popper';\r\nimport {List as ImmutableList, Map as ImmutableMap} from 'immutable';\r\n\r\nimport {faUndoAlt} from '@fortawesome/free-solid-svg-icons/faUndoAlt';\r\nimport {faRedoAlt} from '@fortawesome/free-solid-svg-icons/faRedoAlt';\r\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\r\nimport {library} from '@fortawesome/fontawesome-svg-core';\r\n\r\nlibrary.add(faUndoAlt);\r\nlibrary.add(faRedoAlt);\r\n\r\n// TODO: this is still kinda ugly and needs some refactoring\r\nexport class ParsableInputBase extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        // TODO: this is a hack\r\n        // there should probably be a single source of truth\r\n        this.state = {\r\n            valueRaw: this.props.valueRaw || this.props.dumpValue(this.props.value),\r\n            value: this.props.value,\r\n            error: null,\r\n            lastError: null,\r\n        };\r\n        this.inputComponentRef = React.createRef();\r\n        this.lastScrollLeft = null;\r\n    }\r\n\r\n    forceSetValue(value) {\r\n        this.setState({\r\n            valueRaw: this.props.dumpValue(value),\r\n            value: value,\r\n            valueId: this.props.valueId != null ? this.props.valueId + 1 : null,\r\n        });\r\n    }\r\n\r\n    handleChange = event => {\r\n        try {\r\n            let newState = {\r\n                valueRaw: event.target.value,\r\n                lastError: this.state.error || this.state.lastError,\r\n                error: null,\r\n                value: this.props.parseValue(event.target.value),\r\n                valueId: this.props.valueId != null ? this.props.valueId + 1 : null,\r\n            };\r\n\r\n            this.setState(newState);\r\n            this.props.onChange(newState.value, newState.valueRaw);\r\n        } catch (e) {\r\n            this.setState({\r\n                valueRaw: event.target.value,\r\n                lastError: e,\r\n                error: e,\r\n            });\r\n        }\r\n    };\r\n}\r\n\r\nclass ParsableInputBlock extends ParsableInputBase {\r\n    handleSelect = () => {\r\n        const scrollLeft = this.inputComponentRef.current.scrollLeft;\r\n        if (scrollLeft !== this.lastScrollLeft) {\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n\r\n    measureCharWidth = () => {\r\n        const exampleStr = 'qwerty1234567890asdfghzxcb';\r\n        // FROM: https://stackoverflow.com/questions/44302717/get-input-text-width-when-typing\r\n        const c = document.createElement('canvas');\r\n        const ctx = c.getContext('2d');\r\n\r\n        const prop = ['font-style', 'font-variant', 'font-weight', 'font-size', 'font-family'];\r\n        let font = '';\r\n        for (let p of prop) {\r\n            font += window.getComputedStyle(this.inputComponentRef.current, null).getPropertyValue(p) + ' ';\r\n        }\r\n        ctx.font = font;\r\n\r\n        const txtWidth = ctx.measureText(exampleStr).width;\r\n\r\n        return txtWidth / exampleStr.length;\r\n    };\r\n\r\n    formatErrorMessage(e) {\r\n        const padding = 8; // TODO: unhardcode*/\r\n        const {scrollLeft, clientWidth} = this.inputComponentRef.current;\r\n        const charWidth = this.charWidth;\r\n\r\n        const visibleLeft = Math.ceil(scrollLeft / charWidth);\r\n        const visibleRight = Math.floor((scrollLeft + clientWidth) / charWidth);\r\n        const totalVisible = visibleRight - visibleLeft;\r\n\r\n        const text = e.message;\r\n        const pos = e.pos;\r\n        // TODO: check math for off-by-one type problems\r\n\r\n        // TODO: what if the error message does not fit on scren?\r\n        this.lastScrollLeft = scrollLeft;\r\n        const relativePos = pos - visibleLeft;\r\n        if (visibleLeft <= pos && pos <= visibleRight) {\r\n            if (text.length < relativePos - 1) {\r\n                return _.padEnd(text + ' ', relativePos, '-') + '^';\r\n            } else if (text.length + relativePos + 5 < totalVisible) {\r\n                return _.padStart('', relativePos, ' ') + '^--- ' + text;\r\n            } else {\r\n                return [_.padStart('', relativePos, ' ') + '^', <br key=\"br-sep\" />, text];\r\n            }\r\n        } else if (pos < visibleLeft) {\r\n            return '<--- ' + text;\r\n        } else {\r\n            return _.padEnd(text + ' ', totalVisible - 4, '-') + '>';\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let error;\r\n        if (this.state.error) {\r\n            // TODO: check if -1 is necessary\r\n            const width = this.inputComponentRef.current.offsetWidth - 1;\r\n            const errorText = this.formatErrorMessage(this.state.error);\r\n            // TODO: does not resize back properly if stretched with error\r\n            error = (\r\n                <div\r\n                    className=\"invalid-feedback invalid-feedback-block-parsable-input\"\r\n                    style={{width}}\r\n                    key=\"error-text\"\r\n                >\r\n                    {errorText}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const className = classNames('parsable-input', 'form-control', 'form-control-sm', {\r\n            'is-invalid': !!error,\r\n        });\r\n        const divClassNames = classNames('parsable-input-with-error-div', 'parsable-input-block');\r\n\r\n        return (\r\n            <div className={divClassNames}>\r\n                <input\r\n                    type=\"text\"\r\n                    className={className}\r\n                    value={this.state.valueRaw}\r\n                    onChange={this.handleChange}\r\n                    ref={this.inputComponentRef}\r\n                    onSelect={this.handleSelect}\r\n                    key=\"input\"\r\n                />\r\n                {error}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (isClient) {\r\n            this.charWidth = this.measureCharWidth();\r\n        }\r\n    }\r\n}\r\n\r\nclass ParsableInputInline extends ParsableInputBase {\r\n    static getDerivedStateFromProps(props, state) {\r\n        // TODO: this is a hack\r\n        // TODO: also if the user changes both inputs fast enough, there may be some issues\r\n        if (props.valueId != null && (state.valueId == null || state.valueId < props.valueId)) {\r\n            return {\r\n                ...state,\r\n                valueId: props.valueId,\r\n                value: props.value,\r\n                valueRaw: props.dumpValue(props.value),\r\n                lastError: state.error || state.lastError,\r\n                error: null,\r\n            };\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    tryAnotherClick = () => {\r\n        const last = this.state.anotherValue?.last;\r\n        let res;\r\n        do {\r\n            res = this.props.anotherValue(this.state, this.setState.bind(this));\r\n        } while (res === last || res === this.state.valueRaw);\r\n\r\n        this.setState({\r\n            anotherValue: {\r\n                last: res,\r\n            },\r\n            valueRaw: this.props.dumpValue(res),\r\n            valueId: this.props.valueId + 1,\r\n            value: res,\r\n            error: null,\r\n            lastError: this.state.error || this.state.lastError,\r\n        });\r\n\r\n        this.props.onChange(res);\r\n    };\r\n\r\n    render() {\r\n        let errorText;\r\n        if (this.state.error) {\r\n            errorText = this.state.error.message;\r\n        }\r\n        let lastErrorText;\r\n        if (this.state.lastError) {\r\n            lastErrorText = this.state.lastError.message;\r\n        }\r\n\r\n        return (\r\n            <ParsableInputInlineImpl\r\n                anotherValue={this.props.anotherValue}\r\n                tryAnotherClick={this.tryAnotherClick}\r\n                onChange={this.handleChange}\r\n                errorText={errorText}\r\n                lastErrorText={lastErrorText}\r\n                value={this.state.valueRaw}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nclass ParsableInputInlineImpl extends React.Component {\r\n    render() {\r\n        const errorText = this.props.errorText;\r\n        const lastErrorText = this.props.lastErrorText;\r\n        let tryAnotherButtonDiv;\r\n        if (this.props.anotherValue) {\r\n            tryAnotherButtonDiv = (\r\n                <div className=\"input-group-append\" key=\"try-another-button-div\">\r\n                    <button className=\"btn btn-secondary\" type=\"button\" onClick={this.props.tryAnotherClick}>\r\n                        Try another\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n        const inputClassName = classNames('parsable-input', 'form-control', 'form-control-sm', 'fc-inline', {\r\n            'mr-0': !!this.props.tryAnotherClick,\r\n            'is-invalid': !!errorText,\r\n        });\r\n        const divClassNames = classNames(\r\n            'parsable-input-with-error-div',\r\n            'inline-block',\r\n            'parsable-input-inline'\r\n            // 'mr-3'\r\n        );\r\n        return (\r\n            <div className={divClassNames}>\r\n                <Manager>\r\n                    <Reference>\r\n                        {({ref}) => (\r\n                            <div className=\"input-group input-group-sm\">\r\n                                <input\r\n                                    ref={ref}\r\n                                    type=\"text\"\r\n                                    className={inputClassName}\r\n                                    value={this.props.value}\r\n                                    onChange={this.props.onChange}\r\n                                    key=\"input\"\r\n                                />\r\n                                {tryAnotherButtonDiv}\r\n                            </div>\r\n                        )}\r\n                    </Reference>\r\n                    <Popper placement=\"bottom\">\r\n                        {({ref, style, placement, arrowProps}) => (\r\n                            <div\r\n                                ref={ref}\r\n                                style={style}\r\n                                data-placement={placement}\r\n                                className={classNames(\r\n                                    'popover',\r\n                                    'bs-popover-bottom',\r\n                                    errorText ? 'show' : 'hide',\r\n                                    'fade'\r\n                                )}\r\n                            >\r\n                                <div className=\"arrow\" ref={arrowProps.ref} style={arrowProps.style} />\r\n                                <div className=\"popover-body\">{errorText || lastErrorText}</div>\r\n                            </div>\r\n                        )}\r\n                    </Popper>\r\n                </Manager>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nclass ParsableInputAutogrowing extends ParsableInputBase {\r\n    render() {\r\n        return (\r\n            <AutosizeInput\r\n                minWidth={140}\r\n                type=\"text\"\r\n                className=\"parsable-input-autosize\"\r\n                value={this.state.valueRaw}\r\n                onChange={this.handleChange}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nexport function ParsableInput(props) {\r\n    const {inputComponentRef, ...restProps} = props;\r\n\r\n    if (props.autogrowing) {\r\n        return <ParsableInputAutogrowing ref={inputComponentRef} {...restProps} />;\r\n    }\r\n\r\n    if (props.inline) {\r\n        return <ParsableInputInline ref={inputComponentRef} {...restProps} />;\r\n    } else {\r\n        return <ParsableInputBlock ref={inputComponentRef} {...restProps} />;\r\n    }\r\n}\r\n\r\nexport function PyListInput({inputComponentRef, extraValueValidator, allowDuplicates, minSize, ...restProps}) {\r\n    return (\r\n        <ParsableInput\r\n            {...restProps}\r\n            dumpValue={dumpPyList}\r\n            parseValue={s => parsePyList(s, allowDuplicates, minSize, extraValueValidator)}\r\n            inputComponentRef={inputComponentRef}\r\n        />\r\n    );\r\n}\r\n\r\nexport function PyDictInput({inputComponentRef, minSize, ...restProps}) {\r\n    return (\r\n        <ParsableInput\r\n            {...restProps}\r\n            dumpValue={dumpPyDict}\r\n            parseValue={s => parsePyDict(s, minSize)}\r\n            inputComponentRef={inputComponentRef}\r\n        />\r\n    );\r\n}\r\n\r\nfunction _dumpStringOrNumOrNone(obj) {\r\n    if (BigNumber.isBigNumber(obj)) {\r\n        return obj.toString();\r\n    } else if (typeof obj === 'number' || isNone(obj)) {\r\n        return obj.toString();\r\n    } else {\r\n        return JSON.stringify(obj);\r\n    }\r\n}\r\n\r\nexport function PyNumberInput({inputComponentRef, ...restProps}) {\r\n    return (\r\n        <ParsableInput\r\n            {...restProps}\r\n            dumpValue={_dumpStringOrNumOrNone}\r\n            parseValue={parsePyNumber}\r\n            inputComponentRef={inputComponentRef}\r\n        />\r\n    );\r\n}\r\n\r\nexport function PyStringInput({inputComponentRef, ...restProps}) {\r\n    return (\r\n        <ParsableInput\r\n            {...restProps}\r\n            dumpValue={_dumpStringOrNumOrNone}\r\n            parseValue={parsePyString}\r\n            inputComponentRef={inputComponentRef}\r\n        />\r\n    );\r\n}\r\n\r\nconst _stringAsIs = s => s;\r\nexport function PyStringNoQuotesInput({inputComponentRef, ...restProps}) {\r\n    return (\r\n        <ParsableInput\r\n            {...restProps}\r\n            dumpValue={_stringAsIs}\r\n            parseValue={_stringAsIs}\r\n            inputComponentRef={inputComponentRef}\r\n        />\r\n    );\r\n}\r\n\r\nexport function PyStringOrNumberInput({inputComponentRef, ...restProps}) {\r\n    return (\r\n        <ParsableInput\r\n            {...restProps}\r\n            dumpValue={_dumpStringOrNumOrNone}\r\n            parseValue={parsePyStringOrNumber}\r\n            inputComponentRef={inputComponentRef}\r\n        />\r\n    );\r\n}\r\n\r\nexport function PySNNInput({inputComponentRef, ...restProps}) {\r\n    return (\r\n        <ParsableInput\r\n            {...restProps}\r\n            dumpValue={_dumpStringOrNumOrNone}\r\n            parseValue={parsePyStringOrNumberOrNone}\r\n            inputComponentRef={inputComponentRef}\r\n        />\r\n    );\r\n}\r\n\r\nexport class BlockInputToolbar extends React.Component {\r\n    static FULL_WIDTH = true;\r\n    static EXTRA_ERROR_BOUNDARY = true;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.wrapperRef = React.createRef();\r\n        this.state = {\r\n            height: null,\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const {bottomBoundary, ...restProps} = this.props;\r\n        const wideScreen = this.props.windowWidth && this.props.windowWidth > 600;\r\n        const tallScreen = this.props.windowHeight && this.props.windowHeight > 450;\r\n        // XXX: kind of a hack for mobiles when there is a keyboard. Maybe it is better here to check for browser platfrom\r\n        const squareishScreen =\r\n            this.props.windowWidth && this.props.windowHeight && 1.7 * this.props.windowHeight > this.props.windowWidth;\r\n        // TODO: 50, 10 are hardcoded and I am not sure why\r\n        return (\r\n            <div className=\"my-sticky-outer-outer-wrapper-this-time-really\">\r\n                <div\r\n                    style={{\r\n                        height: this.state.height ? this.state.height + 10 : undefined,\r\n                        paddingBottom: this.state.height ? undefined : 10,\r\n                    }}\r\n                >\r\n                    <Sticky innerZ={10} bottomBoundary={bottomBoundary} enabled={tallScreen || squareishScreen}>\r\n                        <div className=\"my-sticky-wrapper\" ref={this.wrapperRef}>\r\n                            <BlockInputToolbarImpl {...restProps} />\r\n                        </div>\r\n                    </Sticky>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    updateHeight() {\r\n        const height = this.wrapperRef.current.offsetHeight;\r\n        if (height !== this.state.height) {\r\n            this.setState({\r\n                height,\r\n            });\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.updateHeight();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.updateHeight();\r\n    }\r\n}\r\n\r\nclass BlockInputToolbarImpl extends React.Component {\r\n    constructor() {\r\n        super();\r\n\r\n        this.state = {\r\n            valuesStack: new ImmutableList(),\r\n            valuesStackIndex: 0,\r\n            value: null,\r\n            instantUpdates: true,\r\n        };\r\n\r\n        this.inputComponentRef = null;\r\n    }\r\n\r\n    setInputComponentRef = ref => {\r\n        this.inputComponentRef = ref;\r\n    };\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n        if (state.valuesStack.isEmpty()) {\r\n            return {\r\n                valuesStack: state.valuesStack.push(props.initialValue),\r\n            };\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    hackyPossibleWorkingDeepEqual(o1, o2) {\r\n        if (o1 === o2) return true;\r\n\r\n        if (BigNumber.isBigNumber(o1)) return o1.eq(o2);\r\n\r\n        if (Array.isArray(o1) && Array.isArray(o2)) {\r\n            if (o1.length != o2.length) {\r\n                return false;\r\n            }\r\n\r\n            for (let [v1, v2] of _.zip(o1, o2)) {\r\n                if (!this.hackyPossibleWorkingDeepEqual(v1, v2)) {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    _updateStack(value) {\r\n        let stack = this.state.valuesStack;\r\n        let idx = this.state.valuesStackIndex;\r\n        if (!stack.isEmpty() && stack.get(idx) === value) {\r\n            return false;\r\n        }\r\n        if (this.hackyPossibleWorkingDeepEqual(stack.get(idx), value)) return false;\r\n\r\n        stack = stack.slice(0, idx + 1).push(value);\r\n        idx = stack.size - 1;\r\n\r\n        this.setState({valuesStack: stack, valuesStackIndex: idx, value});\r\n        return true;\r\n    }\r\n\r\n    handleChange = value => {\r\n        if (this.state.instantUpdates) {\r\n            const stackUpdated = this._updateStack(value);\r\n            if (stackUpdated) {\r\n                this.props.onChange(value);\r\n            }\r\n        } else {\r\n            this.setState({value});\r\n        }\r\n    };\r\n\r\n    commitValueIfNecessary = () => {\r\n        if (this.state.value && this.state.valuesStack.get(this.state.valuesStackIndex) !== this.state.value) {\r\n            this._updateStack(this.state.value);\r\n            this.props.onChange(this.state.value);\r\n        }\r\n    };\r\n\r\n    handleUpdateClick = () => {\r\n        this.commitValueIfNecessary();\r\n    };\r\n\r\n    handleIUChange = () => {\r\n        this.setState({\r\n            instantUpdates: !this.state.instantUpdates,\r\n        });\r\n        this.commitValueIfNecessary();\r\n    };\r\n\r\n    handleUndoClick = () => {\r\n        let idx = this.state.valuesStackIndex;\r\n        if (idx > 0) {\r\n            idx--;\r\n            const value = this.state.valuesStack.get(idx);\r\n            this.props.onChange(value);\r\n            this.inputComponentRef.forceSetValue(value);\r\n            this.setState({\r\n                valuesStackIndex: idx,\r\n                value,\r\n            });\r\n        }\r\n    };\r\n\r\n    handleRedoClick = () => {\r\n        let idx = this.state.valuesStackIndex;\r\n        if (idx < this.state.valuesStack.size - 1) {\r\n            idx++;\r\n            const value = this.state.valuesStack.get(idx);\r\n            this.props.onChange(value);\r\n            this.inputComponentRef.forceSetValue(value);\r\n            this.setState({\r\n                valuesStackIndex: idx,\r\n                value,\r\n            });\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const Input = this.props.input;\r\n        const stack = this.state.valuesStack;\r\n        const idx = this.state.valuesStackIndex;\r\n        const undoCount = idx;\r\n        const redoCount = stack.size - idx - 1;\r\n        const updateDisabled =\r\n            this.state.value == null ||\r\n            this.state.value === stack.get(idx) ||\r\n            this.hackyPossibleWorkingDeepEqual(this.state.value, stack.get(idx));\r\n        return (\r\n            <div className=\"row row-block-input-toolbar\">\r\n                <div className=\"col col-input\">\r\n                    <Input\r\n                        {...this.props.inputProps}\r\n                        inputComponentRef={this.setInputComponentRef}\r\n                        value={this.props.initialValue}\r\n                        onChange={this.handleChange}\r\n                    />\r\n                </div>\r\n                <div className=\"col-auto col-buttons\">\r\n                    <div className=\"btn-toolbar\">\r\n                        <div className=\"form-check-inline form-check mr-2\">\r\n                            <label className=\"form-check-label\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    className=\"form-check-input\"\r\n                                    checked={this.state.instantUpdates}\r\n                                    onChange={this.handleIUChange}\r\n                                />\r\n                                Instant updates\r\n                            </label>\r\n                        </div>\r\n                        <div className=\"btn-group btn-group-sm\">\r\n                            <button\r\n                                type=\"button\"\r\n                                className={classNames('btn', 'btn-primary', {\r\n                                    invisible: this.state.instantUpdates,\r\n                                })}\r\n                                onClick={this.handleUpdateClick}\r\n                                disabled={updateDisabled}\r\n                            >\r\n                                Update\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"btn-group btn-group-sm ml-3\">\r\n                            <button\r\n                                type=\"button\"\r\n                                className=\"btn btn-primary\"\r\n                                onClick={this.handleUndoClick}\r\n                                disabled={undoCount === 0}\r\n                            >\r\n                                <FontAwesomeIcon icon={'undo-alt'} />\r\n                                <span className=\"input-toolbar-button-label\"> Undo</span>{' '}\r\n                                <span className=\"badge badge-light badge-undo-redo-count\">{undoCount}</span>\r\n                            </button>\r\n                            <button\r\n                                type=\"button\"\r\n                                className=\"btn btn-primary\"\r\n                                onClick={this.handleRedoClick}\r\n                                disabled={redoCount === 0}\r\n                            >\r\n                                <FontAwesomeIcon icon={'redo-alt'} />\r\n                                <span className=\"input-toolbar-button-label\"> Redo</span>{' '}\r\n                                <span className=\"badge badge-light badge-undo-redo-count\">{redoCount}</span>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import {singularOrPluralRus} from './util';\r\n\r\nexport function commonFormatCheckCollisionLoopEndedPart(idx, fmtCollisionCount) {\r\n    if (fmtCollisionCount > 0) {\r\n        return `После ${fmtCollisionCount} ${singularOrPluralRus(\r\n            fmtCollisionCount,\r\n            'коллизии',\r\n            'коллизий',\r\n            'коллизий'\r\n        )}, пустая ячейка (индекс <code>${idx}</code>) найдена: ${singularOrPluralRus(\r\n            fmtCollisionCount,\r\n            'коллизия',\r\n            'коллизии',\r\n            'коллизий'\r\n        )} успешно разрешена`;\r\n    } else {\r\n        return `Ячейка с индексом <code>${idx}</code> пуста: разрешать коллизии не требуется`;\r\n    }\r\n}\r\n\r\nexport function chapter1_2_FormatCheckCollision(l, idx, fmtCollisionCount) {\r\n    if (l.get(idx) == null) {\r\n        return commonFormatCheckCollisionLoopEndedPart(idx, fmtCollisionCount);\r\n    } else {\r\n        return `[Попытка №${fmtCollisionCount + 1}] Ячейка с индексом <code>${idx}</code> занята: произошла коллизия`;\r\n    }\r\n}\r\n\r\nconst _defaultIsEmpty = (l, i) => l.get(i) == null;\r\nexport function commonFormatCheckNotFound(l, idx, fmtCollisionCount, isEmpty = _defaultIsEmpty) {\r\n    const tryN = fmtCollisionCount + 1;\r\n    if (isEmpty(l, idx)) {\r\n        if (fmtCollisionCount == 0) {\r\n            return `[Попытка №${tryN}] Ячейка с индексом <code>${idx}</code> пуста, поэтому не входим в цикл`;\r\n        } else {\r\n            return `[Попытка №${tryN}] Ячейка с индексом <code>${idx}</code> пуста, прекращаем цикл`;\r\n        }\r\n    } else {\r\n        return `[Попытка №${tryN}] Ячейка с индексом <code>${idx}</code> занята, проверим ее`;\r\n    }\r\n}\r\n","import * as React from 'react';\r\n\r\nimport {BigNumber} from 'bignumber.js';\r\n\r\nimport {List} from 'immutable';\r\nimport {pyHash, pyHashUnicode, pyHashLong, HashBreakpointFunction, DUMMY, EQ, displayStr} from './hash_impl_common';\r\nimport {\r\n    HashBoxesComponent,\r\n    LineOfBoxesComponent,\r\n    TetrisFactory,\r\n    SimpleCodeBlock,\r\n    VisualizedCode,\r\n    SMALLER_BOX_GEOMETRY,\r\n} from './code_blocks';\r\nimport {PyStringInput, PyNumberInput, PyListInput, PySNNInput, BlockInputToolbar} from './inputs';\r\nimport {\r\n    ChapterComponent,\r\n    Subcontainerize,\r\n    COLOR_FOR_READ_OPS,\r\n    randomMeaningfulString,\r\n    randomString3len,\r\n    randint,\r\n    randomChoice,\r\n} from './util';\r\nimport {chapter1_2_FormatCheckCollision, commonFormatCheckNotFound} from './common_formatters';\r\nimport {library} from '@fortawesome/fontawesome-svg-core';\r\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\r\nimport {faRedoAlt} from '@fortawesome/free-solid-svg-icons/faRedoAlt';\r\nimport {faTrashAlt} from '@fortawesome/free-solid-svg-icons/faTrashAlt';\r\nlibrary.add(faTrashAlt);\r\n\r\nimport memoizeOne from 'memoize-one';\r\n\r\nexport const HASH_CREATE_NEW_CODE = [\r\n    ['def create_new(from_keys):', 'start-execution', 0],\r\n    ['    hash_codes = [EMPTY] * (2 * len(from_keys))', 'create-new-empty-hashes', 1],\r\n    ['    keys = [EMPTY] * (2 * len(from_keys))', 'create-new-empty-keys', 1],\r\n    ['', '', -1],\r\n    ['    for key in from_keys:', 'for-loop', 2],\r\n    ['        hash_code = hash(key)', 'compute-hash', 2],\r\n    ['        idx = hash_code % len(keys)', 'compute-idx', 2],\r\n    ['        while hash_codes[idx] is not EMPTY:', 'check-collision', 3],\r\n    ['            if hash_codes[idx] == hash_code and \\\\', 'check-dup-hash', 3],\r\n    ['               keys[idx] == key:', 'check-dup-key', 3],\r\n    ['                break', 'check-dup-break', 4],\r\n    ['            idx = (idx + 1) % len(keys)', 'next-idx', 3],\r\n    ['', '', -1],\r\n    ['        hash_codes[idx], keys[idx] = hash_code, key', 'assign-elem', 2],\r\n    ['', '', -1],\r\n    ['    return hash_codes, keys', 'return-lists', 1],\r\n];\r\n\r\nfunction anotherValue(array, ARRAY_CHANCE = 0.5, MEANINGFUL_CHANCE = 0.25, NUMBER_CHANCE = 0.2) {\r\n    const roll = Math.random();\r\n\r\n    if (roll < ARRAY_CHANCE) {\r\n        return randomChoice(array);\r\n    } else if (roll < ARRAY_CHANCE + MEANINGFUL_CHANCE) {\r\n        return randomMeaningfulString();\r\n    } else if (roll < ARRAY_CHANCE + MEANINGFUL_CHANCE + NUMBER_CHANCE) {\r\n        return BigNumber(randint(-100, 100));\r\n    } else {\r\n        return randomString3len();\r\n    }\r\n}\r\n\r\nclass HashCreateNew extends HashBreakpointFunction {\r\n    run(_fromKeys, _size) {\r\n        this.fromKeys = new List(_fromKeys);\r\n        const size = _size ? _size : this.fromKeys.size * 2;\r\n\r\n        this.hashCodes = new List();\r\n        this.keys = new List();\r\n\r\n        for (let i = 0; i < size; ++i) {\r\n            this.hashCodes = this.hashCodes.push(null);\r\n        }\r\n        this.addBP('create-new-empty-hashes');\r\n\r\n        for (let i = 0; i < size; ++i) {\r\n            this.keys = this.keys.push(null);\r\n        }\r\n        this.addBP('create-new-empty-keys');\r\n\r\n        for ([this.fromKeysIdx, this.key] of this.fromKeys.entries()) {\r\n            this.addBP('for-loop');\r\n\r\n            this.hashCode = pyHash(this.key);\r\n            this.addBP('compute-hash');\r\n\r\n            this.idx = this.computeIdx(this.hashCode, this.keys.size);\r\n            this.addBP('compute-idx');\r\n\r\n            this.fmtCollisionCount = 0;\r\n            while (true) {\r\n                this.addBP('check-collision');\r\n                if (this.keys.get(this.idx) === null) {\r\n                    break;\r\n                }\r\n\r\n                this.addBP('check-dup-hash');\r\n                if (this.hashCodes.get(this.idx).eq(this.hashCode)) {\r\n                    this.addBP('check-dup-key');\r\n                    if (EQ(this.keys.get(this.idx), this.key)) {\r\n                        this.addBP('check-dup-break');\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                this.fmtCollisionCount += 1;\r\n                this.idx = (this.idx + 1) % this.keys.size;\r\n                this.addBP('next-idx');\r\n            }\r\n\r\n            this.hashCodes = this.hashCodes.set(this.idx, this.hashCode);\r\n            this.keys = this.keys.set(this.idx, this.key);\r\n            this.addBP('assign-elem');\r\n        }\r\n\r\n        this.fromKeysIdx = null;\r\n        this.key = null;\r\n\r\n        this.addBP('return-lists');\r\n        return [this.hashCodes, this.keys];\r\n    }\r\n}\r\n\r\nexport const HashCreateNewStateVisualization = TetrisFactory([\r\n    [\r\n        LineOfBoxesComponent,\r\n        [\r\n            {labels: ['from_keys'], marginBottom: 10},\r\n            'fromKeys',\r\n            'fromKeysIdx',\r\n            undefined,\r\n            {selection1color: COLOR_FOR_READ_OPS},\r\n        ],\r\n    ],\r\n    [HashBoxesComponent, [{labels: ['keys'], marginBottom: 5}, 'keys', 'idx']],\r\n    [HashBoxesComponent, [{labels: ['hash_codes']}, 'hashCodes', 'idx']],\r\n]);\r\n\r\nexport function formatHashCreateNewAndInsert(bp, prevBp) {\r\n    switch (bp.point) {\r\n        case 'create-new-empty-hashes':\r\n            return `Создаем новый массив размером <code>${bp.hashCodes.size}</code> для хеш-кодов`;\r\n        case 'create-new-empty-keys':\r\n            return `Создаем новый массив размером <code>${bp.keys.size}</code> для ключей`;\r\n        case 'for-loop':\r\n            return `[${bp.fromKeysIdx + 1}/${bp.fromKeys.size}] Ключ для вставки <code>${displayStr(bp.key)}</code>`;\r\n        case 'compute-hash':\r\n            return `Вычисляем хеш-код: <code>${bp.hashCode}</code>`;\r\n        case 'compute-idx':\r\n            return `Вычисляем индекс начальной ячейки: <code>${bp.idx}</code> == <code>${bp.hashCode} % ${\r\n                bp.keys.size\r\n            }</code>`;\r\n        case 'check-collision':\r\n            return chapter1_2_FormatCheckCollision(bp.keys, bp.idx, bp.fmtCollisionCount);\r\n        case 'check-dup-hash':\r\n            if (EQ(bp.hashCodes.get(bp.idx), bp.hashCode)) {\r\n                return `<code>${bp.hashCodes.get(bp.idx)} == ${\r\n                    bp.hashCode\r\n                }</code>, мы не можем исключить, что ячейка занята тем же ключом`;\r\n            } else {\r\n                return `<code>${bp.hashCodes.get(bp.idx)} != ${\r\n                    bp.hashCode\r\n                }</code>, значит, возникла коллизия с другим ключом`;\r\n            }\r\n        case 'check-dup-key':\r\n            if (EQ(bp.keys[bp.idx], bp.key)) {\r\n                return `<code>${displayStr(bp.keys.get(bp.idx))} == ${displayStr(\r\n                    bp.key\r\n                )}</code>, значит, ключ уже в таблице`;\r\n            } else {\r\n                return `<code>${displayStr(bp.keys.get(bp.idx))} != ${displayStr(bp.key)}</code>, значит, это коллизия`;\r\n            }\r\n        case 'check-dup-break':\r\n            return 'Потому что ключ найден, стоп';\r\n        case 'check-dup-return':\r\n            return 'Потому что ключ найден, стоп';\r\n        case 'next-idx':\r\n            return `Продолжаем, индекс следующего элемента <code>${bp.idx}</code> == <code>(${prevBp.idx} + 1) % ${\r\n                bp.keys.size\r\n            }</code>`;\r\n        case 'assign-elem':\r\n            if (prevBp.keys.get(bp.idx) === null) {\r\n                return `Поместим элемент <code>${displayStr(bp.key)}</code> и его хеш-код <code>${\r\n                    bp.hashCode\r\n                }</code> в пустую ячейку <code>${bp.idx}</code>`;\r\n            } else {\r\n                return `<code>${displayStr(bp.key)}</code> и его хеш-код <code>${\r\n                    bp.hashCode\r\n                }</code> уже в ячейке, в любом случае перезаписываем`;\r\n            }\r\n        case 'return-lists':\r\n            return `Хеш-таблица создана, возвращаем массивы`;\r\n    }\r\n}\r\n\r\nexport const HASH_SEARCH_CODE = [\r\n    ['def has_key(hash_codes, keys, key):', 'start-execution', 0],\r\n    ['    hash_code = hash(key)', 'compute-hash', 1],\r\n    ['    idx = hash_code % len(keys)', 'compute-idx', 1],\r\n    ['    while hash_codes[idx] is not EMPTY:', 'check-not-found', 2],\r\n    ['        if hash_codes[idx] == hash_code and \\\\', 'check-hash', 2],\r\n    ['           keys[idx] == key:', 'check-key', 2],\r\n    ['            return True', 'return-true', 3],\r\n    ['        idx = (idx + 1) % len(keys)', 'next-idx', 2],\r\n    ['    return False', 'return-false', 1],\r\n];\r\n\r\nexport function formatHashRemoveSearch(bp, prevBp) {\r\n    switch (bp.point) {\r\n        case 'start-execution':\r\n            return `${bp.fmtIsRemove ? 'Удаляем' : 'Ищем'} ключ: <code>${bp.key}</code>`;\r\n        case 'compute-hash':\r\n            return `Вычисляем хеш-код: <code>${bp.hashCode}</code>`;\r\n        case 'compute-idx':\r\n            return `Вычисляем индекс начальной ячейки: <code>${bp.hashCode} % ${bp.keys.size}</code> == <code>${\r\n                bp.idx\r\n            }</code>`;\r\n        case 'check-not-found':\r\n            return commonFormatCheckNotFound(bp.keys, bp.idx, bp.fmtCollisionCount);\r\n        case 'check-hash':\r\n            if (bp.hashCodes.get(bp.idx).eq(bp.hashCode)) {\r\n                return `<code>${bp.hashCodes.get(bp.idx)} == ${\r\n                    bp.hashCode\r\n                }</code>, поэтому ячейка может содержать тот же ключ`;\r\n            } else {\r\n                return `<code>${bp.hashCodes.get(bp.idx)} != ${\r\n                    bp.hashCode\r\n                }</code>, поэтому ячейка определенно содержит другой ключ`;\r\n            }\r\n        case 'check-key':\r\n            if (EQ(bp.keys.get(bp.idx), bp.key)) {\r\n                return `<code>${displayStr(bp.keys.get(bp.idx))} == ${displayStr(bp.key)}</code>, ключ найден`;\r\n            } else {\r\n                return `<code>${displayStr(bp.keys.get(bp.idx))} != ${\r\n                    bp.key\r\n                }</code>, это другой ключ с тем же хеш-кодом`;\r\n            }\r\n        case 'assign-dummy':\r\n            return `Перемещаем в ячейку <code>${bp.idx}</code> с <code>фиктивным</code> объектом`;\r\n        case 'return':\r\n            return `Ключ удален`;\r\n        case 'next-idx':\r\n            return `Продолжаем, индекс следующего элемента <code>${bp.idx}</code> == <code>(${prevBp.idx} + 1) % ${\r\n                bp.keys.size\r\n            }</code>`;\r\n        case 'throw-key-error':\r\n            return `Бросаем исключение, потому что ключ не найден`;\r\n        /* search */\r\n        case 'return-true':\r\n            return `Возвращаем значение <code>True</code>`;\r\n        case 'return-false':\r\n            return `Мы попали в пустую ячейку, значит ключ не здесь. Возвращаем значение <code>False</code>`;\r\n    }\r\n}\r\n\r\nexport const HashNormalStateVisualization = TetrisFactory([\r\n    [HashBoxesComponent, [{labels: ['keys'], marginBottom: 5}, 'keys', 'idx']],\r\n    [HashBoxesComponent, [{labels: ['hash_codes']}, 'hashCodes', 'idx']],\r\n]);\r\n\r\nexport const HashNormalStateVisualizationSmallBoxes = TetrisFactory(\r\n    [\r\n        [HashBoxesComponent, [{labels: ['keys'], marginBottom: 5}, 'keys', 'idx']],\r\n        [HashBoxesComponent, [{labels: ['hash_codes']}, 'hashCodes', 'idx']],\r\n    ],\r\n    {fixedGeometry: SMALLER_BOX_GEOMETRY}\r\n);\r\n\r\nexport const HASH_REMOVE_CODE = [\r\n    ['def remove(hash_codes, keys, key):', 'start-execution', 0],\r\n    ['    hash_code = hash(key)', 'compute-hash', 1],\r\n    ['    idx = hash_code % len(keys)', 'compute-idx', 1],\r\n    ['', '', -1],\r\n    ['    while hash_codes[idx] is not EMPTY:', 'check-not-found', 2],\r\n    ['        if hash_codes[idx] == hash_code and \\\\', 'check-hash', 2],\r\n    ['           keys[idx] == key:', 'check-key', 2],\r\n    ['            keys[idx] = DUMMY', 'assign-dummy', 2],\r\n    ['            return', 'return', 3],\r\n    ['        idx = (idx + 1) % len(keys)', 'next-idx', 2],\r\n    ['', ''],\r\n    ['    raise KeyError()', 'throw-key-error', 1],\r\n];\r\n\r\nclass HashRemoveOrSearch extends HashBreakpointFunction {\r\n    run(_hashCodes, _keys, _key, isRemoveMode) {\r\n        this.fmtIsRemove = isRemoveMode;\r\n        this.hashCodes = new List(_hashCodes);\r\n        this.keys = new List(_keys);\r\n        this.key = _key;\r\n        this.addBP('start-execution');\r\n\r\n        this.fmtCollisionCount = 0;\r\n\r\n        this.hashCode = pyHash(this.key);\r\n        this.addBP('compute-hash');\r\n\r\n        this.idx = this.computeIdx(this.hashCode, this.keys.size);\r\n        this.addBP('compute-idx');\r\n\r\n        while (true) {\r\n            this.addBP('check-not-found');\r\n            if (this.keys.get(this.idx) === null) {\r\n                break;\r\n            }\r\n\r\n            this.addBP('check-hash');\r\n            if (this.hashCodes.get(this.idx).eq(this.hashCode)) {\r\n                this.addBP('check-key');\r\n                if (EQ(this.keys.get(this.idx), this.key)) {\r\n                    if (isRemoveMode) {\r\n                        this.keys = this.keys.set(this.idx, DUMMY);\r\n                        this.addBP('assign-dummy');\r\n                        this.addBP('return');\r\n                        return {hashCodes: this.hashCodes, keys: this.keys, isException: false, result: null};\r\n                    } else {\r\n                        this.addBP('return-true');\r\n                        return {hashCodes: this.hashCodes, keys: this.keys, isException: false, result: true};\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.fmtCollisionCount += 1;\r\n\r\n            this.idx = (this.idx + 1) % this.keys.size;\r\n            this.addBP('next-idx');\r\n        }\r\n\r\n        let result, isException;\r\n        if (isRemoveMode) {\r\n            this.addBP('throw-key-error');\r\n            isException = true;\r\n        } else {\r\n            this.addBP('return-false');\r\n            isException = false;\r\n            result = false;\r\n        }\r\n\r\n        return {hashCodes: this.hashCodes, keys: this.keys, isException, result};\r\n    }\r\n}\r\n\r\nexport const HASH_RESIZE_CODE = [\r\n    ['def resize(hash_codes, keys):', 'start-execution', 0],\r\n    ['    new_hash_codes = [EMPTY] * (2 * len(hash_codes))', 'create-new-empty-hashes', 1],\r\n    ['    new_keys = [EMPTY] * (2 * len(keys))', 'create-new-empty-keys', 1],\r\n    ['    for hash_code, key in zip(hash_codes, keys):', 'for-loop', 2],\r\n    ['        if key is EMPTY or key is DUMMY:', 'check-skip-empty-dummy', 2],\r\n    ['            continue', 'continue', 3],\r\n    ['        idx = hash_code % len(new_keys)', 'compute-idx', 2],\r\n    ['        while new_hash_codes[idx] is not EMPTY:', 'check-collision', 3],\r\n    ['            idx = (idx + 1) % len(new_keys)', 'next-idx', 3],\r\n    ['        new_hash_codes[idx], new_keys[idx] = hash_code, key', 'assign-elem', 2],\r\n    ['', ''],\r\n    ['    return new_hash_codes, new_keys', 'return-lists', 1],\r\n];\r\n\r\nclass HashResize extends HashBreakpointFunction {\r\n    run(_hashCodes, _keys) {\r\n        this.hashCodes = _hashCodes;\r\n        this.keys = _keys;\r\n\r\n        this.newHashCodes = new List();\r\n        this.newKeys = new List();\r\n\r\n        for (let i = 0; i < this.hashCodes.size * 2; ++i) {\r\n            this.newHashCodes = this.newHashCodes.push(null);\r\n        }\r\n        this.addBP('create-new-empty-hashes');\r\n\r\n        for (let i = 0; i < this.hashCodes.size * 2; ++i) {\r\n            this.newKeys = this.newKeys.push(null);\r\n        }\r\n        this.addBP('create-new-empty-keys');\r\n\r\n        for ([this.oldIdx, [this.hashCode, this.key]] of this.hashCodes.zip(this.keys).entries()) {\r\n            this.addBP('for-loop');\r\n            this.addBP('check-skip-empty-dummy');\r\n            if (this.key === null || this.key === DUMMY) {\r\n                this.addBP('continue');\r\n                continue;\r\n            }\r\n\r\n            this.fmtCollisionCount = 0;\r\n            this.idx = this.computeIdx(this.hashCode, this.newKeys.size);\r\n            this.addBP('compute-idx');\r\n\r\n            while (true) {\r\n                this.addBP('check-collision');\r\n                if (this.newKeys.get(this.idx) === null) {\r\n                    break;\r\n                }\r\n\r\n                this.fmtCollisionCount += 1;\r\n                this.idx = (this.idx + 1) % this.newKeys.size;\r\n                this.addBP('next-idx');\r\n            }\r\n\r\n            this.newHashCodes = this.newHashCodes.set(this.idx, this.hashCode);\r\n            this.newKeys = this.newKeys.set(this.idx, this.key);\r\n            this.addBP('assign-elem');\r\n        }\r\n        this.addBP('return-lists');\r\n        return [this.newHashCodes, this.newKeys];\r\n    }\r\n}\r\n\r\nexport function formatHashResize(bp, prevBp) {\r\n    switch (bp.point) {\r\n        case 'create-new-empty-hashes':\r\n            return `Создаем новый массив размером <code>${bp.newHashCodes.size}</code> для хеш-кодов`;\r\n        case 'create-new-empty-keys':\r\n            return `Создаем новый массив размером <code>${bp.newKeys.size}</code> для ключей`;\r\n        case 'for-loop':\r\n            return `[${bp.oldIdx + 1}/${bp.keys.size}] Ключ для вставки <code>${\r\n                bp.key === null ? 'EMPTY' : bp.key\r\n            }</code>, хеш-код <code>${bp.hashCode === null ? 'EMPTY' : bp.hashCode}</code>`;\r\n        case 'compute-idx':\r\n            return `Вычисляем индекс начальной ячейки: <code>${bp.idx} == ${bp.hashCode} % ${bp.newKeys.size}</code>`;\r\n        case 'check-skip-empty-dummy':\r\n            if (bp.keys.get(bp.oldIdx) === null) {\r\n                return `Текущяя ячейка пуста`;\r\n            } else if (bp.keys.get(bp.oldIdx) === DUMMY) {\r\n                return `Текущая ячейка содержит <code>DUMMY</code>-плейсхолдер`;\r\n            } else {\r\n                return `Текущая ячейка занята реально существующим ключом`;\r\n            }\r\n        case 'continue':\r\n            return 'Пропустим ее';\r\n        case 'check-collision':\r\n            return chapter1_2_FormatCheckCollision(bp.newKeys, bp.idx, bp.fmtCollisionCount);\r\n        case 'next-idx':\r\n            return `Продолжаем, индекс следующего элемента <code>${bp.idx}</code> == <code>(${prevBp.idx} + 1) % ${\r\n                bp.keys.size\r\n            }</code>`;\r\n        case 'assign-elem':\r\n            return `Поместим <code>${displayStr(bp.key)}</code> и его хеш-код <code>${\r\n                bp.hashCode\r\n            }</code> в пустую ячейку ${bp.idx}`;\r\n        case 'return-lists':\r\n            return `Хеш-таблица была перестроена, вернем массивы`;\r\n    }\r\n}\r\n\r\nexport const HashResizeStateVisualization = TetrisFactory([\r\n    [\r\n        HashBoxesComponent,\r\n        [{labels: ['keys'], marginBottom: 5}, 'keys', 'oldIdx', undefined, {selection1color: COLOR_FOR_READ_OPS}],\r\n    ],\r\n    [\r\n        HashBoxesComponent,\r\n        [\r\n            {labels: ['hash_codes'], marginBottom: 10, maxBoxSizeIsDefault: true},\r\n            'hashCodes',\r\n            'oldIdx',\r\n            undefined,\r\n            {selection1color: COLOR_FOR_READ_OPS},\r\n        ],\r\n    ],\r\n    [HashBoxesComponent, [{labels: ['new_keys'], marginBottom: 5}, 'newKeys', 'idx']],\r\n    [HashBoxesComponent, [{labels: ['new_hash_codes']}, 'newHashCodes', 'idx']],\r\n]);\r\n\r\nexport const HASH_INSERT_CODE = [\r\n    ['def insert(hash_codes, keys, key):', 'start-execution'],\r\n    ['    hash_code = hash(key)', 'compute-hash'],\r\n    ['    idx = hash_code % len(keys)', 'compute-idx'],\r\n    ['', ''],\r\n    ['    while keys[idx] is not EMPTY:', 'check-collision'],\r\n    ['        if hash_codes[idx] == hash_code and\\\\', 'check-dup-hash'],\r\n    ['           keys[idx] == key:', 'check-dup-key'],\r\n    ['            break', 'check-dup-break'],\r\n    ['        idx = (idx + 1) % len(keys)', 'next-idx'],\r\n    ['', ''],\r\n    ['    hash_codes[idx], keys[idx] = hash_code, key', 'assign-elem'],\r\n];\r\n\r\nclass HashInsert extends HashBreakpointFunction {\r\n    run(_hashCodes, _keys, _key) {\r\n        this.hashCodes = new List(_hashCodes);\r\n        this.keys = new List(_keys);\r\n        this.key = _key;\r\n\r\n        this.hashCode = pyHash(this.key);\r\n        this.addBP('compute-hash');\r\n\r\n        this.idx = this.computeIdx(this.hashCode, this.keys.size);\r\n        this.addBP('compute-idx');\r\n\r\n        while (true) {\r\n            this.addBP('check-collision');\r\n            if (this.keys.get(this.idx) === null) {\r\n                break;\r\n            }\r\n\r\n            this.addBP('check-dup-hash');\r\n            if (this.hashCodes.get(this.idx).eq(this.hashCode)) {\r\n                this.addBP('check-dup-key');\r\n                if (EQ(this.keys.get(this.idx), this.key)) {\r\n                    this.addBP('check-dup-break');\r\n                    break;\r\n                }\r\n            }\r\n\r\n            this.idx = (this.idx + 1) % this.keys.size;\r\n            this.addBP('next-idx');\r\n        }\r\n        this.hashCodes = this.hashCodes.set(this.idx, this.hashCode);\r\n        this.keys = this.keys.set(this.idx, this.key);\r\n\r\n        this.addBP('assign-elem');\r\n        return [this.hashCodes, this.keys];\r\n    }\r\n}\r\n\r\nexport class HashExamples extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            string: 'Hello',\r\n            integer: 42,\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const COMMON_WIDTH = 72;\r\n        const style = {\r\n            minWidth: COMMON_WIDTH,\r\n            widdth: COMMON_WIDTH,\r\n            display: 'inline-block',\r\n        };\r\n        return (\r\n            <div className=\"hash-examples\">\r\n                <div className=\"div-p\">\r\n                    {/* <span style={style}>Strings:</span> */}\r\n                    <code>hash(</code>\r\n                    <PyStringInput\r\n                        inline={true}\r\n                        value={this.state.string}\r\n                        onChange={value => this.setState({string: value})}\r\n                    />\r\n                    <code>)</code> = <code>{pyHashUnicode(this.state.string)}</code>\r\n                </div>\r\n                <div className=\"div-p\">\r\n                    {/* <span style={style}>Integers:</span> */}\r\n                    <code>hash(</code>\r\n                    <PyNumberInput\r\n                        inline={true}\r\n                        value={this.state.integer}\r\n                        onChange={value => this.setState({integer: value})}\r\n                    />\r\n                    <code>)</code> = <code>{pyHashLong(BigNumber(this.state.integer)).toFixed()}</code>\r\n                </div>\r\n                <p>\r\n                    {/* <span style={style}>Floats:</span> */}\r\n                    <code>hash(42.5)</code> = <code>1426259968</code>\r\n                </p>\r\n                <p>\r\n                    {/* <span style={style}>Tuples: </span> */}\r\n                    <code>hash((\"Hi\", 11))</code> = <code>4421265786515608844</code>\r\n                </p>\r\n                <p>\r\n                    {/* <span style={style}>None: </span> */}\r\n                    <code>hash(None)</code> = <code>-9223372036581563745</code>\r\n                </p>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport class Ops {\r\n    static createNew(array, size) {\r\n        const hcn = new HashCreateNew();\r\n        const [hashCodes, keys] = hcn.run(array, size);\r\n        const bp = hcn.getBreakpoints();\r\n        return {hashCodes, keys, bp};\r\n    }\r\n\r\n    static hasKey(hashCodes, keys, searchedObj) {\r\n        const hs = new HashRemoveOrSearch();\r\n        const {result, hashCodes: newHashCodes, keys: newKeys} = hs.run(hashCodes, keys, searchedObj, false);\r\n        const bp = hs.getBreakpoints();\r\n\r\n        return {result, bp, hashCodes: newHashCodes, keys: newKeys};\r\n    }\r\n\r\n    static remove(hashCodes, keys, objToRemove) {\r\n        const hr = new HashRemoveOrSearch();\r\n        const {isException, hashCodes: newHashCodes, keys: newKeys} = hr.run(hashCodes, keys, objToRemove, true);\r\n        const bp = hr.getBreakpoints();\r\n\r\n        return {isException, bp, hashCodes: newHashCodes, keys: newKeys};\r\n    }\r\n\r\n    static resize(hashCodes, keys) {\r\n        const hres = new HashResize();\r\n        const [newHashCodes, newKeys] = hres.run(hashCodes, keys);\r\n        const bp = hres.getBreakpoints();\r\n\r\n        return {bp, hashCodes: newHashCodes, keys: newKeys};\r\n    }\r\n\r\n    static insert(hashCodes, keys, objToInsert) {\r\n        const hi = new HashInsert();\r\n        const [newHashCodes, newKeys] = hi.run(hashCodes, keys, objToInsert);\r\n        const bp = hi.getBreakpoints();\r\n\r\n        return {bp, hashCodes: newHashCodes, keys: newKeys};\r\n    }\r\n}\r\n\r\nfunction ListDescription({array}) {\r\n    let countStr = array.filter(e => typeof e === 'string').length;\r\n    let countNum = array.length - countStr;\r\n    if (countStr > 0 && countNum > 0) {\r\n        return 'a mixed list of integers and strings';\r\n    } else if (countStr > 0) {\r\n        return 'a list of strings';\r\n    } else {\r\n        return 'a list of integers';\r\n    }\r\n}\r\n\r\nclass HashResizeInPlaceAnimation extends React.PureComponent {\r\n    static FULL_WIDTH = true;\r\n    static EXTRA_ERROR_BOUNDARY = true;\r\n\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            isStart: true,\r\n            breakpointsUpdatedCounter: 0,\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n        if (props.breakpoints !== state.breakpoints) {\r\n            return {\r\n                ...state,\r\n                breakpoints: props.breakpoints,\r\n                breakpointsUpdatedCounter: state.breakpointsUpdatedCounter + 1,\r\n            };\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    runAnimation = () => {\r\n        console.log('runAnimation');\r\n        this.setState(state => ({\r\n            isStart: !state.isStart,\r\n        }));\r\n    };\r\n\r\n    render() {\r\n        let hashCodes, keys;\r\n        let buttonIcon, buttonLabel;\r\n        if (this.state.isStart) {\r\n            ({hashCodes, keys} = this.state.breakpoints[0]);\r\n            buttonLabel = 'Throw away the old table';\r\n            buttonIcon = <FontAwesomeIcon icon=\"trash-alt\" />;\r\n        } else {\r\n            ({newHashCodes: hashCodes, newKeys: keys} = this.state.breakpoints[this.state.breakpoints.length - 1]);\r\n            buttonLabel = 'Reset';\r\n            buttonIcon = <FontAwesomeIcon icon=\"redo-alt\" />;\r\n        }\r\n        return (\r\n            <div className=\"hl-left\" style={{paddingLeft: 20}}>\r\n                <button\r\n                    type=\"button\"\r\n                    className=\"btn btn-primary btn-sm\"\r\n                    onClick={this.runAnimation}\r\n                    style={{minWidth: 180}}\r\n                >\r\n                    {buttonIcon} {buttonLabel}\r\n                </button>\r\n                <HashNormalStateVisualizationSmallBoxes\r\n                    bp={{hashCodes, keys}}\r\n                    epoch={this.state.breakpointsUpdatedCounter}\r\n                    fixedGeometry={SMALLER_BOX_GEOMETRY}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport class Chapter2_HashTableFunctions extends ChapterComponent {\r\n    constructor() {\r\n        super();\r\n\r\n        this.state = {\r\n            array: ['uname', 'mv', 1, 'time', -6, 'ps', 'mkdir', 'less'],\r\n            searchedObj: 'less',\r\n            objToRemove: 1,\r\n        };\r\n    }\r\n\r\n    runCreateNew = memoizeOne((array, size) => {\r\n        return Ops.createNew(array, size);\r\n    });\r\n\r\n    runSearch = memoizeOne((hashCodes, keys, searchedObj) => {\r\n        const bp = Ops.hasKey(hashCodes, keys, searchedObj).bp;\r\n        return {bp};\r\n    });\r\n\r\n    runRemove = memoizeOne((hashCodes, keys, objToRemove) => {\r\n        const {bp, hashCodes: newHashCodes, keys: newKeys} = Ops.remove(hashCodes, keys, objToRemove);\r\n        return {bp, hashCodes: newHashCodes, keys: newKeys};\r\n    });\r\n\r\n    runResize = memoizeOne((hashCodes, keys) => {\r\n        const bp = Ops.resize(hashCodes, keys).bp;\r\n        return {bp};\r\n    });\r\n\r\n    /*runInsert = memoizeOne((hashCodes, keys, objToInsert) => {\r\n        const bp = Ops.insert(hashCodes, keys, objToInsert).bp;\r\n        return {bp};\r\n    });*/\r\n\r\n    render() {\r\n        const t1 = performance.now();\r\n        const newRes = this.runCreateNew(this.state.array);\r\n        let {hashCodes, keys} = newRes;\r\n\r\n        const searchRes = this.runSearch(hashCodes, keys, this.state.searchedObj);\r\n        const removeRes = this.runRemove(hashCodes, keys, this.state.objToRemove);\r\n        hashCodes = removeRes.hashCodes;\r\n        keys = removeRes.keys;\r\n\r\n        const resizeRes = this.runResize(hashCodes, keys);\r\n        /*const insertRes = this.runInsert(hashCodes, keys, this.state.objToInsert);*/\r\n        console.log('Chapter2 render timing', performance.now() - t1);\r\n\r\n        return (\r\n            <div className=\"chapter chapter2\">\r\n                <h2> Chapter 2. Why are hash tables called hash tables? </h2>\r\n                <Subcontainerize>\r\n                    <p>\r\n                        Now that we have the solution for searching in a list of numbers, can we use it for non-integer\r\n                        objects? We can if we find a way to turn objects into numbers for indexing.\r\n                    </p>\r\n                    <p>\r\n                        {' '}\r\n                        We don't need a perfect one-to-one correspondence between objects and integers. In fact, it is\r\n                        totally fine if two unrelated objects are turned into the same number &mdash; we can use linear\r\n                        probing to resolve this collision anyway!\r\n                    </p>\r\n                    <p>\r\n                        However, if we turn all objects into the same number, for example, <code>42</code>, our hash\r\n                        table would work, but its performance would severely degrade. So, for performance reasons it is\r\n                        desirable to get distinct numbers for distinct objects usually.{' '}\r\n                    </p>\r\n                    <p>\r\n                        The transformation also needs to be completely deterministic, i.e. we need to always get the\r\n                        same value for the same object. In other words, something like <code>random()</code> would not\r\n                        work, because we would \"forget\" where we placed our objects and we wouldn't be able to locate\r\n                        them during a search.\r\n                    </p>\r\n                    <p>\r\n                        Functions that do this kind of transformation are called <em>hash functions</em>. Since it is\r\n                        not required to preserve any order in the input domain, a typical hash function \"mixes up\" its\r\n                        input domain, hence the name \"hash\".\r\n                    </p>\r\n                    <p>\r\n                        In Python, there are built-in implementations of hash functions for many built-in types. They\r\n                        are all available through a single interface: the function <code>hash()</code>. This function\r\n                        can take any Python object as an input and call an appropriate implementation (if it exists).\r\n                    </p>\r\n                    <p> Here are some examples of hash function values for some of the built-in types. </p>\r\n                    <HashExamples />\r\n                    <p>\r\n                        In the case of strings, <code>hash()</code> returns fairly unpredictable results, as it should.\r\n                        However, for small integers <code className=\"text-nowrap\">hash(x) == x</code>. This fact may\r\n                        seem surprising to people familiar with hash functions, but it is a deliberate design decision\r\n                        by Python core developers.\r\n                    </p>\r\n                    <p>\r\n                        For \"long\" integers Python uses a different algorithm. Try typing a relatively big number, for\r\n                        example, <code>12345678901234567890</code> to see this.\r\n                    </p>\r\n                    <p>\r\n                        Another fact: <code>hash()</code> never returns <code>-1</code>, because <code>-1</code> used\r\n                        internally as an indicator of an error. That's why <code>hash(-1)</code> is <code>-2</code>.\r\n                    </p>\r\n                    <h5>hash() implementation notes</h5>\r\n                    <p>\r\n                        This chapter and the next two chapters will use <code>hash()</code> implementation from Python\r\n                        3.2 (running on an x86_64 system). So if you run Python 3.2 on your x86_64 system, you should\r\n                        see the same hash values for integers and strings (and the same data structure states). One\r\n                        exception is <code>hash(None)</code>. It changes between runs, but in this explanation{' '}\r\n                        <code>hash(None)</code> is always <code>-9223372036581563745</code>.\r\n                    </p>\r\n                    <p>\r\n                        Why Python 3.2? Because dict implementation has changed over time but Python 3.2's dict\r\n                        implements most major ideas, and, thus, Python 3.2's dict is a good starting point. Later\r\n                        versions of Python extend (rather than completely replace) Python 3.2's implementation.\r\n                        Eventually, we will get to these implementations as well.\r\n                    </p>\r\n                    <h5> Unhashable types </h5>\r\n                    <p>\r\n                        Not all types are hashable. For example, lists aren't and if you call{' '}\r\n                        <code className=\"text-nowrap\">hash([\"some\", \"values\"])</code> you will get{' '}\r\n                        <code>TypeError: unhashable type: 'list'</code>. Why can't we use the same hash function for\r\n                        lists as for tuples? The answer is because lists are mutable and tuples are not.\r\n                    </p>\r\n                    <p>\r\n                        We could still define a hash function for lists and other mutable objects. However changing a\r\n                        list would change the value of the hash function as well, and therefore we will not be able to\r\n                        locate the mutated list! Hashing and using lists as keys in dicts would lead to many accidental\r\n                        bugs, so core developers of Python chose not to allow this.\r\n                    </p>\r\n                    <h5>A note on the word \"hash\"</h5>\r\n                    <p>\r\n                        Because hash tables use hash functions and because hash tables mix up inserted elements, they\r\n                        are called hash tables. Sometimes people shorten \"hash table\" to just \"hash\". The output of a\r\n                        hash function is sometimes called \"hash value\" or \"hash code\", but very often it is also\r\n                        shortened to just \"hash\". Also, Python's built-in hash function is called <code>hash()</code>.\r\n                    </p>\r\n                    <p>\r\n                        Because people like to shorten things, several different (but related) concepts end up having\r\n                        the same shortened name. This can get a bit confusing sometimes.\r\n                    </p>\r\n                    <h5> Using hash functions for hash tables </h5>\r\n                    <p>\r\n                        Recall that we started with a simple problem: searching efficiently in a list of distinct\r\n                        numbers. Now, let's make this problem harder: our hash table needs to handle duplicates, support\r\n                        types other than integers, support removing and adding keys (and therefore resizing). We will\r\n                        see how to handle values in the next chapter, but for now let's assume we only need to search\r\n                        for keys.\r\n                    </p>\r\n                    <p>How does using hash functions change the insertion algorithm?</p>\r\n                    <p>\r\n                        Obviously, we have to use <code>hash()</code> function to convert objects into integers for\r\n                        indexing.\r\n                    </p>\r\n                    <p>\r\n                        Because <code>None</code> is hashable too, we will need to use some other value as a placeholder\r\n                        for an empty slot. The cleanest way to do this is to create a new type and use a value of this\r\n                        type. In Python, this is quite simple:\r\n                    </p>\r\n                    <SimpleCodeBlock>\r\n                        {`\r\nclass EmptyValueClass(object):\r\n    pass\r\n\r\nEMPTY = EmptyValueClass()\r\n              `.trim()}\r\n                    </SimpleCodeBlock>\r\n                    <p>\r\n                        We will now use <code>EMPTY</code> to denote an empty slot. After we do this, we will be able to\r\n                        insert <code>None</code> in the hash table safely.\r\n                    </p>\r\n                    <p>\r\n                        But here is one critical thing: checking for equality of objects can be expensive. For example,\r\n                        comparing strings of length 10000 may require up to 10000 comparison operations - one per each\r\n                        pair of corresponding characters. And, we may end up doing several equality checks when doing\r\n                        linear probing.\r\n                    </p>\r\n                    <p>\r\n                        When we only had integers, we didn't have this problem, because comparing integers is cheap. But\r\n                        here is a neat trick we can use to improve the performance in the case of arbitrary objects. We\r\n                        still get numbers from hash functions. So, we can save these numbers and compare them before\r\n                        comparing actual objects. When comparing hashes, there are two different outcomes. First, the\r\n                        hashes are different; in this case, we can safely conclude that the objects are different as\r\n                        well. Second, the hashes are equal; in this case, there is a good chance that the objects are\r\n                        equal but there is still a possibility of two distinct objects having the same hash, so we have\r\n                        to compare the actual objects.\r\n                    </p>\r\n                    <p>\r\n                        This optimization is a space-time tradeoff. We spend extra memory to make the algorithm faster.\r\n                    </p>\r\n                    <p>\r\n                        In this chapter, we'll allow duplicates. Remember how search works in the previous chapter? We\r\n                        retrace the steps necessary to insert the element and check if any slot along the way contains\r\n                        it. We also do all these steps when we are actually inserting an element. This means that we're\r\n                        effectively doing a search while inserting an element. So, handling duplicates is\r\n                        straightforward &mdash; we can terminate the insertion process if we find the element. And if we\r\n                        hit an empty slot without finding the element, then the element is not in the table and it means\r\n                        that we can safely insert it.\r\n                    </p>\r\n                    <p>\r\n                        Now, let's see this algorithm in action. We'll use a separate list called{' '}\r\n                        <code>hash_codes</code> for caching values of hash functions.\r\n                    </p>\r\n                    <p>\r\n                        Let's say we have <ListDescription array={this.state.array} />:\r\n                    </p>\r\n                    <BlockInputToolbar\r\n                        input={PyListInput}\r\n                        inputProps={{minSize: 1}}\r\n                        initialValue={this.state.array}\r\n                        onChange={this.setter('array', true)}\r\n                        bottomBoundary=\".chapter2\"\r\n                        {...this.props}\r\n                    />\r\n                    <p>Let's build a hash table from it:</p>\r\n                    <VisualizedCode\r\n                        code={HASH_CREATE_NEW_CODE}\r\n                        breakpoints={newRes.bp}\r\n                        formatBpDesc={formatHashCreateNewAndInsert}\r\n                        stateVisualization={HashCreateNewStateVisualization}\r\n                        {...this.props}\r\n                    />\r\n                    <h5> Searching </h5>\r\n                    <p>\r\n                        The search algorithm hasn't changed much. We get the <code>hash()</code> function value for the\r\n                        object, and do linear probing. Just like in the first chapter, we essentially have a bunch of\r\n                        \"islands\", separated by empty slots. Each island usually contains only a few elements, and a\r\n                        linear scan over a small \"island\" isn't expensive.\r\n                    </p>\r\n                    <div className=\"div-p\">\r\n                        For instance, let's search for\r\n                        <PySNNInput\r\n                            inline={true}\r\n                            value={this.state.searchedObj}\r\n                            onChange={this.setter('searchedObj')}\r\n                            anotherValue={() => anotherValue(this.state.array)}\r\n                        />\r\n                        and see what happens:\r\n                    </div>\r\n                    <VisualizedCode\r\n                        code={HASH_SEARCH_CODE}\r\n                        breakpoints={searchRes.bp}\r\n                        formatBpDesc={formatHashRemoveSearch}\r\n                        stateVisualization={HashNormalStateVisualization}\r\n                        {...this.props}\r\n                    />\r\n                    <h5> Removing objects </h5>\r\n                    <p>\r\n                        If we removed a key without a trace, it'd leave a hole, and this would break the search\r\n                        algorithm. Then, how do we remove a key?\r\n                    </p>\r\n                    <p>\r\n                        The answer is that if we can't remove a key without a trace, we should leave a trace. When\r\n                        removing a key, we replace it with a \"dummy\" object (another term for this object is\r\n                        \"tombstone\"). This object acts as a placeholder that indicates we shouldn't stop probing during\r\n                        a search.\r\n                    </p>\r\n                    <p>\r\n                        In code, we can create this placeholder object just like we created <code>EMPTY</code>:\r\n                    </p>\r\n                    <SimpleCodeBlock>\r\n                        {`\r\nclass DummyValueClass(object):\r\n    pass\r\n\r\nDUMMY = DummyValueClass()\r\n              `.trim()}\r\n                    </SimpleCodeBlock>\r\n                    <div className=\"div-p\">\r\n                        Let's see removing in action. Let's say we want to remove:\r\n                        <PySNNInput\r\n                            inline={true}\r\n                            value={this.state.objToRemove}\r\n                            onChange={this.setter('objToRemove')}\r\n                            anotherValue={() => anotherValue(this.state.array, 0.7, 0.2, 0.1)}\r\n                        />\r\n                    </div>\r\n                    <VisualizedCode\r\n                        code={HASH_REMOVE_CODE}\r\n                        breakpoints={removeRes.bp}\r\n                        formatBpDesc={formatHashRemoveSearch}\r\n                        stateVisualization={HashNormalStateVisualization}\r\n                        {...this.props}\r\n                    />\r\n                    <p>\r\n                        Removing a lot of objects may lead to a table being filled with these dummy objects. What if a\r\n                        table overflows with dummy objects? There is a way to clean them up. But first, let's see what\r\n                        happens if a table overflows with ordinary objects.\r\n                    </p>\r\n                    <h5>Resizing hash tables</h5>\r\n                    <p>\r\n                        How do we resize a hash table? The index of each element depends on the table size, so it may\r\n                        change if the size of a table changes. Moreover, because of collisions and linear probing, each\r\n                        index may depend on the indexes of other objects (which, in turn, also depend on the size of a\r\n                        table and the indexes of other objects). This is a tangled mess.\r\n                    </p>\r\n                    <p>\r\n                        There is a way to disentangle this Gordian Knot, however. We can create a new, bigger table and\r\n                        re-insert all the elements from the smaller table (skipping dummy placeholders). This may sound\r\n                        expensive. And, it <em>is</em> expensive. But, the thing is, we don't have to resize the table\r\n                        after every operation. If we make the new table size 1.5x, 2x or even 4x the size of the old\r\n                        table, it'll take a while until it fills up again. We will do resizes rarely enough that the\r\n                        heavy cost of it will amortize (spread out) over many insertions/deletions.\r\n                    </p>\r\n                    <HashResizeInPlaceAnimation breakpoints={resizeRes.bp} />\r\n                    <p className=\"mt-2\">\r\n                        Since we're re-building the table, the code is fairly similar to the code for building it from\r\n                        scratch. The differences are:\r\n                    </p>\r\n                    <ul>\r\n                        <li>the hash codes are already there, so we don't need to compute them the second time;</li>\r\n                        <li>\r\n                            we don't have to check for duplicates, because we know that each object is present only once\r\n                            in the original table;\r\n                        </li>\r\n                        <li>we skip empty and dummy slots.</li>\r\n                    </ul>\r\n                    <VisualizedCode\r\n                        code={HASH_RESIZE_CODE}\r\n                        breakpoints={resizeRes.bp}\r\n                        formatBpDesc={formatHashResize}\r\n                        stateVisualization={HashResizeStateVisualization}\r\n                        {...this.props}\r\n                    />\r\n                    <p>\r\n                        There is still one more important question. What condition should trigger the resizing\r\n                        operation? If we postpone resizing until a table is nearly full, the performance will severely\r\n                        degrade. If we resize a table when it is still sparse, we will waste memory. Typically, a hash\r\n                        table is resized when it is around 66% full.\r\n                    </p>\r\n                    <p>\r\n                        The number of non-empty slots (including dummy/tombstone slots) is called <em>fill</em>. The\r\n                        ratio between fill and table capacity is called the <em>load factor</em> (also, sometimes:{' '}\r\n                        <em>fill factor</em> or <em>fill ratio</em>\r\n                        ). So, using the new terms, we can say that a hash table is resized when the load factor reaches\r\n                        66%. When a table is resized, it's size usually goes up, but sometimes it can actually go down,\r\n                        if there are a lot of dummy slots.\r\n                    </p>\r\n                    <p>\r\n                        To implement this efficiently, we need to track the load factor. We will need two counters for\r\n                        tracking fill and \"real\" usage. With the current code structure, tracking these counters would\r\n                        be messy because we would need to pass these counters to and from every function. A much cleaner\r\n                        solution would be using classes. More on that in the next chapter.\r\n                    </p>\r\n                </Subcontainerize>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport memoizeOne from 'memoize-one';\r\nimport {List as ImmutableList} from 'immutable';\r\n\r\nimport {Subcontainerize, COLOR_FOR_READ_OPS, singularOrPluralRus} from './util';\r\nimport {Chapter2_HashTableFunctions} from './chapter2_hash_table_functions';\r\nimport {joinBreakpoints, BreakpointFunction} from './hash_impl_common';\r\nimport {VisualizedCode, TetrisFactory, LineOfBoxesComponent, HashBoxesComponent, dummyFormat} from './code_blocks';\r\n\r\nexport const BUBBLE_SORT_CODE = [\r\n    ['def bubble_sort(a):', '', 0],\r\n    ['    for i in range(len(a)):', 'for-i', 1],\r\n    ['        swapped = False', 'swapped-false', 1],\r\n    ['        for j in range(len(a) - i - 1):', 'for-j', 2],\r\n    ['            if a[j] > a[j + 1]:', 'compare', 2],\r\n    ['                a[j], a[j + 1] = a[j + 1], a[j]', 'swap', 2],\r\n    ['                swapped = True', 'swapped-true', 2],\r\n    ['        if not swapped:', 'check-swapped', 1],\r\n    ['            break', 'break-swapped', 1],\r\n    ['', 'end', -1],\r\n];\r\n\r\nexport class BubbleSort extends BreakpointFunction {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    run(_a, granular = false) {\r\n        this.a = new ImmutableList(_a);\r\n        const n = _a.length;\r\n\r\n        for (this.i = 0; this.i < n; ++this.i) {\r\n            this.addBP('for-i');\r\n            this.swapped = false;\r\n            this.addBP('swapped-false');\r\n            for (this.j = 0; this.j < n - 1 - this.i; ++this.j) {\r\n                this.jplus1 = this.j + 1;\r\n                if (granular) {\r\n                    this.addBP('for-j');\r\n                }\r\n                const aj = this.a.get(this.j);\r\n                const ajplus1 = this.a.get(this.j + 1);\r\n                if (granular) {\r\n                    this.addBP('compare');\r\n                }\r\n                if (aj > ajplus1) {\r\n                    this.a = this.a.set(this.j, ajplus1);\r\n                    this.a = this.a.set(this.j + 1, aj);\r\n                    if (granular) {\r\n                        this.addBP('swap');\r\n                    }\r\n                    this.swapped = true;\r\n                    if (granular) {\r\n                        this.addBP('swapped-true');\r\n                    }\r\n                }\r\n            }\r\n            this.j = undefined;\r\n            this.jplus1 = undefined;\r\n            this.addBP('check-swapped');\r\n            if (!this.swapped) {\r\n                this.addBP('break-swapped');\r\n                return;\r\n            }\r\n            this.swapped = undefined;\r\n        }\r\n        this.addBP('end');\r\n\r\n        return this.a;\r\n    }\r\n}\r\n\r\nexport function formatBubbleSort(bp) {\r\n    switch (bp.point) {\r\n        case 'for-i':\r\n            return `Делаем <code>${bp.i + 1}</code>-ю итерацию сортировки`;\r\n        case 'swapped-false':\r\n            return `На этой итерации элементы еще не меняли местами`;\r\n        case 'for-j':\r\n            return `Посмотрим на <code>${bp.j}</code>-й элемент, <code>${bp.a.get(bp.j)}</code>`;\r\n        case 'compare': {\r\n            const aj = bp.a.get(bp.j);\r\n            const aj1 = bp.a.get(bp.j + 1);\r\n            return `<code>${aj} ${formatComparison(aj, aj1)} ${aj1}</code>, сравниваем его с соседним`;\r\n        }\r\n        case 'swap': {\r\n            return `Поменяем соседей местами`;\r\n        }\r\n        case 'swapped-true': {\r\n            return `Запомним, что поменяли местами`;\r\n        }\r\n        case 'check-swapped': {\r\n            return bp.swapped\r\n                ? `На этой итерации мы делали обмены, поэтому продолжаем`\r\n                : `На этой итерации мы не сделали обменов, поэтому массив отсортирован`;\r\n        }\r\n        case 'break-swapped':\r\n            return 'Выходим';\r\n        case 'end':\r\n            return 'Массив отсортирован';\r\n    }\r\n}\r\n\r\nexport const INSERTION_SORT_CODE = [\r\n    ['def insertion_sort(a):', '', 0],\r\n    ['    for i in range(1, len(a)):', 'for-i', 2],\r\n    ['        currentValue = array[i]', 'assign-current-value', 2],\r\n    ['        pos = i', 'assign-pos', 2],\r\n    ['', '', -1],\r\n    ['        while pos > 0 and a[pos - 1] > currentValue:', 'while', 3],\r\n    ['            a[pos] = a[pos - 1]', 'swap', 3],\r\n    ['            pos -= 1', 'dec-pos', 3],\r\n    ['', '', -1],\r\n    ['        a[pos] = currentValue', 'assign-a-found-pos', 2],\r\n    ['', 'end', -1],\r\n];\r\n\r\nexport class InsertionSort extends BreakpointFunction {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    run(_a, granular = false) {\r\n        this.a = new ImmutableList(_a);\r\n        const n = _a.length;\r\n\r\n        for (this.i = 1; this.i < n; ++this.i) {\r\n            this.addBP('for-i');\r\n            this.currentValue = this.a.get(this.i);\r\n            // this.addBP('assign-current-value');\r\n            this.pos = this.i;\r\n            if (granular) {\r\n                this.addBP('assign-pos');\r\n                this.addBP('while');\r\n            }\r\n            while (this.pos > 0 && this.a.get(this.pos - 1) > this.currentValue) {\r\n                this.a = this.a.set(this.pos, this.a.get(this.pos - 1));\r\n                if (granular) {\r\n                    this.addBP('swap');\r\n                }\r\n                this.pos--;\r\n                if (granular) {\r\n                    this.addBP('dec-pos');\r\n                }\r\n            }\r\n\r\n            this.a = this.a.set(this.pos, this.currentValue);\r\n            if (granular) {\r\n                this.addBP('assign-a-found-pos');\r\n            }\r\n        }\r\n        this.i = null;\r\n        this.pos = null;\r\n        this.addBP('end');\r\n        return this.a;\r\n    }\r\n}\r\n\r\nexport const MERGE_SORT_CODE = [\r\n    ['def merge_sort(a, l, r):', 'def-merge-sort', 0],\r\n    ['    if r - l > 1:', 'compare-size', 1],\r\n    ['        m = (l + r) // 2', 'compute-m', 1],\r\n    ['        merge_sort(a, l, m)', 'merge-sort-left', 2],\r\n    ['        merge_sort(a, m, r)', 'merge-sort-right', 2],\r\n    ['        merge(a, l, m, r)', 'merge', 2],\r\n    ['', 'end', -1],\r\n    ['', '', -1],\r\n    ['def merge(a, l, m, r):', 'def-merge', 0],\r\n    ['   left_a = a[l:m]', 'left-copy', 1],\r\n    ['   right_a = a[m:r]', 'right-copy', 1],\r\n    ['   li = 0', 'assign-li', 1],\r\n    ['   ri = 0', 'assign-ri', 1],\r\n    ['   for i in range(l,r):', 'for-i', 2],\r\n    ['        if ri >= len(right_a) or \\\\', 'if-right-ended', 3],\r\n    ['           (li < len(left_a) and left_a[li] < right_a[ri]):', 'if-left-not-ended-smaller', 3],\r\n    ['            a[i] = left_a[li]', 'assign-left-a', 3],\r\n    ['            li += 1', 'inc-li', 3],\r\n    ['        else:', '', 3],\r\n    ['            a[i] = right_a[ri]', 'assign-right-a', 3],\r\n    ['            ri += 1', 'inc-ri', 3],\r\n];\r\n\r\nclass MergeSort extends BreakpointFunction {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    merge() {\r\n        this.left_a = this.a.slice(this.l, this.m);\r\n        this.addBP('left-copy');\r\n        this.right_a = this.a.slice(this.m, this.r);\r\n        console.log('right_a', this.left_a, this.right_a);\r\n        this.addBP('right-copy');\r\n        this.li = 0;\r\n        this.addBP('assign-li');\r\n        this.ri = 0;\r\n        this.addBP('assign-ri');\r\n        this.addBP('for-i');\r\n        for (this.i = this.l; this.i < this.r; ++this.i) {\r\n            this.addBP('if-right-ended');\r\n            let isLeftSide = false;\r\n            if (this.ri >= this.right_a.size) {\r\n                this.addBP('if-left-not-ended-smaller');\r\n                isLeftSide = true;\r\n            } else {\r\n                if (this.li < this.left_a.size && this.left_a.get(this.li) < this.right_a.get(this.ri)) {\r\n                    isLeftSide = true;\r\n                } else {\r\n                    isLeftSide = false;\r\n                }\r\n            }\r\n            if (isLeftSide) {\r\n                this.a = this.a.set(this.i, this.left_a.get(this.li));\r\n                this.addBP('assign-left-a');\r\n                this.li++;\r\n                this.addBP('inc-li');\r\n            } else {\r\n                this.a = this.a.set(this.i, this.right_a.get(this.ri));\r\n                this.addBP('assign-left-a');\r\n                this.ri++;\r\n                this.addBP('inc-ri');\r\n            }\r\n        }\r\n        this.i = null;\r\n        this.left_a = new ImmutableList();\r\n        this.right_a = new ImmutableList();\r\n        this.li = null;\r\n        this.ri = null;\r\n    }\r\n\r\n    run(_a) {\r\n        this.a = new ImmutableList(_a);\r\n        this.left_a = new ImmutableList();\r\n        this.right_a = new ImmutableList();\r\n        this.mergeSort(0, _a.length);\r\n    }\r\n\r\n    mergeSort(_l, _r) {\r\n        this.l = _l;\r\n        this.r = _r;\r\n        console.log('mergeSort', _l, _r);\r\n\r\n        this.addBP('compare-size');\r\n        if (this.r - this.l > 1) {\r\n            this.m = Math.trunc((this.l + this.r) / 2);\r\n            this.addBP('compute-m');\r\n            const savedM = this.m;\r\n            const savedL = this.l;\r\n            const saverR = this.r;\r\n            this.addBP('merge-sort-left');\r\n            this.mergeSort(this.l, this.m);\r\n            this.m = savedM;\r\n            this.l = savedL;\r\n            this.r = saverR;\r\n            this.addBP('merge-sort-right');\r\n            this.mergeSort(this.m, this.r);\r\n            this.m = savedM;\r\n            this.l = savedL;\r\n            this.r = saverR;\r\n            this.merge();\r\n        }\r\n        this.addBP('end');\r\n    }\r\n}\r\n\r\nexport const BubbleSortVisualisationFactory = withLabel =>\r\n    TetrisFactory([\r\n        [\r\n            HashBoxesComponent,\r\n            [\r\n                {labels: withLabel ? ['a'] : [null]},\r\n                'a',\r\n                'j',\r\n                'jplus1',\r\n                {selection1color: 'red', selection2color: 'red'},\r\n            ],\r\n        ],\r\n    ]);\r\n\r\nexport const BubbleSortVisualisation = BubbleSortVisualisationFactory(true);\r\nexport const BubbleSortVisualisationNoLabel = BubbleSortVisualisationFactory(false);\r\n\r\nconst InsertionSortVisualisation = TetrisFactory([[HashBoxesComponent, [{labels: ['a']}, 'a', 'i', undefined]]]);\r\n\r\nconst MergeSortVisualisation = TetrisFactory([\r\n    [HashBoxesComponent, [{labels: ['a']}, 'a', 'l', 'r']],\r\n    [HashBoxesComponent, [{labels: ['left_a']}, 'left_a', 'li']],\r\n    [HashBoxesComponent, [{labels: ['right_a']}, 'right_a', 'ri']],\r\n]);\r\n\r\nconst TwoHashCreateNewStateVisualization = TetrisFactory([\r\n    [\r\n        LineOfBoxesComponent,\r\n        [\r\n            {labels: ['from_keys'], marginBottom: 20},\r\n            'plus1_fromKeys',\r\n            'plus1_fromKeysIdx',\r\n            'double_fromKeysIdx',\r\n            {selection1color: COLOR_FOR_READ_OPS},\r\n        ],\r\n    ],\r\n    [HashBoxesComponent, [{labels: ['keys'], marginBottom: 7}, 'plus1_keys', 'plus1_idx']],\r\n    [HashBoxesComponent, [{labels: ['hash_codes']}, 'plus1_hashCodes', 'plus1_idx']],\r\n    [HashBoxesComponent, [{labels: ['keys'], marginBottom: 7}, 'double_keys', 'double_idx']],\r\n    [HashBoxesComponent, [{labels: ['hash_codes']}, 'double_hashCodes', 'double_idx']],\r\n]);\r\n\r\nexport class NewDemos extends Chapter2_HashTableFunctions {\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            array: ['ps', 'du', 'ls', 'cat', 'top', 'ping', 'chmod', 'grep', 'gzip', 'dd', 'chown', 'at', 'awk', 'rm'],\r\n            arrayNum: [42, 13, 27, 89, 14, 67, 92, 54, 11, 45, 29, 33],\r\n            // array: ['ps', 'du', 'ls', 'cat', 'top', 'ping', 'chmod', 'grep', 'gzip'],\r\n        };\r\n    }\r\n\r\n    runBubbleSort = memoizeOne(a => {\r\n        const bs = new BubbleSort();\r\n        bs.run(a);\r\n        const bp = bs.getBreakpoints();\r\n        return {bp};\r\n    });\r\n\r\n    runInsertionSort = memoizeOne((a, granular) => {\r\n        const is = new InsertionSort();\r\n        is.run(a, granular);\r\n        const bp = is.getBreakpoints();\r\n        return {bp};\r\n    });\r\n\r\n    runMergeSort = memoizeOne(a => {\r\n        const ms = new MergeSort();\r\n        ms.run(a);\r\n        const bp = ms.getBreakpoints();\r\n        return {bp};\r\n    });\r\n\r\n    render() {\r\n        console.log('New demos', this.state.array);\r\n        const newPlus1 = this.runCreateNew(this.state.array, this.state.array.length);\r\n        const newDouble = this.runCreateNew(this.state.array, 2 * this.state.array.length);\r\n        const joinedBp = joinBreakpoints([newPlus1.bp, newDouble.bp], ['plus1', 'double']);\r\n\r\n        const bubbleSortRes = this.runBubbleSort(this.state.arrayNum);\r\n        console.log('!!!', joinedBp.bp);\r\n        const insertionSortRes = this.runInsertionSort(this.state.arrayNum);\r\n\r\n        const insertionSortGranularRes = this.runInsertionSort(this.state.arrayNum, true);\r\n        const mergeSortRes = this.runMergeSort(this.state.arrayNum);\r\n        console.log('!!! merge bp', mergeSortRes);\r\n\r\n        return (\r\n            <div className=\"chapter new_demos\">\r\n                <h2>Demos</h2>\r\n                <Subcontainerize>\r\n                    <p>Filling hash demo</p>\r\n                    <VisualizedCode\r\n                        breakpoints={joinedBp}\r\n                        stateVisualization={TwoHashCreateNewStateVisualization}\r\n                        {...this.props}\r\n                    />\r\n                    <VisualizedCode\r\n                        code={BUBBLE_SORT_CODE}\r\n                        breakpoints={bubbleSortRes.bp}\r\n                        formatBpDesc={dummyFormat}\r\n                        stateVisualization={BubbleSortVisualisation}\r\n                        {...this.props}\r\n                    />\r\n                    <VisualizedCode\r\n                        code={INSERTION_SORT_CODE}\r\n                        breakpoints={insertionSortRes.bp}\r\n                        formatBpDesc={dummyFormat}\r\n                        stateVisualization={InsertionSortVisualisation}\r\n                        {...this.props}\r\n                    />\r\n                    <VisualizedCode\r\n                        code={INSERTION_SORT_CODE}\r\n                        breakpoints={insertionSortGranularRes.bp}\r\n                        formatBpDesc={dummyFormat}\r\n                        stateVisualization={InsertionSortVisualisation}\r\n                        {...this.props}\r\n                    />\r\n                    <VisualizedCode\r\n                        code={MERGE_SORT_CODE}\r\n                        breakpoints={mergeSortRes.bp}\r\n                        formatBpDesc={dummyFormat}\r\n                        stateVisualization={MergeSortVisualisation}\r\n                        {...this.props}\r\n                    />\r\n                </Subcontainerize>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport const QUICK_SORT_CODE = [\r\n    ['def quicksort(a, start, stop):', '', 0],\r\n    ['    if start >= stop:', 'compare-size', 1],\r\n    ['        return', 'return', 2],\r\n    ['', '', -1],\r\n    ['    pivot = a[(start + stop) // 2]', 'select-pivot', 1],\r\n    ['    left = start', 'left-start', 1],\r\n    ['    right = stop', 'right-stop', 1],\r\n    ['', '', -1],\r\n    ['    while left <= right:', 'while-left-right', 2],\r\n    ['        while a[left] < pivot:', 'while-left', 3],\r\n    ['            left += 1', 'inc-left-first', 3],\r\n    ['        while a[right] > pivot:', 'while-right', 3],\r\n    ['            right -= 1', 'dec-right-first', 3],\r\n    ['        if left <= right:', 'compare-left-right', 2],\r\n    ['            a[left], a[right] = a[right], a[left]', 'swap', 3],\r\n    ['            left += 1', 'inc-left-second', 3],\r\n    ['            right -= 1', 'dec-right-second', 3],\r\n    ['    quicksort(a, start, right)', 'sort-left', 1],\r\n    ['    quicksort(a, left, stop)', 'sort-right', 1],\r\n    ['    ', 'exit', 1],\r\n];\r\n\r\nfunction formatComparison(num1, num2) {\r\n    if (num1 === num2) {\r\n        return '==';\r\n    } else if (num1 < num2) {\r\n        return '<';\r\n    } else {\r\n        return '>';\r\n    }\r\n}\r\n\r\nexport function formatQuickSort(bp) {\r\n    switch (bp.point) {\r\n        case 'compare-size': {\r\n            const len = bp.stop - bp.start + 1;\r\n            const explanation =\r\n                len <= 0\r\n                    ? 'пустой подмассив уже отсортирован'\r\n                    : len === 1\r\n                    ? `${bp.recursionLevel > 0 ? 'под' : ''}массив из одного элемента уже отсортирован`\r\n                    : `сортируем ${bp.recursionLevel > 0 ? 'под' : ''}массив длины <code>${len}</code>`;\r\n            return `<code>${bp.start} ${formatComparison(bp.start, bp.stop)} ${bp.stop}</code>: ${explanation}`;\r\n        }\r\n        case 'return':\r\n            return 'Ничего делать не нужно — выходим';\r\n        case 'select-pivot':\r\n            return `Выбираем элемент-разделитель: <code>${bp.pivot}</code>`;\r\n        case 'left-start':\r\n            return `Левый указатель: <code>${bp.left}</code>`;\r\n        case 'right-stop':\r\n            return `Правый указатель: <code>${bp.right}</code>`;\r\n        case 'while-left-right': {\r\n            const len = bp.right - bp.left + 1;\r\n            const explanation =\r\n                len <= 0\r\n                    ? `все элементы слева от разделителя меньше него, а все справа — больше`\r\n                    : `остается обработать ${len} ${singularOrPluralRus(len, 'элемент', 'элемента', 'элементов')}`;\r\n            return `<code>${bp.left} ${bp.left <= bp.right ? '<=' : '>'} ${bp.right}</code>: ${explanation}`;\r\n        }\r\n        case 'while-left': {\r\n            const a = bp.array.get(bp.left);\r\n            const explanation =\r\n                a < bp.pivot\r\n                    ? 'элемент слева от разделителя уже меньше'\r\n                    : `слева должны быть элементы меньше разделителя, а мы натолкнулись на ${\r\n                          a === bp.pivot ? 'равный' : 'больший'\r\n                      } элемент`;\r\n            return `<code>${a} ${formatComparison(a, bp.pivot)} ${bp.pivot}</code>: ${explanation}`;\r\n        }\r\n        case 'while-right': {\r\n            const a = bp.array.get(bp.right);\r\n            console.log('While right', a, bp.array, bp.array.get(bp.right));\r\n            const explanation =\r\n                a > bp.pivot\r\n                    ? 'элемент справа от разделителя уже больше'\r\n                    : `справа должны быть элементы больше разделителя, а мы натолкнулись на ${\r\n                          a === bp.pivot ? 'равный' : 'меньший'\r\n                      } элемент`;\r\n            return `<code>${a} ${formatComparison(a, bp.pivot)} ${bp.pivot}</code>: ${explanation}`;\r\n        }\r\n        case 'inc-left-first':\r\n        case 'inc-left-second':\r\n            return `Сдвигаем левый указатель вправо на <code>${bp.left}</code> элемент`;\r\n        case 'dec-right-first':\r\n        case 'dec-right-second':\r\n            return `Сдвигаем правый указатель влево на <code>${bp.right}</code> элемент`;\r\n        case 'compare-left-right': {\r\n            const len = bp.right - bp.left + 1;\r\n            return `<code>${bp.left} ${formatComparison(bp.left, bp.right)} ${\r\n                bp.right\r\n            }</code>: еще ${len} ${singularOrPluralRus(len, 'элемент', 'элемента', 'элементов')} для обработки`;\r\n        }\r\n        case 'swap': {\r\n            const isSame = bp.left === bp.right;\r\n            if (isSame) {\r\n                return `Ничего не происходит: меняем элемент сам с собой`;\r\n            } else {\r\n                return `Меняем местами элементы, на которые наткнулись: <code>${bp.array.get(\r\n                    bp.right\r\n                )}</code> и <code>${bp.array.get(bp.left)}</code>`;\r\n            }\r\n        }\r\n        case 'sort-left':\r\n            return `Рекурсивно сортируем левый подмассив <code>${bp.start}..${bp.right}</code>`;\r\n        case 'sort-right':\r\n            return `Рекурсивно сортируем правый подмассив <code>${bp.left}..${bp.stop}</code>`;\r\n        case 'exit': {\r\n            if (bp.recursionLevel > 0) {\r\n                return `Подмассив <code>${bp.start}..${\r\n                    bp.stop\r\n                }</code> отсортирован. Выходим из рекурсии (текущая глубина: ${bp.recursionLevel})`;\r\n            } else {\r\n                return `Весь массив отсортирован, выходим`;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport class QuickSort extends BreakpointFunction {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    run(_a) {\r\n        this.array = new ImmutableList(_a);\r\n        this.recursionLevel = 0;\r\n        this.quickSort(0, _a.length - 1);\r\n    }\r\n\r\n    quickSort(_start, _stop) {\r\n        this.start = _start;\r\n        this.stop = _stop;\r\n        this.addBP('compare-size');\r\n        console.log('quicksort', this.start, this.stop);\r\n        if (this.stop <= this.start) {\r\n            this.addBP('return');\r\n            return;\r\n        }\r\n        this.pivot = this.array.get(Math.trunc((this.start + this.stop) / 2));\r\n        this.addBP('select-pivot');\r\n        this.left = this.start;\r\n        this.addBP('left-start');\r\n        this.right = this.stop;\r\n        this.addBP('right-stop');\r\n\r\n        while (true) {\r\n            this.addBP('while-left-right');\r\n            if (this.left > this.right) {\r\n                break;\r\n            }\r\n\r\n            while (true) {\r\n                this.addBP('while-left');\r\n                if (this.array.get(this.left) >= this.pivot) {\r\n                    break;\r\n                }\r\n                this.left++;\r\n                this.addBP('inc-left-first');\r\n            }\r\n\r\n            while (true) {\r\n                this.addBP('while-right');\r\n                if (this.array.get(this.right) <= this.pivot) {\r\n                    break;\r\n                }\r\n                this.right--;\r\n                this.addBP('dec-right-first');\r\n            }\r\n\r\n            this.addBP('compare-left-right');\r\n            if (this.left <= this.right) {\r\n                const _al = this.array.get(this.left);\r\n                const _ar = this.array.get(this.right);\r\n                this.array = this.array.set(this.left, _ar);\r\n                this.array = this.array.set(this.right, _al);\r\n                this.addBP('swap');\r\n                this.left += 1;\r\n                this.addBP('inc-left-second');\r\n                this.right -= 1;\r\n                this.addBP('dec-right-second');\r\n            }\r\n        }\r\n\r\n        console.log(this.start, this.left, this.right, this.stop);\r\n        const savedPivot = this.pivot;\r\n        const savedLeft = this.left;\r\n        const savedRight = this.right;\r\n        const savedStop = this.stop;\r\n        const savedStart = this.start;\r\n\r\n        this.pivot = undefined;\r\n        this.left = undefined;\r\n        this.addBP('sort-left');\r\n        this.recursionLevel++;\r\n        this.quickSort(this.start, this.right);\r\n        this.recursionLevel--;\r\n\r\n        this.pivot = savedPivot;\r\n        this.left = savedLeft;\r\n        this.right = savedRight;\r\n        this.stop = savedStop;\r\n        this.start = savedStart;\r\n\r\n        this.pivot = undefined;\r\n        this.right = undefined;\r\n        this.addBP('sort-right');\r\n        this.recursionLevel++;\r\n        this.quickSort(this.left, this.stop);\r\n        this.recursionLevel--;\r\n\r\n        this.addBP('exit');\r\n    }\r\n}\r\n","import * as React from 'react';\n\nexport const ArrowLeft = () => {\n    return (\n        <svg width=\"11\" height=\"17\" viewBox=\"0 0 11 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path\n                d=\"M1.10807 7.87806L8.22902 0.757486C8.57233 0.414171 9.12926 0.414171 9.47257 0.757486L10.3032 1.58811C10.6461 1.93106 10.6465 2.48652 10.3047 2.8302L4.66103 8.49984L10.3043 14.1698C10.6465 14.5135 10.6458 15.069 10.3028 15.4119L9.4722 16.2426C9.12889 16.5859 8.57196 16.5859 8.22865 16.2426L1.10807 9.12162C0.764757 8.7783 0.764757 8.22138 1.10807 7.87806Z\"\n                fill=\"#ffff\"\n            />\n        </svg>\n    );\n};\n","import * as React from 'react';\nimport classnames from 'classnames';\nimport SmoothScrollbar from 'react-smooth-scrollbar';\nimport {BigNumber} from 'bignumber.js';\n\nimport './player.css';\n\nimport Slider from 'rc-slider/lib/Slider';\nimport 'rc-slider/assets/index.css';\n\nimport rightArrow from './icons/keyboard_arrow_right.svg';\nimport leftArrow from './icons/keyboard_arrow_left.svg';\nimport playArrow from './icons/play_arrow.svg';\nimport pauseButton from './icons/pause.svg';\n\nimport {CodeBlockWithActiveLineAndAnnotations} from './code_blocks';\nimport {Redirect} from 'react-router';\nimport {isDefinedSmallBoxScreen} from './util';\nimport {ParsableInputBase} from './inputs';\nimport _ from 'lodash';\nimport {dumpPyList, dumpSimplePyObj, parsePyList, parsePyNumber, parsePyStringOrNumberOrNone} from './py_obj_parsing';\nimport {ArrowLeft} from './icons/_ArrowLeft';\n\nclass PlayerInput extends ParsableInputBase {\n    ERROR_COLOR = 'rgb(222, 39, 22)';\n\n    getPattern() {\n        if (this.props.type === 'array_int') {\n            return '[0-9 ,]*';\n        } else if (this.props.type === 'int') {\n            return '[0-9]*';\n        }\n        return null;\n    }\n\n    render() {\n        console.log('Input state', this.state);\n\n        let errorMsg;\n        if (this.state.error) {\n            errorMsg =\n                this.state.error.text && this.state.error.text.ru ? this.state.error.text.ru : this.state.error.message;\n        }\n\n        const style = {borderColor: errorMsg ? this.ERROR_COLOR : '#000'};\n        if (this.props.type === 'int' || this.props.type === 'int_str_none') {\n            style.width = 50;\n        }\n        return (\n            <div className=\"player-input-wrapper\">\n                {this.props.label && <span className=\"player-input-label\">{this.props.label}</span>}\n                <input\n                    pattern={this.getPattern()}\n                    type={this.props.type === 'int' ? 'number' : undefined}\n                    style={style}\n                    className={classnames('player-input', errorMsg ? 'player-input-error' : null)}\n                    onChange={this.handleChange}\n                    value={this.state.valueRaw}\n                />\n                {errorMsg && (\n                    <span className=\"player-input-comment\" style={{color: this.ERROR_COLOR}}>\n                        {errorMsg}\n                    </span>\n                )}\n            </div>\n        );\n    }\n}\n\nfunction intValidator(num) {\n    if (!BigNumber.isBigNumber(num) && typeof num !== 'number') {\n        return {en: 'Expected an integer', ru: 'Допустимы только числа'};\n    }\n}\n\nfunction dumpValue(val, type) {\n    if (type === 'array_int' || type === 'array') {\n        return dumpPyList(val);\n    } else if (type === 'int' || type === 'int_str_none') {\n        return dumpSimplePyObj(val);\n    }\n}\n\nfunction parseValue(s, type) {\n    console.log('parseValue', s, type);\n    if (type === 'array_int') {\n        return parsePyList(s, false, 1, intValidator);\n    } else if (type === 'array') {\n        return parsePyList(s, true, 1);\n    } else if (type === 'int') {\n        return parsePyNumber(s);\n    } else if (type === 'int_str_none') {\n        return parsePyStringOrNumberOrNone(s);\n    }\n}\n\nexport class Player extends React.Component {\n    SLIDER_MULTIPLIER = 1000;\n    SLIDER_AUTOPLAY_UPDATE_MS = 5;\n    SLIDER_AUTOPLAY_BASE_MS = 750;\n\n    MAX_WIDTH = 1300;\n\n    INPUTS_LS_PREFIX = 'player-v1-1-';\n\n    constructor(props) {\n        super(props);\n\n        const timeStr = localStorage.getItem(props.lessonId + '_time');\n\n        const inputs = this.props.inputs || [];\n        const resetToZero = props.resetToZero;\n\n        const programInputs = [];\n        const originalRawInputs = [];\n        const onInputChangeHandlers = [];\n        for (let i = 0; i < inputs.length; ++i) {\n            const input = inputs[i];\n\n            const ls = localStorage.getItem(this.INPUTS_LS_PREFIX + input.id);\n\n            const rawValue = ls ? ls : input.default;\n            programInputs.push(parseValue(rawValue, input.type));\n            originalRawInputs.push(rawValue);\n            onInputChangeHandlers.push((value, valueRaw) => {\n                console.log('equal compare', dumpValue(programInputs[i], input.type), dumpValue(value, input.type));\n\n                if (dumpValue(programInputs[i], input.type) !== dumpValue(value, input.type)) {\n                    const programInputs = [...this.state.programInputs];\n                    programInputs[i] = value;\n                    const breakpoints = this.props.getBreakpoints(...programInputs);\n\n                    const time = !resetToZero && this.state.time > 0 ? breakpoints.length - 1 : 0;\n                    this.setState({programInputs, breakpoints, time, sliderTime: time});\n                    this.saveSliderTimeToLS(time);\n\n                    localStorage.setItem(this.INPUTS_LS_PREFIX + input.id, valueRaw);\n\n                    console.log('onInputChangeHandlers', value, programInputs, breakpoints);\n                }\n            });\n        }\n        this.onInputChangeHandlers = onInputChangeHandlers;\n\n        console.log('Inputs', programInputs);\n        const breakpoints = this.props.getBreakpoints(...programInputs);\n        console.log('breakpoints', breakpoints);\n\n        const sliderTime = Math.min(+timeStr || 0, breakpoints.length - 1);\n        this.state = {\n            time: Math.round(sliderTime),\n            sliderTime,\n            autoPlaying: false,\n            showingTheory: false,\n\n            // react router stuff\n            navigatingHome: false,\n            breakpoints,\n            programInputs,\n            originalRawInputs,\n        };\n\n        console.log('Player constructor state', this.state);\n\n        this.componentRef = React.createRef();\n    }\n\n    navigateHome = () => {\n        this.setState({navigatingHome: true});\n    };\n\n    maxTime = () => {\n        return this.state.breakpoints.length - 1;\n    };\n\n    unixtimestamp() {\n        return new Date().getTime();\n    }\n\n    static getDerivedStateFromProps(nextProps, state) {\n        return {time: nextProps.time};\n    }\n\n    handleSliderValueChange = (value) => {\n        this.stop();\n        const sliderTime = value / this.SLIDER_MULTIPLIER;\n        this.handleTimeChange(sliderTime);\n    };\n\n    saveSliderTimeToLS = (sliderTime) => {\n        localStorage.setItem(this.props.lessonId + '_time', sliderTime.toString());\n    };\n\n    handleTimeChange = (sliderTime, autoPlaying = false, onStateChange) => {\n        console.log('handleTimeChange', sliderTime, autoPlaying);\n        const time = Math.round(sliderTime);\n        this.setState(() => ({time, sliderTime, autoPlaying}), onStateChange);\n        setTimeout(\n            _.throttle(() => this.saveSliderTimeToLS(sliderTime), 500),\n            0\n        );\n        // this.props.handleTimeChange(value);\n    };\n\n    prevStep = () => {\n        this.stop();\n        if (this.state.time > 0) {\n            const newTime = this.state.time - 1;\n            this.handleTimeChange(newTime);\n        }\n    };\n\n    nextStep = () => {\n        this.stop();\n        if (this.state.time < this.maxTime()) {\n            const newTime = this.state.time + 1;\n            this.handleTimeChange(newTime);\n        }\n    };\n\n    singleAutoPlayIteration = () => {\n        console.log('autoplay iteration', this.state);\n        if (!this.state.autoPlaying) {\n            return;\n        }\n        this.timeoutId = setTimeout(this.autoPlay, this.SLIDER_AUTOPLAY_UPDATE_MS);\n    };\n\n    autoPlay = () => {\n        if (this.state.sliderTime < this.maxTime()) {\n            const delta =\n                (1.0 / this.SLIDER_AUTOPLAY_BASE_MS) *\n                (performance.now() - (this.lastTimeChange ? this.lastTimeChange : performance.now()));\n            console.log('autoPlay', this.state.time, delta);\n            let newSliderTime = Math.min(this.maxTime(), this.state.sliderTime + delta);\n            if (newSliderTime < this.maxTime()) {\n                if (this.timeoutId) {\n                    clearTimeout(this.timeoutId);\n                }\n                this.lastTimeChange = performance.now();\n                this.handleTimeChange(newSliderTime, true, this.singleAutoPlayIteration);\n            } else {\n                this.resetTimer();\n                this.handleTimeChange(newSliderTime, false);\n            }\n        }\n    };\n\n    repeatPlay = () => {\n        this.handleTimeChange(0, true);\n        this.timeoutId = setTimeout(this.autoPlay, this.SLIDER_AUTOPLAY_UPDATE_MS);\n    };\n\n    forceAutoPlay = () => {\n        console.log('autoplay');\n        if (this.state.time < this.maxTime()) {\n            this.autoPlay();\n        } else {\n            this.repeatPlay();\n        }\n    };\n\n    toggleAutoPlay = () => {\n        console.log('toggleAutoPlay', this.state.autoPlaying);\n        if (!this.state.autoPlaying) {\n            this.forceAutoPlay();\n        } else {\n            this.stop();\n        }\n    };\n\n    resetTimer = () => {\n        clearTimeout(this.timeoutId);\n        this.timeoutId = null;\n        this.lastTimeChange = null;\n    };\n\n    stop = () => {\n        if (this.timeoutId != null) {\n            this.resetTimer();\n        }\n        if (this.state.autoPlaying) {\n            this.setState({autoPlaying: false});\n        }\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        if (state.autoPlaying && props.time === state.breakpoints.length - 1) {\n            return {...state, autoPlaying: false};\n        } else {\n            return null;\n        }\n    }\n\n    componentDidUpdate() {\n        setTimeout(() => this.removeHackTransition(), 200);\n        if (!this.state.autoPlaying && this.timeoutId) {\n            this.stop();\n        }\n    }\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleKeyboard);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeyboard);\n    }\n\n    hackTransition = () => {\n        const track = document.getElementsByClassName('rc-slider-track')[0];\n        const handle = document.getElementsByClassName('rc-slider-handle')[0];\n        if (track && handle) {\n            track.classList.add('slider-transition');\n            handle.classList.add('slider-transition');\n        }\n        this._transitionHackStarted = performance.now();\n    };\n\n    removeHackTransition = _.debounce(() => {\n        const track = document.getElementsByClassName('rc-slider-track')[0];\n        const handle = document.getElementsByClassName('rc-slider-handle')[0];\n        if (track && handle && performance.now() - this._transitionHackStarted > 150) {\n            track.classList.remove('slider-transition');\n            handle.classList.remove('slider-transition');\n        }\n    }, 250);\n\n    handleKeyboard = (event) => {\n        console.log('keyboard', event);\n        if (event.target.nodeName === 'INPUT') {\n            return; // Don't mess with inputs\n        }\n\n        const keyCode = event.keyCode;\n        const isNext = keyCode === 40 || keyCode === 39;\n        const isPrev = keyCode === 38 || keyCode === 37;\n        const isSpace = keyCode === 32;\n\n        if (isNext || isPrev || isSpace) {\n            event.preventDefault();\n            this.hackTransition();\n            if (isNext) {\n                this.nextStep();\n            } else if (isPrev) {\n                this.prevStep();\n            } else if (isSpace) {\n                this.toggleAutoPlay();\n            }\n        }\n    };\n\n    toggleTheory = () => {\n        if (!this.state.showingTheory) {\n            this.stop();\n        }\n\n        this.setState({showingTheory: !this.state.showingTheory});\n    };\n\n    isMobile = () => {\n        return this.props.windowWidth <= 480;\n    };\n\n    render() {\n        console.log('Player', this.props, this.state);\n        if (this.state.navigatingHome) {\n            return <Redirect push to=\"/\" />;\n        }\n        const breakpoints = this.state.breakpoints;\n        const maxTime = breakpoints.length;\n\n        const StateVisualization = this.props.stateVisualization;\n        const {windowHeight, windowWidth} = this.props;\n        console.log('Player window size', windowHeight, windowWidth);\n        const totalWidth = Math.min(this.MAX_WIDTH, windowWidth);\n\n        const time = this.state.time;\n\n        const bp = breakpoints[time];\n\n        let codeHeight, innerTheoryHeight, theoryWidth, codeVisWidth, desktopTheoryTop;\n        const controlsHeight = isMobile ? 45 : 35;\n        const approximateSliderAndControlsHeight = controlsHeight + 16;\n        const adjustTheoryTop = 5;\n        const approximateHorizontalPaddings = 24;\n        const MIN_THEORY_WIDTH = 300;\n        let inputsHeight;\n\n        let isMobile = false;\n        if (windowHeight) {\n            const expectedVisHeight = 1.1 * StateVisualization.getExpectedHeight(totalWidth, windowHeight);\n\n            console.log('Expected vis height', expectedVisHeight);\n            codeVisWidth = totalWidth - approximateHorizontalPaddings;\n\n            if (this.isMobile()) {\n                isMobile = true;\n                theoryWidth = windowWidth - 1;\n            } else {\n                theoryWidth = Math.max(0.3 * totalWidth, MIN_THEORY_WIDTH);\n            }\n            innerTheoryHeight = windowHeight - approximateSliderAndControlsHeight - 15 /* IDK why 15 */;\n            desktopTheoryTop = approximateSliderAndControlsHeight - 4;\n\n            inputsHeight = this.props.inputs && !isMobile ? 7 + this.props.inputs.length * 38 : 0;\n            codeHeight =\n                this.props.windowHeight - expectedVisHeight - approximateSliderAndControlsHeight - inputsHeight;\n        }\n\n        // const theoryPosition = approximateSliderAndControlsHeight - adjustTheoryTop;\n\n        let playerHeaderStyle, mobileVisWrapperStyle, mobileHeaderTitle, mobileSliderStyle;\n        if (isMobile) {\n            playerHeaderStyle = {position: 'absolute', bottom: 0};\n            mobileVisWrapperStyle = {position: 'absolute', bottom: 80, width: '100%'};\n            mobileHeaderTitle = this.props.mobileHeaderTitle || this.props.playerHeaderTitle;\n            mobileHeaderTitle = mobileHeaderTitle.charAt(0).toUpperCase() + mobileHeaderTitle.slice(1);\n            mobileSliderStyle = {paddingBottom: 15, paddingTop: 20};\n        }\n\n        console.log('mobile header title', mobileHeaderTitle);\n\n        const biggerFont = !isDefinedSmallBoxScreen(windowWidth, windowHeight) || isMobile;\n        // const inputs = this.props.inputs;\n        const inputs = this.props.inputs;\n\n        return (\n            <div className=\"fluid-body\">\n                <div className=\"player\">\n                    <div\n                        className={classnames('player-header', !isMobile && 'player-header-desktop')}\n                        style={playerHeaderStyle}\n                    >\n                        <div style={{display: 'flex', alignItems: 'center'}}>\n                            {(!this.state.showingTheory || !isMobile) && (\n                                <a\n                                    className=\"player-title\"\n                                    href=\"/\"\n                                    onClick={this.navigateHome}\n                                    children={<ArrowLeft />}\n                                />\n                            )}\n                            {!isMobile && (\n                                <div className=\"player-lesson-name\">\n                                    {'\\u00A0'}\n                                    {this.props.playerHeaderTitle}\n                                </div>\n                            )}\n                        </div>\n                        {(!this.state.showingTheory || !isMobile) && (\n                            <div className={classnames('player-buttons', isMobile ? 'player-buttons-mobile' : '')}>\n                                <div className=\"player-button player-prev\" onClick={this.prevStep}>\n                                    <img src={leftArrow} />\n                                </div>\n                                <div className=\"player-counters\">\n                                    <span children={`Шаг ${time + 1} из ${maxTime}`} />\n                                </div>\n                                <div className=\"player-button player-next\" onClick={this.nextStep}>\n                                    <img src={rightArrow} />\n                                </div>\n                                <div className=\"player-button player-play-button\" onClick={this.toggleAutoPlay}>\n                                    <img src={this.state.autoPlaying ? pauseButton : playArrow} />\n                                </div>\n                            </div>\n                        )}\n                        {/*{this.props.theory && (*/}\n                        {/*    <div*/}\n                        {/*        className={classnames(*/}\n                        {/*            'player-theory-button',*/}\n                        {/*            this.state.showingTheory && 'player-button-active'*/}\n                        {/*        )}*/}\n                        {/*        onClick={this.toggleTheory}*/}\n                        {/*    >*/}\n                        {/*        Теория*/}\n                        {/*    </div>*/}\n                        {/*)}*/}\n                    </div>\n\n                    <div className=\"player-slider-wrapper\">\n                        <Slider\n                            // marks={marks}\n                            onChange={this.handleSliderValueChange}\n                            min={0}\n                            max={this.maxTime() * this.SLIDER_MULTIPLIER}\n                            value={this.state.sliderTime * this.SLIDER_MULTIPLIER}\n                            style={mobileSliderStyle}\n                            dotStyle={{\n                                top: 0,\n                                height: 3,\n                                width: 3,\n                                borderRadius: 0,\n                                backgroundColor: 'white',\n                                border: 'none',\n                            }}\n                            handleStyle={{\n                                height: 12,\n                                width: 12,\n                                marginTop: -4.5,\n                                backgroundColor: '#FF3B99',\n                                border: 'none',\n                            }}\n                            railStyle={{\n                                height: 2,\n                                cursor: 'pointer',\n                                backgroundColor: '#ffffff',\n                            }}\n                            trackStyle={{\n                                height: 2,\n                                cursor: 'pointer',\n                                backgroundColor: '#FF3B99',\n                            }}\n                            className={classnames(isMobile && 'slider-mobile-extra')}\n                        />\n                    </div>\n                    {!isMobile && inputs && inputs.length && (\n                        <div className=\"player-inputs-outer\">\n                            <div className=\"player-inputs-inner\">\n                                {inputs.map((input, idx) => {\n                                    return (\n                                        <PlayerInput\n                                            value={this.state.programInputs[idx]}\n                                            valueRaw={this.state.originalRawInputs[idx]}\n                                            key={input.id}\n                                            label={input.label}\n                                            type={input.type}\n                                            onChange={this.onInputChangeHandlers[idx]}\n                                            dumpValue={(val) => dumpValue(val, input.type)}\n                                            parseValue={(val) => parseValue(val, input.type)}\n                                        />\n                                    );\n                                })}\n                            </div>\n                        </div>\n                    )}\n                    <div className=\"player-main\">\n                        <div className=\"player-code-and-visualisation\" style={{width: codeVisWidth}}>\n                            <CodeBlockWithActiveLineAndAnnotations\n                                height={codeHeight}\n                                time={time}\n                                code={this.props.code}\n                                overflow={false}\n                                fontSize={15}\n                                lineVerticalPadding={2}\n                                breakpoints={breakpoints}\n                                formatBpDesc={this.props.formatBpDesc}\n                                withShortExplanation={isMobile}\n                                mobileHeaderTitle={mobileHeaderTitle}\n                            />\n                            <div className=\"player-state-vis-wrapper\" style={mobileVisWrapperStyle}>\n                                <StateVisualization\n                                    bp={bp}\n                                    epoch={this.state.breakpointsUpdatedCounter}\n                                    innerRef={this.componentRef}\n                                    windowWidth={windowWidth}\n                                    windowHeight={windowHeight}\n                                    overflow={false}\n                                />\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","export default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOSIgaGVpZ2h0PSIxMyIgdmlld0JveD0iMCAwIDkgMTMiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0wLjY4NjQ1OCA1LjkwMjU3TDYuMzgzMjEgMC4yMDYxMTFDNi42NTc4NyAtMC4wNjg1NDA5IDcuMTAzNCAtMC4wNjg1NDA5IDcuMzc4MDYgMC4yMDYxMTFMOC4wNDI1NiAwLjg3MDYxQzguMzE2OTIgMS4xNDQ5NyA4LjMxNzIxIDEuNTg5MzQgOC4wNDM3MyAxLjg2NDI4TDMuNTI4ODMgNi4zOTk5OUw4LjA0MzQ0IDEwLjkzNkM4LjMxNzIxIDExLjIxMDkgOC4zMTY2MiAxMS42NTUzIDguMDQyMjYgMTEuOTI5N0w3LjM3Nzc2IDEyLjU5NDJDNy4xMDMxMSAxMi44Njg4IDYuNjU3NTcgMTIuODY4OCA2LjM4MjkyIDEyLjU5NDJMMC42ODY0NTggNi44OTc0MkMwLjQxMTgwNiA2LjYyMjc2IDAuNDExODA2IDYuMTc3MjIgMC42ODY0NTggNS45MDI1N1oiIGZpbGw9IiMyNDI0MjQiLz4KPC9zdmc+Cg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOSIgaGVpZ2h0PSIxMyIgdmlld0JveD0iMCAwIDkgMTMiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik04LjMxMzU0IDUuOTAyNTdMMi42MTY3OSAwLjIwNjExMUMyLjM0MjEzIC0wLjA2ODU0MDkgMS44OTY2IC0wLjA2ODU0MDkgMS42MjE5NCAwLjIwNjExMUwwLjk1NzQ0MyAwLjg3MDYxQzAuNjgzMDg0IDEuMTQ0OTcgMC42ODI3OTIgMS41ODkzNCAwLjk1NjI3MSAxLjg2NDI4TDUuNDcxMTcgNi4zOTk5OUwwLjk1NjU2MyAxMC45MzZDMC42ODI3OTEgMTEuMjEwOSAwLjY4MzM3OCAxMS42NTUzIDAuOTU3NzM2IDExLjkyOTdMMS42MjIyNCAxMi41OTQyQzEuODk2ODkgMTIuODY4OCAyLjM0MjQzIDEyLjg2ODggMi42MTcwOCAxMi41OTQyTDguMzEzNTQgNi44OTc0MkM4LjU4ODE5IDYuNjIyNzYgOC41ODgxOSA2LjE3NzIyIDguMzEzNTQgNS45MDI1N1oiIGZpbGw9IiMyNDI0MjQiLz4KPC9zdmc+Cg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxMiAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0wIDE0SDRWMEgwVjE0Wk04IDBWMTRIMTJWMEg4WiIgZmlsbD0iIzMyMzIzMiIvPg0KPC9zdmc+DQo=\"","export default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxMiAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTExLjM2ODIgNS44Njk1OUwxLjkzOTM0IDAuMTc5NTg1QzEuMTczMjUgLTAuMjgyNTA2IDAgMC4xNjU5MTQgMCAxLjMwODg0VjEyLjY4NjFDMCAxMy43MTE1IDEuMDkwMjEgMTQuMzI5NCAxLjkzOTM0IDEzLjgxNTRMMTEuMzY4MiA4LjEyODA5QzEyLjIwOTMgNy42MjIyNSAxMi4yMTE5IDYuMzc1NDMgMTEuMzY4MiA1Ljg2OTU5WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==\"","import * as React from 'react';\r\nimport {Map as ImmutableMap, List as ImmutableList, Set as ImmutableSet} from 'immutable';\r\nimport {\r\n    BreakpointFunction,\r\n    pyHash,\r\n    computeIdx,\r\n    computePerturb,\r\n    perturbShift,\r\n    nextIdxPerturb,\r\n    displayStr,\r\n} from './hash_impl_common';\r\n\r\nimport {isDefinedSmallBoxScreen} from './util';\r\n\r\nconst d3 = Object.assign(\r\n    {},\r\n    require('d3-selection'),\r\n    require('d3-interpolate'),\r\n    require('d3-shape'),\r\n    require('d3-transition'),\r\n    require('d3-array')\r\n);\r\n\r\nconst DEFAULT_PROBING_BOX_GEOMETRY = {\r\n    boxSize: 40,\r\n    boxSpacing: 8,\r\n};\r\n\r\nconst SMALLER_PROBING_BOX_GEOMETRY = {\r\n    boxSize: 30,\r\n    boxSpacing: 6,\r\n};\r\n\r\nconst TINY_PROBING_BOX_GEOMETRY = {\r\n    boxSize: 30,\r\n    boxSpacing: 1,\r\n};\r\n\r\nclass ProbingVisualizationImpl extends React.Component {\r\n    TRANSITION_TIME = 500;\r\n    TOP_SPACE = 66;\r\n    BOTTOM_SPACE = 66;\r\n\r\n    transitionId = null;\r\n    lastTransitionId = 0;\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            firstRender: true,\r\n            bpIdx: props.bpIdx,\r\n            breakpoints: props.breakpoints,\r\n            transitionRunning: false,\r\n            transitionToBpIdx: null,\r\n            boxSize: null,\r\n            boxSpacing: null,\r\n        };\r\n    }\r\n\r\n    setRef = node => {\r\n        this.gChild = node;\r\n    };\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        let waitForTransition = false;\r\n        let shouldUpdate = false;\r\n        if (this.state.boxSize !== nextState.boxSize || this.state.boxSize == null || nextState.boxSize == null)\r\n            return true;\r\n\r\n        /*if (nextProps.boxSize !== this.props.boxSize) {\r\n            shouldUpdate = true;\r\n            waitForTransition = true;\r\n        } else */\r\n        if (nextProps.breakpoints !== nextState.breakpoints) {\r\n            waitForTransition = true;\r\n            shouldUpdate = true;\r\n        } else if (\r\n            nextProps.bpIdx !== nextState.bpIdx &&\r\n            (nextState.transitionToBpIdx == null || nextProps.bpIdx !== nextState.transitionToBpIdx)\r\n        ) {\r\n            shouldUpdate = true;\r\n            waitForTransition =\r\n                nextState.transitionToBpIdx != null &&\r\n                ((nextState.bpIdx > nextState.transitionToBpIdx && nextProps.bpIdx > nextState.transitionToBpIdx) ||\r\n                    (nextState.bpIdx < nextState.transitionToBpIdx && nextProps.bpIdx < nextState.transitionToBpIdx));\r\n        }\r\n\r\n        return shouldUpdate && (!nextState.transitionRunning || !waitForTransition);\r\n    }\r\n\r\n    render() {\r\n        const computedHeight =\r\n            this.state.boxSize +\r\n            this.TOP_SPACE +\r\n            this.BOTTOM_SPACE +\r\n            10 +\r\n            30 +\r\n            25; /* TODO FIXME: this is all a bunch of hacks because repeatedAdj can make patterns overlap TOP_SPACE / BOTTOM_SPACE */\r\n\r\n        let {fixedHeight, adjustTop} = this.props;\r\n        const height = fixedHeight ? fixedHeight : computedHeight;\r\n        adjustTop = adjustTop || 0;\r\n\r\n        return (\r\n            <div ref={this.props.innerRef}>\r\n                <svg width={10 + this.props.slotsCount * (this.state.boxSize + this.state.boxSpacing)} height={height}>\r\n                    <defs>\r\n                        {['blue', 'green'].map(color => (\r\n                            <marker\r\n                                id={`arrow-${color}`}\r\n                                key={`arrow-${color}`}\r\n                                markerUnits=\"strokeWidth\"\r\n                                markerWidth=\"7\"\r\n                                markerHeight=\"7\"\r\n                                viewBox=\"0 0 12 12\"\r\n                                refX=\"6\"\r\n                                refY=\"6\"\r\n                                orient=\"auto\"\r\n                            >\r\n                                <path d=\"M2,2 L10,6 L2,10 L6,6 L2,2\" style={{fill: color}} />\r\n                            </marker>\r\n                        ))}\r\n                    </defs>\r\n                    <g ref={this.setRef} transform={`translate(0, ${adjustTop + 30})`} />\r\n                </svg>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    transitionEnd() {\r\n        const newBpIdx = this.transitionToBpIdx;\r\n        this.transitionId = null;\r\n        if (this.state.transitionRunning) {\r\n            this.setState({\r\n                transitionRunning: false,\r\n                bpIdx: this.state.transitionToBpIdx,\r\n                transitionToBpIdx: null,\r\n            });\r\n        }\r\n    }\r\n\r\n    // TODO: hacky handling of boxSize changing (also if only boxSpacing changes, this may not work properly (noticeable on the initial render)\r\n    d3render() {\r\n        const slotsCount = this.props.slotsCount;\r\n\r\n        const bp = this.props.breakpoints[this.props.bpIdx];\r\n        let links = bp.links.toJS();\r\n        let startBoxIdx = bp.startIdx != null ? bp.startIdx : null;\r\n\r\n        let linksStartIdx = [];\r\n        let nextIdxRepeatedAdjustment = [];\r\n        for (let i = 0; i < links.length; ++i) {\r\n            let counter = {};\r\n            nextIdxRepeatedAdjustment.push([]);\r\n            for (let j = 0; j < links[i].length; ++j) {\r\n                const nextIdx = links[i][j].nextIdx;\r\n                if (!(nextIdx in counter)) {\r\n                    counter[nextIdx] = 0;\r\n                } else {\r\n                    counter[nextIdx]++;\r\n                }\r\n                linksStartIdx.push([i, j]);\r\n                nextIdxRepeatedAdjustment[i].push(counter[nextIdx]);\r\n            }\r\n        }\r\n\r\n        const oldLinks = this.oldLinks;\r\n        const oldBoxSize = this.oldBoxSize;\r\n        const oldNextIdxRepeatedAdjustment = this.oldNextIdxRepeatedAdjustment;\r\n\r\n        let transitionTime;\r\n        let newState = {\r\n            transitionToBpIdx: this.props.bpIdx,\r\n            breakpoints: this.props.breakpoints,\r\n        };\r\n        if (this.state.firstRender) {\r\n            newState.firstRender = false;\r\n            transitionTime = 0;\r\n        } else {\r\n            transitionTime = this.TRANSITION_TIME;\r\n            newState.transitionRunning = true;\r\n        }\r\n\r\n        let t = d3.transition().duration(transitionTime);\r\n\r\n        this.lastTransitionId++;\r\n        let transitionId = this.lastTransitionId;\r\n        this.transitionId = transitionId;\r\n\r\n        t.on('end', () => {\r\n            if (this.transitionId === transitionId) {\r\n                // XXX: this is a hack for d3, because .end() callbacks seem to be executed in the weird order\r\n                // XXX: it is necessary, because .end() removes some necessary classes as well\r\n                setTimeout(() => this.transitionEnd(), 0);\r\n            }\r\n        });\r\n\r\n        let g = d3.select(this.gChild);\r\n        let lineFunction = d3\r\n            .line()\r\n            .x(function(d) {\r\n                return d.x;\r\n            })\r\n            .y(function(d) {\r\n                return d.y;\r\n            })\r\n            .curve(d3.curveMonotoneX);\r\n\r\n        const {boxSize, boxSpacing} = this.state;\r\n        // FIXME: this is more of hack to force re-rendering of links\r\n        const boxSizeChanged = boxSize !== oldBoxSize;\r\n        let rects = g.selectAll('rect').data(d3.range(slotsCount));\r\n        rects\r\n            /*.attr('x', (d, i) => (boxSize + boxSpacing) * i)\r\n            .attr('y', this.TOP_SPACE)\r\n            .attr('width', boxSize)\r\n            .attr('height', boxSize)*/\r\n            .enter()\r\n            .append('rect')\r\n            .style('fill', '#e5e6f1')\r\n            .attr('x', (d, i) => (boxSize + boxSpacing) * i)\r\n            .attr('y', this.TOP_SPACE)\r\n            .attr('rx', 4)\r\n            .attr('ry', 4)\r\n            .attr('width', boxSize)\r\n            .attr('height', boxSize)\r\n            .merge(rects)\r\n            .style('stroke', (d, i) => (i === startBoxIdx ? 'green' : 'none'))\r\n            .style('stroke-width', 1);\r\n\r\n        const arrowLinePointsAsArray = (i1, i2, repeatedAdj) => {\r\n            let ystart, yend, ymid;\r\n\r\n            let xstartAdjust, xendAdjust;\r\n            if (i1 < i2) {\r\n                ystart = this.TOP_SPACE;\r\n                yend = this.TOP_SPACE;\r\n                ymid = this.TOP_SPACE * (1 - (Math.max(i2 - i1, 1) + repeatedAdj) / slotsCount);\r\n                xstartAdjust = boxSize * 0.66;\r\n                xendAdjust = boxSize * 0.33;\r\n            } else if (i1 == i2) {\r\n                ystart = this.TOP_SPACE;\r\n                yend = this.TOP_SPACE;\r\n                ymid = this.TOP_SPACE * (1 - (1 + repeatedAdj) / slotsCount);\r\n                xstartAdjust = boxSize * 0.33;\r\n                xendAdjust = boxSize * 0.66;\r\n            } else {\r\n                const yOffset = this.TOP_SPACE + boxSize;\r\n                ystart = yOffset;\r\n                yend = yOffset;\r\n                ymid = yOffset + this.BOTTOM_SPACE * (/*Math.max(i1 - i2, 1)*/ (2 + repeatedAdj) / slotsCount);\r\n                xstartAdjust = boxSize * 0.33;\r\n                xendAdjust = boxSize * 0.66;\r\n            }\r\n            const xstart = (boxSize + boxSpacing) * i1 + xstartAdjust;\r\n            const xend = (boxSize + boxSpacing) * i2 + xendAdjust;\r\n            const xmid = (xstart + xend) / 2;\r\n\r\n            return [[xstart, ystart], [xmid, ymid], [xend, yend]];\r\n        };\r\n\r\n        const toPoints = array => array.map(([x, y]) => ({x, y}));\r\n        const arrowLinePoints = (i1, i2, repeatedAdj) => toPoints(arrowLinePointsAsArray(i1, i2, repeatedAdj));\r\n        const getLinkColor = ([start, idx]) => {\r\n            const perturbLink = links[start][idx].perturbLink;\r\n            return perturbLink ? 'green' : 'blue';\r\n        };\r\n        const getLinkArrow = ([start, idx]) => {\r\n            return `url(#arrow-${getLinkColor([start, idx])})`;\r\n        };\r\n\r\n        let updatePaths = g.selectAll('path').data(linksStartIdx, d => d);\r\n        const enterPaths = updatePaths.enter();\r\n        const exitPaths = updatePaths.exit();\r\n\r\n        enterPaths\r\n            .append('path')\r\n            .style('stroke', getLinkColor)\r\n            .style('stroke-width', 1)\r\n            .style('fill', 'none')\r\n            .attr('d', ([start, idx]) => {\r\n                let end = links[start][idx].nextIdx;\r\n                const repeatedAdj = nextIdxRepeatedAdjustment[start][idx];\r\n                const lp = arrowLinePoints(start, end, repeatedAdj);\r\n                return lineFunction(lp);\r\n            })\r\n            .each(function(d, i) {\r\n                const node = this;\r\n                const totalLength = node.getTotalLength();\r\n                const selected = d3.select(node);\r\n                selected\r\n                    .classed('entering', true)\r\n                    .attr('stroke-dasharray', totalLength + ' ' + totalLength)\r\n                    .attr('stroke-dashoffset', totalLength)\r\n                    .transition(t)\r\n                    .attr('stroke-dashoffset', 0)\r\n                    .on('end', () => {\r\n                        selected.attr('marker-end', getLinkArrow(d));\r\n                        selected.classed('entering', false);\r\n                    });\r\n            });\r\n\r\n        updatePaths\r\n            .filter(function(d, i) {\r\n                const [start, idx] = d;\r\n                return (\r\n                    !d3.select(this).classed('entering') ||\r\n                    boxSizeChanged ||\r\n                    oldLinks[start][idx].nextIdx != links[start][idx].nextIdx\r\n                );\r\n            })\r\n            .style('stroke', getLinkColor)\r\n            .attr('stroke-dasharray', null)\r\n            .attr('stroke-dashoffset', null)\r\n            .transition(t)\r\n            .attrTween('d', ([start, idx]) => {\r\n                let end = links[start][idx].nextIdx;\r\n                let oldEnd = oldLinks[start][idx].nextIdx;\r\n                const oldRepeatedAdj = oldNextIdxRepeatedAdjustment[start][idx];\r\n                const repeatedAdj = nextIdxRepeatedAdjustment[start][idx];\r\n                const oldLp = arrowLinePoints(start, oldEnd, oldRepeatedAdj);\r\n                const lp = arrowLinePoints(start, end, repeatedAdj);\r\n                const ip = d3.interpolateArray(oldLp, lp);\r\n                return t => lineFunction(ip(t));\r\n            })\r\n            .attr('marker-end', getLinkArrow);\r\n\r\n        exitPaths\r\n            .filter(function(d, i) {\r\n                return !d3.select(this).classed('exiting');\r\n            })\r\n            .classed('exiting', true)\r\n            .each(function() {\r\n                const node = this;\r\n                const totalLength = node.getTotalLength();\r\n                const selected = d3.select(node);\r\n                selected\r\n                    .attr('stroke-dasharray', totalLength + ' ' + totalLength)\r\n                    .attr('stroke-dashoffset', 0)\r\n                    .attr('marker-end', null)\r\n                    .transition(t)\r\n                    .attr('stroke-dashoffset', totalLength)\r\n                    .remove();\r\n            });\r\n\r\n        this.oldLinks = links;\r\n        this.oldBoxSize = boxSize;\r\n        this.oldNextIdxRepeatedAdjustment = nextIdxRepeatedAdjustment;\r\n        this.setState(newState);\r\n    }\r\n\r\n    _initOrUpd() {\r\n        if (this.state.boxSize == null && this.props.boxSize != null) {\r\n            this.setState({\r\n                boxSize: this.props.boxSize,\r\n                boxSpacing: this.props.boxSpacing,\r\n            });\r\n        } else if (this.state.boxSize != null) {\r\n            this.d3render();\r\n        }\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this._initOrUpd();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this._initOrUpd();\r\n    }\r\n}\r\n\r\nfunction selectProbingGeometry(windowWidth, windowHeight) {\r\n    return TINY_PROBING_BOX_GEOMETRY;\r\n    /*if (windowWidth == null) return null;\r\n    const smallBoxScreen = windowWidth == null || windowHeight == null || Math.min(windowWidth, windowHeight) < 550;\r\n    console.log('selectProbingGeometry()', windowWidth, windowHeight, smallBoxScreen);\r\n\r\n    return smallBoxScreen ? SMALLER_PROBING_BOX_GEOMETRY : DEFAULT_PROBING_BOX_GEOMETRY;*/\r\n}\r\n\r\nexport class ProbingStateVisualization extends React.Component {\r\n    static getExpectedHeight() {\r\n        return 270; // TODO: compute?\r\n    }\r\n\r\n    render() {\r\n        const {breakpoints, bpIdx, innerRef, windowWidth, windowHeight} = this.props;\r\n        return (\r\n            <ProbingVisualizationImpl\r\n                slotsCount={this.props.slotsCount || 8}\r\n                breakpoints={breakpoints}\r\n                bpIdx={bpIdx}\r\n                innerRef={innerRef}\r\n                {...selectProbingGeometry(windowWidth, windowHeight)}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nexport class ProbingVisualization extends React.Component {\r\n    static FULL_WIDTH = true;\r\n    static EXTRA_ERROR_BOUNDARY = true;\r\n\r\n    render() {\r\n        // Pretty hacky passing links like this\r\n        return (\r\n            <ProbingVisualizationImpl\r\n                slotsCount={this.props.slotsCount || 8}\r\n                breakpoints={[{links: this.props.links}]}\r\n                bpIdx={0}\r\n                {...this.props}\r\n                {...selectProbingGeometry(this.props.windowWidth, this.props.windowHeight)}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nexport class GenerateProbingLinks extends BreakpointFunction {\r\n    run(_slotsCount, _key, algo) {\r\n        if (algo === 'python') {\r\n            this.PERTURB_SHIFT = 5;\r\n        }\r\n        this.slotsCount = _slotsCount;\r\n        this.key = _key;\r\n        this.links = new ImmutableList();\r\n        for (let i = 0; i < this.slotsCount; ++i) {\r\n            this.links = this.links.set(i, new ImmutableList());\r\n        }\r\n        this.addBP('def-probe-all');\r\n\r\n        this.hashCode = pyHash(this.key);\r\n        this.addBP('compute-hash');\r\n\r\n        if (algo === 'python') {\r\n            this.perturb = computePerturb(this.hashCode);\r\n            this.addBP('compute-perturb');\r\n        }\r\n\r\n        this.idx = computeIdx(this.hashCode, this.slotsCount);\r\n        this.startIdx = this.idx;\r\n        this.addBP('compute-idx');\r\n        this.visitedIdx = new ImmutableMap();\r\n        this.addBP('create-empty-set');\r\n        let prevPerturbLink = !!this.perturb && !this.perturb.eq(0);\r\n        while (true) {\r\n            this.addBP('while-loop');\r\n            if (this.visitedIdx.size === this.slotsCount) {\r\n                break;\r\n            }\r\n            if (!this.visitedIdx.has(this.idx)) {\r\n                this.visitedIdx = this.visitedIdx.set(this.idx, {perturbLink: prevPerturbLink});\r\n            }\r\n            this.addBP('visited-add');\r\n            let nIdx;\r\n            if (algo === 'python') {\r\n                nIdx = nextIdxPerturb(this.idx, this.perturb, this.slotsCount);\r\n            } else if (algo === '5i+1') {\r\n                nIdx = (5 * this.idx + 1) % this.slotsCount;\r\n            } else if (algo === 'i+1') {\r\n                nIdx = (this.idx + 1) % this.slotsCount;\r\n            } else {\r\n                throw new Error(`Unknown probing algorithm: ${algo}`);\r\n            }\r\n\r\n            const perturbLink = this.perturb != null && !this.perturb.eq(0);\r\n            prevPerturbLink = perturbLink;\r\n            this.links = this.links.set(this.idx, this.links.get(this.idx).push({nextIdx: nIdx, perturbLink}));\r\n            this.idx = nIdx;\r\n            this.addBP('next-idx');\r\n            if (algo === 'python') {\r\n                this.perturb = perturbShift(this.perturb);\r\n                this.addBP('perturb-shift');\r\n            }\r\n        }\r\n\r\n        return {links: this.links, startIdx: this.startIdx};\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport _ from 'lodash';\r\nimport {List as ImmutableList} from 'immutable';\r\n\r\nimport {EQ, BreakpointFunction, displayStr} from './hash_impl_common';\r\nimport {\r\n    LineOfBoxesComponent,\r\n    HashBoxesComponent,\r\n    HashBoxesBrokenComponent,\r\n    TetrisFactory,\r\n    VisualizedCode,\r\n    SimpleCodeInline,\r\n} from './code_blocks';\r\nimport {PyListInput, ParsableInput, BlockInputToolbar, InputTryAnother} from './inputs';\r\nimport {\r\n    ChapterComponent,\r\n    DynamicP,\r\n    Subcontainerize,\r\n    singularOrPluralRus,\r\n    CrossFade,\r\n    COLOR_FOR_READ_OPS,\r\n    randint,\r\n    randomChoice,\r\n} from './util';\r\nimport {chapter1_2_FormatCheckCollision, commonFormatCheckNotFound} from './common_formatters';\r\nimport {ProbingVisualization, GenerateProbingLinks} from './probing_visualization';\r\nimport {parsePyNumber} from './py_obj_parsing';\r\n\r\nimport {BigNumber} from 'bignumber.js';\r\n\r\nimport memoizeOne from 'memoize-one';\r\nimport {observer} from 'mobx-react';\r\nimport {win} from './store';\r\n\r\nconst CHAPTER1_MAXNUM = 999;\r\n\r\nexport const SIMPLE_LIST_SEARCH = [\r\n    ['def simple_search(simple_list, key):', '', 0],\r\n    ['    idx = 0', 'start-from-zero', 1],\r\n    ['    while idx < len(simple_list):', 'check-boundary', 2],\r\n    ['        if simple_list[idx] == key:', 'check-found', 2],\r\n    ['            return True', 'found-key', 2],\r\n    ['        idx += 1', 'next-idx', 2],\r\n    ['    return False', 'found-nothing', 1],\r\n];\r\n\r\nfunction _parseSmallInt(value) {\r\n    const b = parsePyNumber(value);\r\n    const error = chapter1valueRangeValidator(b);\r\n    if (error) {\r\n        throw new Error(error);\r\n    }\r\n\r\n    return +b.toString();\r\n}\r\n\r\nfunction chapter1valueRangeValidator(num) {\r\n    if (!BigNumber.isBigNumber(num) && typeof num !== 'number') {\r\n        return 'Expected an integer';\r\n    }\r\n    if (num.lt(-CHAPTER1_MAXNUM) || num.gt(CHAPTER1_MAXNUM)) {\r\n        return `In chapter 1 only small integers are supported (between -${CHAPTER1_MAXNUM} and ${CHAPTER1_MAXNUM})`;\r\n    }\r\n}\r\n\r\nexport function PySmallIntInput({inputComponentRef, ...restProps}) {\r\n    return (\r\n        <ParsableInput {...restProps} dumpValue={JSON.stringify} parseValue={_parseSmallInt} ref={inputComponentRef} />\r\n    );\r\n}\r\n\r\nfunction simpleListSearch(l, key) {\r\n    let defaultBPInfo = {\r\n        type: 'breakpoint',\r\n        arg: key,\r\n        data: l,\r\n        size: l.length,\r\n    };\r\n    let breakpoints = [];\r\n    let newBP = (point, idx, extraInfo) => {\r\n        return {...defaultBPInfo, ...{point: point, idx: idx, atIdx: l[idx]}, ...extraInfo};\r\n    };\r\n\r\n    let idx = 0;\r\n    breakpoints.push(newBP('start-from-zero', idx));\r\n\r\n    while (true) {\r\n        breakpoints.push(newBP('check-boundary', idx));\r\n        if (idx >= l.length) {\r\n            break;\r\n        }\r\n        if (EQ(l[idx], key)) {\r\n            breakpoints.push(newBP('check-found', idx, {found: true}));\r\n            breakpoints.push(newBP('found-key', idx));\r\n\r\n            return {bp: breakpoints, result: true};\r\n        } else {\r\n            breakpoints.push(newBP('check-found', idx, {found: false}));\r\n        }\r\n\r\n        idx += 1;\r\n        breakpoints.push(newBP('next-idx', idx));\r\n    }\r\n\r\n    breakpoints.push(newBP('found-nothing', idx));\r\n\r\n    return {bp: breakpoints, result: false};\r\n}\r\n\r\nexport let formatSimpleListSearchBreakpointDescription = function(bp) {\r\n    switch (bp.point) {\r\n        case 'start-execution':\r\n            return `Ищем <code>${bp.number}</code>`;\r\n        case 'iteration':\r\n            return `Проверим ячейку с индексом ${bp.idx} (<code>${bp.atIdx}</code>)`;\r\n        case 'start-from-zero':\r\n            return `Начинаем с нулевого элемента массива`;\r\n        case 'check-boundary':\r\n            return bp.idx < bp.size\r\n                ? `[Попытка №${bp.idx + 1}] <code>${bp.idx} < ${\r\n                      bp.size\r\n                  }</code>, значит, обработаны еще не все элементы, и искомое число может находиться дальше`\r\n                : `<code>${bp.idx} == ${bp.size}</code>, значит все элементы обработаны`;\r\n        case 'check-found':\r\n            return bp.found\r\n                ? `<code>${bp.atIdx} == ${bp.arg}</code> &mdash; искомое число найдено`\r\n                : `<code>${bp.atIdx} != ${bp.arg}</code> &mdash; искомое число еще не найдено`;\r\n        case 'found-key':\r\n            return `Поэтому возвращаем <code>True</code>`;\r\n        case 'found-nothing':\r\n            return `Искомое число <code>${bp.arg}</code> не найдено, поэтому возвращаем значение<code>False</code>`;\r\n        case 'next-idx':\r\n            return `Переходим к следующему индексу: <code>${bp.idx}</code> == <code>${bp.idx - 1} + 1</code>`;\r\n    }\r\n};\r\n\r\nexport const SimpleListSearchStateVisualization = TetrisFactory([\r\n    [LineOfBoxesComponent, [{labels: ['simple_list']}, 'data', 'idx']],\r\n]);\r\n\r\nconst UnnamedListVisualizationImpl = TetrisFactory([[LineOfBoxesComponent, [{labels: [null]}, 'data']]]);\r\n\r\nfunction UnnamedListVisualization(props) {\r\n    const serverSide = props.windowHeight == null;\r\n    return <UnnamedListVisualizationImpl {...props} overflow={serverSide} />;\r\n}\r\n\r\nexport const SIMPLIFIED_INSERT_ALL_BROKEN_CODE = [\r\n    ['def build_no_collision_resolution(original_list):', 'start-execution', 0],\r\n    ['    new_list = [None] * len(original_list)', 'create-new-list', 1],\r\n    ['', ''],\r\n    ['    for number in original_list:', 'for-loop', 2],\r\n    ['        idx = number % len(new_list)', 'compute-idx', 2],\r\n    ['        new_list[idx] = number', 'assign-elem', 2],\r\n    ['    return new_list', 'return-created-list', 1],\r\n];\r\n\r\nexport const SIMPLIFIED_INSERT_ALL_CODE = [\r\n    ['def build_insert_all(original_list):', 'start-execution', 0],\r\n    ['    new_list = [None] * (2 * len(original_list))', 'create-new-list', 1],\r\n    ['', ''],\r\n    ['    for number in original_list:', 'for-loop', 2],\r\n    ['        idx = number % len(new_list)', 'compute-idx', 2],\r\n    ['        while new_list[idx] is not None:', 'check-collision', 3],\r\n    ['            idx = (idx + 1) % len(new_list)', 'next-idx', 3],\r\n    ['        new_list[idx] = number', 'assign-elem', 2],\r\n    ['    return new_list', 'return-created-list', 1],\r\n];\r\n\r\nclass SimplifiedInsertAll extends BreakpointFunction {\r\n    constructor() {\r\n        super();\r\n\r\n        this._overwritten = [];\r\n    }\r\n\r\n    run(_originalList, isBroken = false, overrideSize = null) {\r\n        this.fmtIsBroken = isBroken;\r\n        this.originalList = new ImmutableList(_originalList);\r\n        this.newList = new ImmutableList();\r\n        if (isBroken) {\r\n            this.fmtMissingNumbers = new ImmutableList();\r\n            this.newListWithReplacements = new ImmutableList();\r\n        }\r\n        let startSize;\r\n\r\n        if (!overrideSize) {\r\n            startSize = (isBroken ? 1 : 2) * this.originalList.size;\r\n        } else {\r\n            overrideSize = startSize;\r\n        }\r\n        for (let i = 0; i < startSize; ++i) {\r\n            this.newList = this.newList.push(null);\r\n            if (isBroken) {\r\n                this.newListWithReplacements = this.newListWithReplacements.push(new ImmutableList());\r\n            }\r\n        }\r\n        this.addBP('create-new-list', true);\r\n\r\n        for ([this.originalListIdx, this.number] of this.originalList.entries()) {\r\n            this.fmtCollisionCount = 0;\r\n\r\n            this.addBP('for-loop');\r\n            this.newListIdx = ((this.number % this.newList.size) + this.newList.size) % this.newList.size;\r\n            this.addBP('compute-idx');\r\n            if (!isBroken) {\r\n                while (true) {\r\n                    this.addBP('check-collision');\r\n                    if (this.newList.get(this.newListIdx) === null) {\r\n                        break;\r\n                    }\r\n\r\n                    this.fmtCollisionCount += 1;\r\n                    this.newListIdx = (this.newListIdx + 1) % this.newList.size;\r\n                    this.addBP('next-idx');\r\n                }\r\n            }\r\n            const prevNumber = this.newList.get(this.newListIdx);\r\n            if (prevNumber != null) {\r\n                if (!isBroken) {\r\n                    throw new Error(`!isBroken and overwriting a number - this should not happen`);\r\n                }\r\n                this.fmtMissingNumbers = this.fmtMissingNumbers.push(prevNumber);\r\n                this._overwritten.push([this.originalListIdx, prevNumber, this.number]);\r\n            }\r\n\r\n            this.newList = this.newList.set(this.newListIdx, this.number);\r\n            if (isBroken) {\r\n                this.newListWithReplacements = this.newListWithReplacements.updateIn([this.newListIdx], arr =>\r\n                    arr.insert(0, this.number)\r\n                );\r\n            }\r\n            this.newList = this.newList.set(this.newListIdx, this.number);\r\n            this.addBP('assign-elem', true);\r\n        }\r\n\r\n        this.addBP('return-created-list');\r\n\r\n        return this.newList;\r\n    }\r\n\r\n    overwrittenNumbers() {\r\n        return this._overwritten;\r\n    }\r\n}\r\n\r\nexport let formatSimplifiedInsertAllDescription = function(bp, prevBp) {\r\n    switch (bp.point) {\r\n        case 'create-new-list':\r\n            return `Создаем новый массив из <code>${bp.newList.size}</code> пустых ячеек`;\r\n        case 'for-loop':\r\n            return `[${bp.originalListIdx + 1}/${bp.originalList.size}] Вставляем <code>${bp.number}</code>`;\r\n        case 'compute-idx':\r\n            return `Вычисляем индекс ячейки: <code>${bp.newListIdx}</code> == <code>${bp.number} % ${\r\n                bp.newList.size\r\n            }</code>`;\r\n        case 'check-collision':\r\n            return chapter1_2_FormatCheckCollision(bp.newList, bp.newListIdx, bp.fmtCollisionCount);\r\n        case 'next-idx':\r\n            return `Продолжаем, индекс следующего элемента <code>${bp.newListIdx}</code> == <code>(${\r\n                prevBp.newListIdx\r\n            } + 1) % ${bp.newList.size}</code>`;\r\n        case 'assign-elem': {\r\n            const prevNumber = prevBp.newList.get(bp.newListIdx);\r\n            if (prevNumber != null) {\r\n                return `Коллизия чисел <code>${\r\n                    bp.number\r\n                }</code> и <code>${prevNumber}</code> в ячейке с индексом <code>${\r\n                    bp.newListIdx\r\n                }</code> — значение перезаписано`;\r\n            } else {\r\n                return `Помещаем <code>${bp.number}</code> в ячейку с индексом <code>${bp.newListIdx}</code>`;\r\n            }\r\n        }\r\n        case 'return-created-list':\r\n            if (bp.fmtMissingNumbers && bp.fmtMissingNumbers.size > 0) {\r\n                return `Возвращаем созданный массив. Потеряны числа: ${bp.fmtMissingNumbers\r\n                    .map(number => `<code>${number}</code>`)\r\n                    .join(', ')}`;\r\n            } else {\r\n                return `Возвращаем созданный массив со всеми исходными числами`;\r\n            }\r\n    }\r\n};\r\n\r\nexport const SimplifiedInsertStateVisualization = TetrisFactory([\r\n    [\r\n        LineOfBoxesComponent,\r\n        [\r\n            {labels: ['original_list']},\r\n            'originalList',\r\n            'originalListIdx',\r\n            undefined,\r\n            {selection1color: COLOR_FOR_READ_OPS},\r\n        ],\r\n    ],\r\n    [HashBoxesComponent, [{labels: ['new_list']}, 'newList', 'newListIdx', undefined]],\r\n]);\r\n\r\nexport const SimplifiedInsertBrokenStateVisualization = TetrisFactory([\r\n    [\r\n        LineOfBoxesComponent,\r\n        [\r\n            {labels: ['original_list']},\r\n            'originalList',\r\n            'originalListIdx',\r\n            undefined,\r\n            {selection1color: COLOR_FOR_READ_OPS},\r\n        ],\r\n    ],\r\n    [HashBoxesBrokenComponent, [{labels: ['new_list']}, 'newListWithReplacements', 'newListIdx', undefined]],\r\n]);\r\n\r\nexport const SIMPLIFIED_SEARCH_CODE = [\r\n    ['def has_number(new_list, number):', 'start-execution', 0],\r\n    ['    idx = number % len(new_list)', 'compute-idx', 1],\r\n    ['    while new_list[idx] is not None:', 'check-not-found', 2],\r\n    ['        if new_list[idx] == number:', 'check-found', 2],\r\n    ['            return True', 'found-key', 2],\r\n    ['        idx = (idx + 1) % len(new_list)', 'next-idx', 2],\r\n    ['    return False', 'found-nothing', 1],\r\n];\r\n\r\nconst HideSpanWhenJsLoaded = observer(function HideWhenJsLoaded({children, tag}) {\r\n    return <span style={{opacity: win.jsLoaded ? 0 : 1, transition: 'opacity 1s ease'}}>{children}</span>;\r\n});\r\n\r\nclass SimplifiedSearch extends BreakpointFunction {\r\n    run(_newList, _number) {\r\n        this.newList = new ImmutableList(_newList);\r\n        this.number = _number;\r\n        this.addBP('start-execution');\r\n\r\n        this.fmtCollisionCount = 0;\r\n        this.newListIdx = ((this.number % this.newList.size) + this.newList.size) % this.newList.size;\r\n        this.addBP('compute-idx');\r\n\r\n        while (true) {\r\n            this.addBP('check-not-found');\r\n            if (this.newList.get(this.newListIdx) === null) {\r\n                break;\r\n            }\r\n            console.log('Simplified search', this);\r\n            this.addBP('check-found');\r\n            if (EQ(this.newList.get(this.newListIdx), this.number)) {\r\n                this.addBP('found-key');\r\n                return true;\r\n            }\r\n\r\n            this.fmtCollisionCount += 1;\r\n            this.newListIdx = (this.newListIdx + 1) % this.newList.size;\r\n            this.addBP('next-idx');\r\n        }\r\n\r\n        this.addBP('found-nothing');\r\n\r\n        return false;\r\n    }\r\n}\r\n\r\nexport let formatSimplifiedSearchDescription = function(bp) {\r\n    switch (bp.point) {\r\n        case 'start-execution':\r\n            return `Ищем <code>${bp.number}</code>`;\r\n        case 'compute-idx':\r\n            return `Вычисляем индекс ячейки: <code>${bp.newListIdx}</code> == <code>${bp.number} % ${\r\n                bp.newList.size\r\n            }</code>`;\r\n        case 'check-not-found':\r\n            return commonFormatCheckNotFound(bp.newList, bp.newListIdx, bp.fmtCollisionCount);\r\n        case 'check-found':\r\n            let found = EQ(bp.newList.get(bp.newListIdx), bp.number);\r\n            if (found) {\r\n                return `Число найдено: <code>${bp.newList.get(bp.newListIdx)} == ${bp.number}</code>`;\r\n            } else {\r\n                return `Число пока не найдено: <code>${bp.newList.get(bp.newListIdx)} != ${bp.number}</code>`;\r\n            }\r\n        case 'found-key':\r\n            return 'Теперь просто возвращаем <code>True</code>';\r\n        case 'found-nothing':\r\n            return 'Теперь просто возвращаем <code>False</code>';\r\n        case 'next-idx':\r\n            return `Продолжаем, индекс следующего элемента <code>${bp.newListIdx}</code>`;\r\n        case 'return-created-list':\r\n            return `Возвращаем созданный массив`;\r\n    }\r\n};\r\n\r\nexport const SimplifiedSearchStateVisualization = TetrisFactory([\r\n    [HashBoxesComponent, [{labels: ['new_list']}, 'newList', 'newListIdx']],\r\n]);\r\n\r\nfunction DynamicSimplifiedInsertAllBrokenOverwrittenExample({originalNumbers, addedNumber, overwrittenNumbers}) {\r\n    let exampleOverwrite;\r\n    let includedList;\r\n    let [idx, n1, n2] = overwrittenNumbers[0];\r\n    n1 = displayStr(n1);\r\n    n2 = displayStr(n2);\r\n    if (addedNumber === null) {\r\n        includedList = false;\r\n        exampleOverwrite = (\r\n            <React.Fragment>\r\n                For example, <code>{n1}</code> will get the same slot index (<code>{idx}</code>) as <code>{n2}</code>,\r\n                and it will be overwritten.\r\n            </React.Fragment>\r\n        );\r\n    } else {\r\n        includedList = true;\r\n        const anStr = displayStr(addedNumber);\r\n        exampleOverwrite = (\r\n            <React.Fragment>\r\n                For the current list (\r\n                <code dangerouslySetInnerHTML={{__html: '[' + originalNumbers.join(', ') + ']'}} />) it would work. But\r\n                if we append a single number to it, for example <code>{anStr}</code>, then <code>{n1}</code> would get\r\n                overwritten by <code>{n2}</code>, and the simple algorithm breaks.\r\n            </React.Fragment>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <DynamicP>\r\n            <p\r\n                className=\"dynamic-p\"\r\n                key={`oe-p-${addedNumber}-${n1}-${n2}-${idx}-${includedList ? JSON.stringify(originalNumbers) : null}`}\r\n            >\r\n                Would this approach work, however? Not entirely. {exampleOverwrite} Situations like these are called{' '}\r\n                <em>collisions</em>.\r\n            </p>\r\n        </DynamicP>\r\n    );\r\n}\r\n\r\nexport class Ops {\r\n    static createNew(numbers) {\r\n        let sia = new SimplifiedInsertAll();\r\n        const keys = sia.run(numbers);\r\n        const bp = sia.getBreakpoints();\r\n        return {keys, bp};\r\n    }\r\n\r\n    static createNewBroken(numbers) {\r\n        let sia = new SimplifiedInsertAll();\r\n        const keys = sia.run(numbers, true);\r\n        return {bp: sia.getBreakpoints(), overwrittenNumbers: sia.overwrittenNumbers(), keys};\r\n    }\r\n\r\n    static hasKey(keys, number) {\r\n        let ss = new SimplifiedSearch();\r\n        const result = ss.run(keys, number);\r\n        const bp = ss.getBreakpoints();\r\n        return {bp, result, keys};\r\n    }\r\n\r\n    static linearSearch(numbers, searchedNumber) {\r\n        return simpleListSearch(numbers, searchedNumber);\r\n    }\r\n}\r\n\r\nfunction anotherValue(array, RANDOM_NUMBER_CHANCE = 0.3) {\r\n    if (Math.random() > RANDOM_NUMBER_CHANCE) {\r\n        return +randomChoice(array).toString();\r\n    } else {\r\n        return randint(Math.floor(-CHAPTER1_MAXNUM / 10), Math.floor(CHAPTER1_MAXNUM / 10));\r\n    }\r\n}\r\n\r\nexport class Chapter1_SimplifiedHash extends ChapterComponent {\r\n    constructor() {\r\n        super();\r\n\r\n        this.state = {\r\n            numbers: [\r\n                BigNumber(1),\r\n                BigNumber(56),\r\n                BigNumber(50),\r\n                BigNumber(2),\r\n                BigNumber(44),\r\n                BigNumber(25),\r\n                BigNumber(17),\r\n                BigNumber(4),\r\n            ],\r\n            simpleSearchNumber: 25,\r\n            simplifiedHashSearchNumber: 2,\r\n        };\r\n    }\r\n\r\n    runSimplifiedInsertAll = memoizeOne(numbers => {\r\n        return Ops.createNew(numbers);\r\n    });\r\n\r\n    generateAlternativeDataForInsertAllBroken = memoizeOne(numbers => {\r\n        let {bp, overwrittenNumbers} = this.runSimplifiedInsertAllBroken(numbers);\r\n        if (overwrittenNumbers.length > 0) {\r\n            return {originalNumbers: numbers, numbers, bp, addedNumber: null, overwrittenNumbers};\r\n        } else {\r\n            const minNum = BigNumber.max(...numbers);\r\n\r\n            const addedNumber = minNum.plus(numbers.length + 1);\r\n            const newNumbers = [...numbers, addedNumber];\r\n            ({bp, overwrittenNumbers} = this.runSimplifiedInsertAllBroken(newNumbers));\r\n            return {originalNumbers: numbers, numbers: newNumbers, bp, addedNumber, overwrittenNumbers};\r\n        }\r\n    });\r\n\r\n    runProbingSimple = memoizeOne(slotsCount => {\r\n        let g = new GenerateProbingLinks();\r\n        const {links} = g.run(slotsCount, '', 'i+1');\r\n\r\n        return {\r\n            links,\r\n            bp: g.getBreakpoints(),\r\n        };\r\n    });\r\n\r\n    runSimplifiedInsertAllBroken = memoizeOne(numbers => {\r\n        return Ops.createNewBroken(numbers);\r\n    });\r\n\r\n    runSimplifiedSearch = memoizeOne((keys, number) => {\r\n        return Ops.hasKey(keys, number);\r\n    });\r\n\r\n    runSimpleListSearch = memoizeOne((numbers, searchedNumber) => {\r\n        const {bp} = Ops.linearSearch(numbers, searchedNumber);\r\n        return {bp};\r\n    });\r\n\r\n    render() {\r\n        const slsRes = this.runSimpleListSearch(this.state.numbers, this.state.simpleSearchNumber);\r\n        const siaBrokenRes = this.generateAlternativeDataForInsertAllBroken(this.state.numbers);\r\n        const siaRes = this.runSimplifiedInsertAll(this.state.numbers);\r\n        const ssRes = this.runSimplifiedSearch(siaRes.keys, this.state.simplifiedHashSearchNumber);\r\n\r\n        const probingVisSlotsCount = 8;\r\n        const probingSimple = this.runProbingSimple(probingVisSlotsCount);\r\n\r\n        return (\r\n            <div className=\"chapter chapter1\">\r\n                <h5>Contents</h5>\r\n                {this.props.contents}\r\n                <h2>Introduction</h2>\r\n                <Subcontainerize>\r\n                    <p>\r\n                        Hi! This is <em>an explorable explanation</em> of Python dictionaries. This page is dynamic and\r\n                        interactive &mdash; you can plug in your data and see how the algorithms work on it.{' '}\r\n                        <HideSpanWhenJsLoaded>(Once the javascript loads)</HideSpanWhenJsLoaded>\r\n                    </p>\r\n                    <p className=\"mb-2\">\r\n                        To start with, let's say we have a simple list of distinct integers (change it if you want - the\r\n                        page will update):\r\n                    </p>\r\n                    <BlockInputToolbar\r\n                        input={PyListInput}\r\n                        inputProps={{\r\n                            allowDuplicates: false,\r\n                            minSize: 1,\r\n                            extraValueValidator: chapter1valueRangeValidator,\r\n                        }}\r\n                        initialValue={this.state.numbers}\r\n                        onChange={this.setter('numbers', true)}\r\n                        bottomBoundary=\".chapter1\"\r\n                        {...this.props}\r\n                    />\r\n                    <p className=\"mb-0\">\r\n                        Python lists are actually arrays &mdash; contiguous chunks of memory. The name \"list\" may be\r\n                        misleading to people who know about double-linked lists but are unfamiliar with Python. You can\r\n                        picture a Python list as a row of slots, where each slot can hold a Python object:\r\n                    </p>\r\n                    <UnnamedListVisualization\r\n                        bp={{data: this.state.numbers}}\r\n                        compensateTopPadding={25}\r\n                        windowWidth={this.props.windowWidth}\r\n                        windowHeight={this.props.windowHeight}\r\n                    />\r\n                    <p>\r\n                        To check if an element is present in a list, we can use the <code>in</code> operator like this:{' '}\r\n                        <code className=\"text-nowrap\">number in simple_list</code>, which returns either{' '}\r\n                        <code>True</code> or <code>False</code>. Under the hood this short snippet does a linear scan.\r\n                        This can be a lot of work. To see this, let's reimplement it in Python.\r\n                    </p>\r\n                    <div className=\"div-p\">\r\n                        Let's say we're looking for the following number in the original list:\r\n                        <PySmallIntInput\r\n                            inline={true}\r\n                            value={this.state.simpleSearchNumber}\r\n                            onChange={this.setter('simpleSearchNumber')}\r\n                            anotherValue={() => anotherValue(this.state.numbers)}\r\n                        />\r\n                    </div>\r\n                    <VisualizedCode\r\n                        code={SIMPLE_LIST_SEARCH}\r\n                        breakpoints={slsRes.bp}\r\n                        formatBpDesc={formatSimpleListSearchBreakpointDescription}\r\n                        stateVisualization={SimpleListSearchStateVisualization}\r\n                        autoplayByDefault={true}\r\n                        {...this.props}\r\n                    />\r\n                    <p>\r\n                        (The visualization is interactive. The buttons allow you to step through the code. Notice here\r\n                        that the time slider is draggable - feel free to rewind the time or move it forward. Also, feel\r\n                        free to mess with the input and the original list - the visualization will update automatically)\r\n                    </p>\r\n                    <p>\r\n                        What's not so great about linear scans? If we have a million distinct numbers, in the worst case\r\n                        scenario, we may need to scan the whole list. But scanning over a few elements is no big deal.\r\n                        We need to have some order and predictability to make the search fast. We need to have some idea\r\n                        of where the searched element is located.\r\n                    </p>\r\n                    <p>\r\n                        A Python dict implementation is basically a scan of a list (but a pretty weird scan). We'll\r\n                        build the actual algorithm and data structure inside Python dictionary step by step, starting\r\n                        with the code above, which is intentionally verbose.{' '}\r\n                    </p>\r\n                    <h2>Chapter 1: searching efficiently in a list</h2>\r\n                    <p>\r\n                        A Python dict is a collection of key-value pairs. And, the most important part of it is handling\r\n                        keys. Keys need to be organized in such a way that efficient searching, inserting and deleting\r\n                        is possible.\r\n                    </p>\r\n                    <p>\r\n                        In this chapter, to keep things simple, we won't have any values, and \"keys\" will just be plain\r\n                        integers. So, the simplified problem is to check if a number is present in a list, but we have\r\n                        to do this{' '}\r\n                        <em>\r\n                            <strong>fast</strong>\r\n                        </em>\r\n                        . We'll tackle the real problem in the following chapters. But for now, bear with me.\r\n                    </p>\r\n                    <p>\r\n                        Accessing a single element by index is very fast. Accessing only a few elements would be fast\r\n                        too. We don't want to be doing a linear scan over the whole list every time we look up a number,\r\n                        so we need to organize our data in a clever way.\r\n                    </p>\r\n                    <p> Here's how. </p>\r\n                    <p>\r\n                        Let's begin by creating a new list of slots. Each slot will either hold a number from the\r\n                        original list or be empty (empty slots will hold <code>None</code>). We'll use the number itself\r\n                        to compute an index of a slot. The simplest way to do this is to take the remainder of{' '}\r\n                        <code>number</code> divided by <code>len(the_list)</code>:{' '}\r\n                        <code className=\"text-nowrap\">number % len(the_list)</code> and put our number in slot with this\r\n                        index. To check if the number is there we could compute the slot index again and see if it is\r\n                        empty.\r\n                    </p>\r\n                    <DynamicSimplifiedInsertAllBrokenOverwrittenExample\r\n                        key=\"overwritten-example-component\"\r\n                        {...siaBrokenRes}\r\n                    />\r\n                    <VisualizedCode\r\n                        code={SIMPLIFIED_INSERT_ALL_BROKEN_CODE}\r\n                        breakpoints={siaBrokenRes.bp}\r\n                        formatBpDesc={formatSimplifiedInsertAllDescription}\r\n                        stateVisualization={SimplifiedInsertBrokenStateVisualization}\r\n                        {...this.props}\r\n                    />\r\n                    <p>\r\n                        To make this approach viable, we need to somehow <em>resolve collisions</em>. Let's do the\r\n                        following: if the slot is already occupied by some other number, we'll just check the slot that\r\n                        comes right after it. And if that slot is empty, we'll put the number there. But, what if that\r\n                        slot is also occupied? Once again, we'll go ahead and check the next slot. We'll keep repeating\r\n                        this process until we finally hit an empty slot. This process is called <em>probing</em>. And\r\n                        because we do it linearly, it is called <em>linear probing</em>. In code, we would write this as{' '}\r\n                        <code className=\"text-nowrap\">(idx + 1) % len(simple_list)</code>, so it wraps around back to\r\n                        the beginning at the last index:\r\n                    </p>\r\n                    <ProbingVisualization\r\n                        slotsCount={probingVisSlotsCount}\r\n                        links={probingSimple.links}\r\n                        adjustTop={-70}\r\n                        fixedHeight={170}\r\n                        {...this.props}\r\n                    />\r\n                    <p>\r\n                        If we make the new list the same size as the original list, we'll have too many collisions. If\r\n                        we make it 10x larger, we'll have very few collisions, but we'll waste a lot of memory. So what\r\n                        size should it be? We want to hit the sweet spot where we don't use up too much memory but also\r\n                        don't have too many collisions. Twice the size of the original list is reasonable.\r\n                    </p>\r\n                    <p>\r\n                        Let's transform the original list using this method (when reading this code, keep in mind that{' '}\r\n                        <code>original_list</code> is a list of <em>distinct numbers</em>, so we don't need to handle\r\n                        duplicates just yet).\r\n                    </p>\r\n                    <VisualizedCode\r\n                        code={SIMPLIFIED_INSERT_ALL_CODE}\r\n                        breakpoints={siaRes.bp}\r\n                        formatBpDesc={formatSimplifiedInsertAllDescription}\r\n                        stateVisualization={SimplifiedInsertStateVisualization}\r\n                        {...this.props}\r\n                    />\r\n                    <p>\r\n                        To search for a number, we retrace all the steps necessary to insert it: we start from the slot{' '}\r\n                        <code className=\"text-nowrap\">number % len(new_list)</code> and do linear probing. We either end\r\n                        up finding the number or hitting an empty slot. The latter situation means that the number is\r\n                        not present.\r\n                    </p>\r\n                    <div className=\"div-p\">\r\n                        Let's say we want to search for\r\n                        <PySmallIntInput\r\n                            inline={true}\r\n                            value={this.state.simplifiedHashSearchNumber}\r\n                            onChange={this.setter('simplifiedHashSearchNumber')}\r\n                            anotherValue={() => anotherValue(this.state.numbers, 0.4)}\r\n                        />\r\n                    </div>\r\n                    <VisualizedCode\r\n                        code={SIMPLIFIED_SEARCH_CODE}\r\n                        breakpoints={ssRes.bp}\r\n                        formatBpDesc={formatSimplifiedSearchDescription}\r\n                        stateVisualization={SimplifiedSearchStateVisualization}\r\n                        {...this.props}\r\n                    />\r\n                    <p>\r\n                        Calculating an index based on the value of the number and resolving collisions by linear probing\r\n                        is an incredibly powerful idea. What we've just implemented is a simple <em>hash table</em>{' '}\r\n                        (more about the term in the next chapter). Python dict uses a hash table internally, albeit a\r\n                        more complex variant.\r\n                    </p>\r\n                    <p>\r\n                        We still haven't discussed adding more elements (what happens if a table overflows?), removing\r\n                        elements (removing an element without a trace would cause a hole to appear, wouldn't this cause\r\n                        the search algorithm to stop prematurely in many cases?), and perhaps most importantly, handling\r\n                        objects other than integers - strings, tuples, floats. We'll do this in the next chapters.\r\n                    </p>\r\n                    <h6>Collision resolution via separate chaining</h6>\r\n                    <p>\r\n                        There is a different method of collision resolution, called{' '}\r\n                        <a href=\"https://en.wikipedia.org/wiki/Hash_table#Separate_chaining\" target=\"_blank\">\r\n                            separate chaining\r\n                        </a>\r\n                        . It is also a good strategy which is commonly used. But that's not how Python resolves\r\n                        collision in dicts, so it is beyond the scope of this explanation.{' '}\r\n                    </p>\r\n                    <h6>A couple of the notes about the explanation</h6>\r\n                    <p>\r\n                        First, this explanation discusses <code>dict</code> as it is implemented in{' '}\r\n                        <a href=\"http://python.org/\" target=\"_blank\">\r\n                            CPython\r\n                        </a>{' '}\r\n                        &mdash; the \"default\" and most common implementation of the Python language (if you are not sure\r\n                        what implementation you use, it is almost certainly CPython). Some other implementations are{' '}\r\n                        <a href=\"https://pypy.org/\" target=\"_blank\">\r\n                            PyPy\r\n                        </a>\r\n                        ,{' '}\r\n                        <a href=\"http://www.jython.org/\" target=\"_blank\">\r\n                            Jython\r\n                        </a>{' '}\r\n                        and{' '}\r\n                        <a href=\"http://ironpython.net/\" target=\"_blank\">\r\n                            IronPython\r\n                        </a>\r\n                        . The way dicts works in each of these implementations may be similar to CPython (in the case of\r\n                        PyPy) or very different from CPython (in the case of Jython).\r\n                    </p>\r\n                    <p>\r\n                        Second, even though dict in CPython is implemented in C, this explanation uses Python for code\r\n                        snippets. The goal of this page is to help you understand the algorithms and the underlying data\r\n                        structures, not the minutiae of the C code (these details are interesting too - they are just\r\n                        are beyond the scope of this explanation).\r\n                    </p>\r\n                </Subcontainerize>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {ProbingVisualization, GenerateProbingLinks} from './probing_visualization';\r\nimport {HashExamples} from './chapter2_hash_table_functions';\r\n\r\nexport function CollisionsTheory() {\r\n    return (\r\n        <>\r\n            <h1>Коллизии в хеш-таблицах</h1>\r\n            <p>\r\n                Хеш-таблица — структура данных, хранящая пары «ключ-значение» или только ключ. Позволяет быстро найти\r\n                ключ и, если есть, связанное с ним значение.\r\n            </p>\r\n            <h2>Как найти нужный элемент с помощью линейного поиска</h2>\r\n            <p>\r\n                Последовательно перебирать все элементы списка, пока не найдется требуемый. В худшем случае — придется\r\n                проверить все элементы. А в среднем — половину.\r\n            </p>\r\n            <h2>Как найти нужный элемент хеш-таблицы</h2>\r\n            <p>\r\n                По ключу понять, с какого места таблицы искать. И начать поиск рядом с нужным элементом. В среднем такой\r\n                поиск займет пару итераций.{' '}\r\n            </p>\r\n            <h2>Пример из реальной жизни</h2>\r\n            <p>\r\n                Представьте, что вы ищете книгу в библиотеке. Если книги стоят в случайном порядке, то придется\r\n                перебирать все по одной, пока не найдете нужную. А если книги стоят в алфавитном порядке, то\r\n                библиотекарь может пойти сразу к нужной полке и перебрать несколько книг, а не всю библиотеку.{' '}\r\n            </p>\r\n            <h2>Устройство простейшей хеш-таблицы</h2>\r\n            <p>\r\n                Простейшая хеш-таблица — это массив из ключей. Индекс ключа вычисляется по самому ключу. Однако у разных\r\n                ключей индекс может совпасть. Такие ситуации называются коллизиями.{' '}\r\n            </p>\r\n            <p>\r\n                В следующей визуализации мы разберемся, как решать коллизии и создадим простейшую хеш-таблицу без потери\r\n                данных.\r\n            </p>\r\n        </>\r\n    );\r\n}\r\n\r\nconst {links: probingLinks} = new GenerateProbingLinks().run(8, '', 'i+1');\r\n\r\nfunction ProbingVisualizationAndDescription() {\r\n    return (\r\n        <>\r\n            {' '}\r\n            <ProbingVisualization slotsCount={8} links={probingLinks} adjustTop={-65} fixedHeight={85} />\r\n            <h2>Алгоритм разрешения коллизий</h2>\r\n            <p>\r\n                Если текущая ячейка занята, то мы проверим следующую. Если занята и она, то проверим следующую за ней. И\r\n                так до тех пор, пока не найдем свободную ячейку.\r\n            </p>\r\n            <p>\r\n                Таблицы с таким способом разрешения коллизий называются хеш-таблицами{' '}\r\n                <a\r\n                    className=\"link\"\r\n                    target=\"_blank\"\r\n                    href=\"https://ru.wikipedia.org/wiki/%D0%A5%D0%B5%D1%88-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0#%D0%9E%D1%82%D0%BA%D1%80%D1%8B%D1%82%D0%B0%D1%8F_%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D1%86%D0%B8%D1%8F\"\r\n                >\r\n                    с открытой адресацией\r\n                </a>\r\n                .{' '}\r\n            </p>\r\n            <p>\r\n                Есть и другой способ разрешения коллизий —{' '}\r\n                <a\r\n                    className=\"link\"\r\n                    target=\"_blank\"\r\n                    href=\"https://ru.wikipedia.org/wiki/%D0%A5%D0%B5%D1%88-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0#%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%B5%D0%BA\"\r\n                >\r\n                    метод цепочек\r\n                </a>\r\n                . В хеш-таблицах с цепочками каждая ячейка является односвязным списком. Такие ячейки позволяют хранить\r\n                сразу несколько элементов.\r\n            </p>\r\n        </>\r\n    );\r\n}\r\n\r\nexport function SimplifiedHashTheory(props) {\r\n    return (\r\n        <>\r\n            <h1>Простейшие хеш-таблицы</h1>\r\n            <p>\r\n                Хеш-таблица — структура данных, хранящая пары «ключ-значение» или только ключ. Позволяет быстро найти\r\n                ключ и, если есть, связанное с ним значение.\r\n            </p>\r\n            <p>\r\n                Простейшая хеш-таблица — это массив из ключей. Индекс ключа вычисляется по самому ключу. Однако у разных\r\n                ключей индекс может совпасть. Такие ситуации называются коллизиями.{' '}\r\n            </p>\r\n            <ProbingVisualizationAndDescription />\r\n            <h2>Производительность и расход памяти</h2>\r\n            <p>\r\n                Чем больше свободного места в хеш-таблице, тем меньше коллизий. В пустой таблице не будет ни одной\r\n                коллизии, а в почти полной — они будут почти наверняка.{' '}\r\n            </p>\r\n            <p>\r\n                Однако чем больше свободного места, тем больше расходуется памяти. Поэтому при использовании хеш-таблиц\r\n                стараются достичь баланса. Таблица должна быть не слишком пустой, но и не слишком заполненной. Проблемы\r\n                с производительностью начиют быть заметны при заполненности на две трети.\r\n            </p>\r\n            <p>На нашей визуализации размер таблицы выбран так, чтобы таблица была заполнена наполовину.</p>\r\n            <h2>Создание хеш-таблицы</h2>\r\n            <p>\r\n                Для создания хеш-таблицы мы последовательно вставляем ключи один за другим. При возникновении коллизии\r\n                переходим к соседней ячейке. Вставляем ключ в первую свободную ячейку.\r\n            </p>\r\n            <h2>Поиск в хеш-таблице</h2>\r\n            <p>\r\n                Поиск ключа аналогичен вставке. Вычисляем индекс и ищем пустой слот, как при разрешении коллизий. Если\r\n                по пути мы не нашли ключа, то его нет в таблице.\r\n            </p>\r\n        </>\r\n    );\r\n}\r\n\r\nexport function HashTheory(props) {\r\n    return (\r\n        <>\r\n            <h1>Хеш-таблицы с открытой адресацией</h1>\r\n            <p>\r\n                Хеш-таблица — структура данных, хранящая пары «ключ-значение» или только ключ. Позволяет быстро найти\r\n                ключ и, если есть, связанное с ним значение.{' '}\r\n            </p>\r\n            <p>\r\n                Хеш-таблица с открытой адресацией представляет себе массив из ячеек, в каждой из которых может быть\r\n                записан ключ. Индекс ключа вычисляется по самому ключу с помощью хеш-функции. У разных ключей индекс\r\n                может совпасть. Такие ситуации называются коллизиями.\r\n            </p>\r\n            <p>\r\n                Задача хеш-функции — по объекту вычислить число по заранее заданному алгоритму. Вычисленное число\r\n                называется хеш-кодом. Алгоритм хеш-фукнции должен помогать равномерно «раскидать» значения по\r\n                хеш-таблице. Поэтому у двух похожих значений (например <code>\"hello\"</code> и <code>\"hello!\"</code>)\r\n                может оказаться совсем разный хеш-код.\r\n            </p>\r\n            <h2>Примеры значений хеш-функций</h2>\r\n            <p>\r\n                В Python есть встроенная хеш-функция <code>hash()</code>. В нашем коде мы используем именно ее.\r\n            </p>\r\n            <HashExamples />\r\n            <h2>Создание хеш-таблицы</h2>\r\n            <p>\r\n                Для создания хеш-таблицы мы последовательно вставляем ключи один за другим. При возникновении коллизии\r\n                переходим к соседней ячейке. Вставляем ключ в первую свободную ячейку.\r\n            </p>\r\n            <h2>Поиск</h2>\r\n            <p>\r\n                Поиск ключа аналогичен вставке. Вычисляем индекс и ищем пустой слот, как при разрешении коллизий. Если\r\n                по пути мы не нашли ключа, то его нет в таблице.\r\n            </p>\r\n            <h2>Удаление</h2>\r\n            <p>\r\n                При удалении ключа мы перезаписываем его специальным значением-плейсхолдером <code>DUMMY</code>. Если мы\r\n                оставим слот пустым, то при поиске другого ключа алгоритм разрешения коллизий может остановиться раньше\r\n                времени.\r\n            </p>\r\n            <h2>Расширение</h2>\r\n            <p>\r\n                Если при работе хеш-таблицы она заполняется, то ее нужно расширить. Однако вычисленные индексы элементов\r\n                зависят от размера таблицы. Это значит, что если изменится размер — изменятся и индексы. Для того, чтобы\r\n                вставленные ключи можно было снова найти, мы создаем новую таблицу и вставляем в нее ключи из старой.\r\n            </p>\r\n        </>\r\n    );\r\n}\r\n\r\nexport function BubbleSortTheory() {\r\n    return (\r\n        <>\r\n            <h1> Сортировка пузырьком</h1>\r\n            <p>\r\n                Сортировка пузырьком — самая простая для понимания и реализации сортировка. Алгоритм по очереди\r\n                просматривает все элементы списка{`\\u00a0`}— сравнивает текущий элемент со следующим и при необходимости\r\n                меняет их местами. Таким образом, алгоритм проходит по списку, пока все элементы не будут упорядочены.\r\n            </p>\r\n            <p>Пузырьковая сортировка является простейшей и эффективна лишь для небольших списков.</p>\r\n        </>\r\n    );\r\n}\r\n\r\nexport function QuickSortTheory() {\r\n    return (\r\n        <>\r\n            <h1> Быстрая сортировка</h1>\r\n            <p>Быстрая сортировка — одна из самых быстрых сортировок. Основана на принципе «Разделяй и властвуй».</p>\r\n            <p>\r\n                На каждой итерации алгоритма выбирается элемент-делитель. Делитель может быть любым элементом массива. В\r\n                нашей реализации выбирается элемент посередине.{' '}\r\n            </p>\r\n            <p>\r\n                Затем элементы распределяются относительно делителя так, чтобы слева были все меньшие элементы, а справа\r\n                {`\\u00a0`}— все большие. Таким образом массив становится несколько более упорядоченным и делитель\r\n                оказывается на нужном месте.\r\n            </p>\r\n            <p>После этого алгоритм повторяется рекурсивно для левой и правой половин.</p>\r\n        </>\r\n    );\r\n}\r\n","import _ from 'lodash';\nimport './mainpage.css';\nimport './styles.css';\nimport classnames from 'classnames';\nimport BigLogo from './images/big-logo.svg';\n\nimport * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport {BrowserRouter as Router, Redirect, Route, Switch, withRouter} from 'react-router-dom';\nimport {getUxSettings, initUxSettings} from './util';\nimport {globalSettings, win} from './store';\nimport {HashBoxesComponent, LineOfBoxesComponent, TetrisFactory} from './code_blocks';\nimport {\n    BUBBLE_SORT_CODE,\n    BubbleSort,\n    formatBubbleSort,\n    formatQuickSort,\n    InsertionSort,\n    QUICK_SORT_CODE,\n    QuickSort,\n} from './new_demos';\nimport {Player} from './player';\nimport {\n    Chapter1_SimplifiedHash,\n    formatSimplifiedInsertAllDescription,\n    formatSimplifiedSearchDescription,\n    SIMPLIFIED_INSERT_ALL_BROKEN_CODE,\n    SIMPLIFIED_INSERT_ALL_CODE,\n    SIMPLIFIED_SEARCH_CODE,\n    SimplifiedInsertBrokenStateVisualization,\n    SimplifiedInsertStateVisualization,\n    SimplifiedSearchStateVisualization,\n} from './chapter1_simplified_hash';\nimport {\n    Chapter2_HashTableFunctions,\n    formatHashCreateNewAndInsert,\n    formatHashRemoveSearch,\n    formatHashResize,\n    HASH_CREATE_NEW_CODE,\n    HASH_REMOVE_CODE,\n    HASH_RESIZE_CODE,\n    HASH_SEARCH_CODE,\n    HashCreateNewStateVisualization,\n    HashNormalStateVisualization,\n    HashResizeStateVisualization,\n} from './chapter2_hash_table_functions';\nimport {BubbleSortTheory, CollisionsTheory, HashTheory, QuickSortTheory, SimplifiedHashTheory} from './theory';\n\nfunction getWindowDimensions() {\n    const width = document.documentElement.clientWidth;\n    const height = document.documentElement.clientHeight;\n    return {width, height};\n}\n\nfunction logViewportStats() {\n    console.log(`DIMENSIONS: window inner: ${window.innerWidth}x${window.innerHeight}`);\n    console.log(\n        `DIMENSIONS: document.documentElement: ${document.documentElement.clientWidth}x${document.documentElement.clientHeight}`\n    );\n    const vv = window.visualViewport;\n    console.log(`DIMENSIONS: visualViewport: ${vv != null ? vv.width + 'x' + vv.height : vv}`);\n\n    const {width, height} = getWindowDimensions();\n    console.log(`DIMENSIONS: used: ${width}x${height}`);\n    // TODO FIXME: this is for debugging only\n    /*const url = `/viewports?wi=${window.innerWidth}x${window.innerHeight}&de=${document.documentElement.clientWidth}x${document.documentElement.clientHeight}&vv=${vv.width}x${vv.height}`;\n    const Http = new XMLHttpRequest();\n    Http.open(\"GET\", url);\n    Http.send();*/\n}\n\n// mainly to prevent addressbar stuff on mobile changing things excessively\nconst SIGNIFICANT_HEIGHT_CHANGE = 0;\nexport class App extends React.Component {\n    constructor() {\n        super();\n\n        this.state = {\n            mounted: false,\n            windowWidth: null,\n            windowHeight: null,\n        };\n    }\n\n    handleWindowSizeChange = () => {\n        logViewportStats();\n        const dimensions = getWindowDimensions();\n        const windowWidth = dimensions.width;\n        const windowHeight = dimensions.height;\n        if (this.state.windowWidth !== windowWidth || this.state.windowHeight !== windowHeight) {\n            console.log('Processing window size change', windowWidth, windowHeight);\n            if (\n                this.state.windowWidth != windowWidth ||\n                this.state.windowHeight > windowHeight ||\n                windowHeight - this.state.windowHeight > SIGNIFICANT_HEIGHT_CHANGE\n            ) {\n                console.log('App size changed from', this.state);\n                this.setState({\n                    windowWidth,\n                    windowHeight,\n                });\n                if (win.width !== windowWidth || win.height !== windowHeight) {\n                    win.setWH(windowWidth, windowHeight);\n                }\n            }\n        }\n    };\n\n    componentDidMount() {\n        const dimensions = getWindowDimensions();\n        const windowWidth = dimensions.width;\n        const windowHeight = dimensions.height;\n        console.log('componentDidMount() window geometry', windowWidth, windowHeight);\n\n        window.addEventListener('resize', _.throttle(this.handleWindowSizeChange, 500));\n        globalSettings.maxCodePlaySpeed = getUxSettings().MAX_CODE_PLAY_SPEED;\n\n        this.setState({\n            windowWidth,\n            windowHeight,\n            mounted: true,\n        });\n        win.setAll(windowWidth, windowHeight, window.scrollY, true);\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('resize', this.handleWindowSizeChange);\n    }\n\n    render() {\n        console.log('App.render()');\n        const {windowWidth, windowHeight} = this.state.mounted ? this.state : {};\n        console.log('Window sizes', windowWidth, windowHeight);\n\n        if (!this.state.mounted) {\n            return <div>Loading...</div>;\n        }\n        return (\n            <Router>\n                <Switch>\n                    <Route path=\"/lesson/:id\">\n                        <Lesson windowWidth={windowWidth} windowHeight={windowHeight} />\n                    </Route>\n                    <Route path=\"/\">\n                        <MainPage windowWidth={windowWidth} windowHeight={windowHeight} />\n                    </Route>\n                </Switch>\n            </Router>\n        );\n    }\n}\n\nfunction runBubbleSort(a, granular = false) {\n    const bs = new BubbleSort();\n    bs.run(a, granular);\n    const bp = bs.getBreakpoints();\n    return {bp};\n}\n\nfunction runInsertionSort(a, granular = false) {\n    const is = new InsertionSort();\n    is.run(a, granular);\n    const bp = is.getBreakpoints();\n    return {bp};\n}\n\nfunction runQuickSort(a) {\n    const qs = new QuickSort();\n    qs.run(a);\n    const bp = qs.getBreakpoints();\n    console.log('quicksort bp', bp);\n    return {bp};\n}\n\nconst InsertionSortVisualisation = TetrisFactory([[LineOfBoxesComponent, [{labels: [null]}, 'a', 'i', undefined]]]);\nexport const MinimalSortVisualisation = TetrisFactory([[HashBoxesComponent, [{labels: [null]}, 'a']]]);\nexport const QuickSortVisualisation = TetrisFactory([\n    [HashBoxesComponent, [{labels: [null]}, 'array', 'left', 'right']],\n]);\nexport const BubbleSortVisualisation = TetrisFactory([[HashBoxesComponent, [{labels: [null]}, 'a', 'j', 'jplus1']]]);\n\nconst chapter1 = new Chapter1_SimplifiedHash();\nconst chapter2 = new Chapter2_HashTableFunctions();\n\n// const GLOBAL_STATE = {\n//     simplifiedHash: /*...*/,\n//     simplifiedKeyToSearch: /* ... */,\n// };\n\n// const inputsToPass = {\n//     inputs:\n// }\n\nconst SIMPLIFIED_HASH_ORIGINAL_LIST_INPUT = {\n    label: 'original_list',\n    type: 'array_int',\n    id: 'simplified-hash-original-list',\n    default: '1 56 50 2 44 25 17 4',\n};\n\nconst SORTS_LIST_INPUT = {\n    label: '',\n    type: 'array_int',\n    id: 'sorts-list',\n    default: '42 13 11 92 27 87 14 67 1 12 44 9 20 7',\n};\n\nconst HASH_FROM_KEYS_INPUT = {\n    label: 'from_keys',\n    type: 'array',\n    id: 'hash-from-keys',\n    default: \"'uname' 'mv' 1 'time' -6 'ps' 'mkdir' 'less'\",\n};\n\nconst LESSONS = {\n    bubble_sort: {\n        mainPagePaneHeaderTitle: 'Сортировка пузырьком',\n        mainPagePaneClassName: 'bubble-sort',\n        playerHeaderTitle: 'Сортировка пузырьком',\n        mobilePlayerHeaderTitle: 'Сортировка пузырьком',\n        getBreakpoints: (numbers) => {\n            return runBubbleSort(\n                numbers.map((n) => n.toNumber()),\n                true\n            ).bp;\n        },\n        inputs: [SORTS_LIST_INPUT],\n        formatBpDesc: formatBubbleSort,\n        stateVisualization: BubbleSortVisualisation,\n        code: BUBBLE_SORT_CODE,\n        resetToZero: true,\n\n        theory: <BubbleSortTheory />,\n    },\n\n    quick_sort: {\n        mainPagePaneHeaderTitle: 'Быстрая',\n        mainPagePaneClassName: 'quick-sort',\n        playerHeaderTitle: 'быструю сортировку',\n        mobilePlayerHeaderTitle: 'Быстрая сортировка',\n        getBreakpoints: (numbers) => {\n            return runQuickSort(numbers.map((n) => n.toNumber())).bp;\n        },\n        inputs: [SORTS_LIST_INPUT],\n        formatBpDesc: formatQuickSort,\n        stateVisualization: QuickSortVisualisation,\n        code: QUICK_SORT_CODE,\n        resetToZero: true,\n\n        theory: <QuickSortTheory />,\n    },\n\n    // linear_search: {\n    //     mainPagePaneHeaderTitle: 'Линейный поиск',\n    //     mainPagePaneClassName: 'linear-search',\n    //     playerHeaderTitle: 'линейный поиск',\n    //     mobilePlayerHeaderTitle: 'Линейный поиск',\n    //     code: SIMPLE_LIST_SEARCH,\n    //     breakpoints: slsRes.bp,\n    //     formatBpDesc: formatSimpleListSearchBreakpointDescription,\n    //     stateVisualization: SimpleListSearchStateVisualization,\n    // },\n\n    simplified_hash_collisions: {\n        mainPagePaneHeaderTitle: 'Коллизии',\n        mainPagePaneClassName: 'simplified-hash-collisions',\n        playerHeaderTitle: 'коллизии в хеш-таблицах',\n        code: SIMPLIFIED_INSERT_ALL_BROKEN_CODE,\n        getBreakpoints: (original_list) => {\n            return chapter1.runSimplifiedInsertAllBroken(original_list).bp;\n        },\n        inputs: [SIMPLIFIED_HASH_ORIGINAL_LIST_INPUT],\n        formatBpDesc: formatSimplifiedInsertAllDescription,\n        stateVisualization: SimplifiedInsertBrokenStateVisualization,\n\n        theory: <CollisionsTheory />,\n    },\n\n    simplified_hash_create: {\n        mainPagePaneHeaderTitle: 'Создание',\n        mainPagePaneClassName: 'simplified-hash-create',\n        playerHeaderTitle: 'создание простейшей хеш-таблицы',\n        code: SIMPLIFIED_INSERT_ALL_CODE,\n        getBreakpoints: (original_list) => chapter1.runSimplifiedInsertAll(original_list).bp,\n\n        inputs: [SIMPLIFIED_HASH_ORIGINAL_LIST_INPUT],\n        formatBpDesc: formatSimplifiedInsertAllDescription,\n        stateVisualization: SimplifiedInsertStateVisualization,\n\n        theory: <SimplifiedHashTheory active=\"simplified_hash_create\" />,\n    },\n\n    simplified_hash_search: {\n        mainPagePaneHeaderTitle: 'Поиск',\n        mainPagePaneClassName: 'simplified-hash-search',\n        playerHeaderTitle: 'поиск в простейшей хеш-таблице',\n        code: SIMPLIFIED_SEARCH_CODE,\n        getBreakpoints: (original_list, number) => {\n            const keys = chapter1.runSimplifiedInsertAll(original_list).keys;\n            return chapter1.runSimplifiedSearch(keys, number).bp;\n        },\n        inputs: [\n            SIMPLIFIED_HASH_ORIGINAL_LIST_INPUT,\n            {\n                label: 'number',\n                type: 'int',\n                id: 'simplified-hash-search-number',\n                default: '25',\n            },\n        ],\n        formatBpDesc: formatSimplifiedSearchDescription,\n        stateVisualization: SimplifiedSearchStateVisualization,\n\n        theory: <SimplifiedHashTheory active=\"simplified_hash_search\" />,\n    },\n\n    hash_create: {\n        mainPagePaneHeaderTitle: 'Создание',\n        mainPagePaneClassName: 'hash-create',\n        playerHeaderTitle: 'создание хеш-таблицы',\n\n        code: HASH_CREATE_NEW_CODE,\n        getBreakpoints: (from_keys) => {\n            return chapter2.runCreateNew(from_keys).bp;\n        },\n        inputs: [HASH_FROM_KEYS_INPUT],\n        formatBpDesc: formatHashCreateNewAndInsert,\n        stateVisualization: HashCreateNewStateVisualization,\n\n        theory: <HashTheory />,\n    },\n\n    hash_search: {\n        mainPagePaneHeaderTitle: 'Поиск',\n        mainPagePaneClassName: 'hash-search',\n        playerHeaderTitle: 'поиск в хеш-таблице',\n        code: HASH_SEARCH_CODE,\n        getBreakpoints: (from_keys, key) => {\n            const {hashCodes, keys} = chapter2.runCreateNew(from_keys);\n            return chapter2.runSearch(hashCodes, keys, key).bp;\n        },\n        inputs: [\n            HASH_FROM_KEYS_INPUT,\n            {\n                label: 'key',\n                type: 'int_str_none',\n                id: 'hash-search-key',\n                default: \"'less'\",\n            },\n        ],\n        formatBpDesc: formatHashRemoveSearch,\n        stateVisualization: HashNormalStateVisualization,\n\n        theory: <HashTheory />,\n    },\n\n    hash_remove: {\n        mainPagePaneHeaderTitle: 'Удаление',\n        mainPagePaneClassName: 'hash-remove',\n        playerHeaderTitle: 'удаление из хеш-таблицы',\n        code: HASH_REMOVE_CODE,\n        getBreakpoints: (from_keys, key) => {\n            const {hashCodes, keys} = chapter2.runCreateNew(from_keys);\n            return chapter2.runRemove(hashCodes, keys, key).bp;\n        },\n        inputs: [\n            HASH_FROM_KEYS_INPUT,\n            {\n                label: 'key',\n                type: 'int_str_none',\n                id: 'hash-remove-key',\n                default: \"'ps'\",\n            },\n        ],\n        formatBpDesc: formatHashRemoveSearch,\n        stateVisualization: HashNormalStateVisualization,\n\n        theory: <HashTheory />,\n    },\n\n    hash_resize: {\n        mainPagePaneHeaderTitle: 'Расширение',\n        mainPagePaneClassName: 'hash-resize',\n        playerHeaderTitle: 'расширение хеш-таблицы',\n        code: HASH_RESIZE_CODE,\n        getBreakpoints: (from_keys) => {\n            const {hashCodes, keys} = chapter2.runCreateNew(from_keys);\n            return chapter2.runResize(hashCodes, keys).bp;\n        },\n        inputs: [HASH_FROM_KEYS_INPUT],\n        formatBpDesc: formatHashResize,\n        stateVisualization: HashResizeStateVisualization,\n\n        theory: <HashTheory />,\n    },\n};\n\nclass LessonPane extends React.Component {\n    constructor() {\n        super();\n        this.state = {\n            navigatingPlayer: false,\n        };\n    }\n\n    render() {\n        const id = this.props.id;\n        const lesson = LESSONS[id];\n        console.log('Lesson pane', id, LESSONS[id]);\n\n        if (this.state.navigatingPlayer) {\n            return <Redirect to={`lesson/${id}`} />;\n        }\n        return (\n            <a\n                href={`/lesson/${id}`}\n                className={classnames('pane', lesson.mainPagePaneClassName)}\n                onClick={this.navigatePlayer}\n            >\n                <h2>{lesson.mainPagePaneHeaderTitle}</h2>\n            </a>\n        );\n    }\n}\n\nconst Lesson = withRouter(\n    class extends React.Component {\n        render() {\n            console.log('withRouter', this.props);\n            const id = this.props.match.params.id;\n            const {windowWidth, windowHeight} = this.props;\n            console.log('Lesson', id, LESSONS[id]);\n            return <Player {...LESSONS[id]} windowWidth={windowWidth} windowHeight={windowHeight} lessonId={id} />;\n        }\n    }\n);\n\nexport class MainPage extends React.Component {\n    render() {\n        return (\n            <div className=\"fluid-body\">\n                <div className=\"frontpage\">\n                    <div className=\"header\">\n                        <img src={BigLogo} alt=\"logo\" />\n                    </div>\n\n                    <div className=\"section\">\n                        <h1>Сортировки</h1>\n                        <div className=\"lesson-pane-stack\">\n                            <LessonPane id=\"bubble_sort\" />\n                            <div className=\"placeholder\" />\n                        </div>\n                        <div className=\"lesson-pane-stack\">\n                            <div className=\"placeholder\" />\n                            <LessonPane id=\"quick_sort\" />\n                        </div>\n                    </div>\n\n                    <div className=\"section\">\n                        <h1>Простейшие хеш-таблицы</h1>\n                        <div className=\"lesson-pane-stack\">\n                            <LessonPane id=\"simplified_hash_collisions\" />\n                            <div className=\"placeholder\" />\n                        </div>\n                        <div className=\"lesson-pane-stack\">\n                            <div className=\"placeholder\" />\n                            <LessonPane id=\"simplified_hash_create\" />\n                        </div>\n                        <div className=\"lesson-pane-stack\">\n                            <LessonPane id=\"simplified_hash_search\" />\n                            <div className=\"placeholder\" />\n                        </div>\n                    </div>\n\n                    <div className=\"section\">\n                        <h1>Хеш-таблицы с открытой адресацией</h1>\n                        <div className=\"lesson-pane-stack\">\n                            <LessonPane id=\"hash_create\" />\n                            <div className=\"placeholder\" />\n                        </div>\n                        <div className=\"lesson-pane-stack\">\n                            <div className=\"placeholder\" />\n                            <LessonPane id=\"hash_search\" />\n                        </div>\n                        <div className=\"lesson-pane-stack\">\n                            <LessonPane id=\"hash_remove\" />\n                            <div className=\"placeholder\" />\n                        </div>\n                        <div className=\"lesson-pane-stack\">\n                            <div className=\"placeholder\" />\n                            <LessonPane id=\"hash_resize\" />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport function initAndRender() {\n    if (typeof window !== 'undefined') {\n        initUxSettings();\n\n        window.addEventListener('load', () => {\n            logViewportStats();\n            const root = document.getElementById('root');\n            ReactDOM.render(<App />, root);\n        });\n    }\n}\n","export default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTE3MCIgaGVpZ2h0PSIyNDgiIHZpZXdCb3g9IjAgMCAxMTcwIDI0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEzNy45OTQgMjI4LjA3NUgxNjguMDI2VjE1NC4zMjJIMTg3LjMwM0MyMDEuNzM3IDE1NC4zMjIgMjEzLjI4NCAxNDkuMjQ3IDIyMS45NDUgMTM5LjA5NkMyMzAuNjA1IDEyOC45NDYgMjM0LjkzNiAxMTIuMzIzIDIzNC45MzYgODkuMjI4NUMyMzQuOTM2IDYyLjk2NzcgMjMwLjgzOCA0NS42NDY3IDIyMi42NDMgMzcuMjY1NkMyMTQuNTQyIDI4Ljg4NDUgMjAzLjQ2IDI0LjY5NCAxODkuMzk4IDI0LjY5NEgxMzcuOTk0VjIyOC4wNzVaTTE2OC4wMjYgMTE5LjY4VjYxLjAxMjFIMTg0LjM3QzE5MS45MTMgNjAuOTE5IDE5Ny4yMjEgNjEuODUwMiAyMDAuMjk0IDYzLjgwNThDMjAzLjQ2IDY1LjY2ODMgMjA1LjA0MyA3NC43NDc4IDIwNS4wNDMgOTEuMDQ0NEMyMDUuMDQzIDEwMy42MTYgMjAzLjUwNiAxMTEuNTMyIDIwMC40MzMgMTE0Ljc5MUMxOTcuMzYgMTE4LjA1IDE5MS45NTkgMTE5LjY4IDE4NC4yMyAxMTkuNjhIMTY4LjAyNlpNMjA5Ljc5MiAyMjguMDc1SDI0Mi42MThMMjE3LjA1NiAxMzguNTM3TDE4NC45MjggMTM1LjMyNUwyMDkuNzkyIDIyOC4wNzVaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMjQzLjk1NCAyMjguMDc1SDI4Mi43ODZMMzE4LjY4NSAyNC42OTRIMjc5Ljg1M0wyNDMuOTU0IDIyOC4wNzVaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMzIzLjY1MiA2My4zODY3SDQxMi4zNTJWMjI4LjA3NUg0NDguMjUyVjYzLjM4NjdINTM2Ljk1MlYyNC42OTRIMzIzLjY1MlY2My4zODY3WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTUzMS4wMjMgMjI4LjA3NUg2MDguMTNMNjEwLjIyNSAxNDguNzM0QzYxMC4yMjUgMTQ3LjcxIDYxMC4yNzEgMTQxLjk4MyA2MTAuMzY1IDEzMS41NTNDNjEwLjQ1OCAxMjEuMDMgNjEwLjUwNCAxMTUuNDg5IDYxMC41MDQgMTE0LjkzMUg2MTEuNDgyQzYxMS42NjggMTE1LjQ4OSA2MTIuMDg3IDEyMS4wMyA2MTIuNzM5IDEzMS41NTNDNjEzLjQ4NCAxNDIuMDc2IDYxMy45MDMgMTQ3LjgwMyA2MTMuOTk2IDE0OC43MzRMNjI2LjE0OSAyMjguMDc1SDY5Ni41NUw3MDkuNDAxIDE0OS44NTJDNzA5LjQ5NCAxNDkuMTA3IDcwOS45MTMgMTQzLjM4IDcxMC42NTggMTMyLjY3MUM3MTEuNDAzIDEyMS45NjEgNzExLjg2OSAxMTUuODE1IDcxMi4wNTUgMTE0LjIzMkg3MTMuMTczQzcxMy4xNzMgMTE1LjgxNSA3MTMuMDggMTIxLjk2MSA3MTIuODkzIDEzMi42NzFDNzEyLjggMTQzLjM4IDcxMi43NTQgMTQ5LjE1MyA3MTIuNzU0IDE0OS45OTJMNzE0LjcwOSAyMjguMDc1SDc4Mi41OTZMNzY5LjMyNiAyNC42OTRINjc3LjEzNEw2NTcuOTk3IDk4LjE2ODNDNjU3LjcxOCA5OS4wOTk2IDY1Ny4zNDUgMTAwLjY4MyA2NTYuODggMTAyLjkxOEM2NTYuNDE0IDEwNS4wNTkgNjU2LjEzNSAxMDYuMzE3IDY1Ni4wNDIgMTA2LjY4OUg2NTUuNjIyQzY1NS40MzYgMTA2LjMxNyA2NTUuMDY0IDEwNS4wMTMgNjU0LjUwNSAxMDIuNzc4QzY1NC4wMzkgMTAwLjQ1IDY1My42NjcgOTguOTEzMyA2NTMuMzg4IDk4LjE2ODNMNjM0Ljk0OSAyNC42OTRINTQ0LjI5M0w1MzEuMDIzIDIyOC4wNzVaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNzg1LjYwOCAxMjMuMTcyQzc4NS42MDggMTU4LjU1OSA3OTkuMTExIDE4NS42MTEgODI2LjExNyAyMDQuMzI5Qzg1My4yMTUgMjIyLjk1NCA4ODYuOTI2IDIzMi4yNjYgOTI3LjI0OSAyMzIuMjY2Qzk2Ny41NzEgMjMyLjI2NiAxMDAxLjMzIDIyMi45NTQgMTAyOC41MiAyMDQuMzI5QzEwNTUuODEgMTg1LjYxMSAxMDY5LjQ1IDE1OC41NTkgMTA2OS40NSAxMjMuMTcyVjEyNi45NDNDMTA2OS40NSA5Mi44NjAzIDEwNTUuODEgNjYuNTk5NSAxMDI4LjUyIDQ4LjE2MTFDMTAwMS4zMyAyOS43MjI2IDk2Ny41NzEgMjAuNTAzNCA5MjcuMjQ5IDIwLjUwMzRDODg2LjkyNiAyMC41MDM0IDg1My4yMTUgMjkuNzIyNiA4MjYuMTE3IDQ4LjE2MTFDNzk5LjExMSA2Ni41OTk1IDc4NS42MDggOTIuODYwMyA3ODUuNjA4IDEyNi45NDNWMTIzLjE3MlpNODIyLjQ4NSAxMjQuMTVWMTI2LjgwNEM4MjIuNDg1IDEwNC41NDcgODMyLjI2MyA4Ny40MTI2IDg1MS44MTkgNzUuMzk5N0M4NzEuNDY4IDYzLjM4NjcgODk2LjcwNCA1Ny40MjY4IDkyNy41MjggNTcuNTJDOTU4LjI1OSA1Ny43MDYyIDk4My40NDkgNjMuNzU5MiAxMDAzLjEgNzUuNjc5QzEwMjIuNzUgODcuNTA1NyAxMDMyLjU3IDEwNC41OTQgMTAzMi41NyAxMjYuOTQzVjEyNC40MjlDMTAzMi41NyAxNDcuNDMxIDEwMjIuNyAxNjUuMTcxIDEwMDIuOTYgMTc3LjY0OUM5ODMuMjE2IDE5MC4xMjggOTU4LjA3MiAxOTYuMjc0IDkyNy41MjggMTk2LjA4OEM4OTYuODkgMTk1Ljk5NCA4NzEuNyAxODkuODAyIDg1MS45NTggMTc3LjUwOUM4MzIuMzA5IDE2NS4xMjQgODIyLjQ4NSAxNDcuMzM3IDgyMi40ODUgMTI0LjE1WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwNjEuMTYgMjQ3LjY1N0MxMDk3LjAxIDI0OC42ODIgMTEyMS43MyAyNDMuODg2IDExMzUuMzMgMjMzLjI3QzExNDkuMDIgMjIyLjc0NyAxMTUyLjMyIDIwNi40OTcgMTE0NS4yNSAxODQuNTJMMTEzOC4yNiAxNjQuNDA1QzExMzUuMzcgMTU0LjkwNiAxMTM2Ljk2IDE0OC42MiAxMTQzLjAxIDE0NS41NDdDMTE0OS4wNiAxNDIuNDc0IDExNTcuNzcgMTQwLjkzOCAxMTY5LjEzIDE0MC45MzhWMTA2Ljg1NUMxMTU3Ljc3IDEwNi44NTUgMTE0OS4wMiAxMDUuMzE4IDExNDIuODcgMTAyLjI0NUMxMTM2LjcyIDk5LjE3MiAxMTM1LjE0IDkyLjkzMjcgMTEzOC4xMiA4My41MjcyTDExNDUuMzkgNjMuNDEyNkMxMTUyLjU2IDQxLjQzNTQgMTE0OS4yNSAyNS4xMzg4IDExMzUuNDcgMTQuNTIyOEMxMTIxLjc4IDMuOTA2NzEgMTA5Ny4wMSAtMC44ODkxNDIgMTA2MS4xNiAwLjEzNTIxNVYzMi42ODE4QzEwODQuOTkgMzIuNjgxOCAxMTAwLjMxIDM1LjY2MTggMTEwNy4xMSA0MS42MjE3QzExMTMuOTEgNDcuNDg4NSAxMTE1LjE3IDU3LjAzMzYgMTExMC44OCA3MC4yNTcxTDExMDMuNzYgOTAuMzcxOEMxMTAxLjUyIDk4LjE5NDIgMTEwMi4xMyAxMDUuMjI1IDExMDUuNTggMTExLjQ2NEMxMTA5LjExIDExNy43MDQgMTExNS40IDEyMS44NDcgMTEyNC40MyAxMjMuODk2QzExMTUuNCAxMjUuOTQ1IDExMDkuMDcgMTMwLjEzNSAxMTA1LjQ0IDEzNi40NjhDMTEwMS45IDE0Mi43MDcgMTEwMS4zOCAxNDkuNjkxIDExMDMuOSAxNTcuNDIxTDExMTAuODggMTc3LjUzNUMxMTE1LjE3IDE5MC44NTIgMTExMy45MSAyMDAuNDQ0IDExMDcuMTEgMjA2LjMxQzExMDAuMzEgMjEyLjI3IDEwODQuOTkgMjE1LjI1IDEwNjEuMTYgMjE1LjI1VjI0Ny42NTdaIiBmaWxsPSIjRkY3MDAxIi8+CjxwYXRoIGQ9Ik0xMDguMTE2IDI0Ny42NThWMjE1LjExMUM4NC4xODM2IDIxNS4xMTEgNjguODE4MiAyMTIuMTMxIDYyLjAyMDIgMjA2LjE3MUM1NS4zMTUzIDIwMC4zMDQgNTQuMDU4MSAxOTAuNzU5IDU4LjI0ODcgMTc3LjUzNkw2NS4zNzI2IDE1Ny40MjFDNjcuODg3IDE0OS42OTIgNjcuMzI4MiAxNDIuNzA4IDYzLjY5NjQgMTM2LjQ2OEM2MC4wNjQ2IDEzMC4xMzYgNTMuNzMyMiAxMjUuOTQ1IDQ0LjY5OTIgMTIzLjg5N0M1My43MzIyIDEyMS44NDggNjAuMTExMiAxMTcuNjU3IDYzLjgzNjEgMTExLjMyNUM2Ny41NjEgMTA0Ljk5MyA2OC4wNzMyIDk4LjAwODMgNjUuMzcyNiA5MC4zNzIyTDU4LjM4ODQgNzAuMjU3NUM1NC4xMDQ3IDU3LjAzNCA1NS4zMTUzIDQ3LjQ4ODggNjIuMDIwMiA0MS42MjIxQzY4LjgxODIgMzUuNjYyMiA4NC4xODM2IDMyLjY4MjIgMTA4LjExNiAzMi42ODIyVjAuMTM1NTk5QzcyLjI2MzggLTAuNzk1NjM2IDQ3LjQ5MjkgNC4wNDY3OCAzMy44MDM4IDE0LjY2MjhDMjAuMjA3OCAyNS4xODU4IDE2Ljk0ODUgNDEuMzg5MyAyNC4wMjU4IDYzLjI3MzNMMzEuMDEwMSA4My41Mjc2QzMzLjg5NjkgOTIuOTMzMSAzMi4yNjczIDk5LjE3MjMgMjYuMTIxMSAxMDIuMjQ1QzIwLjA2ODEgMTA1LjMxOCAxMS4zNjExIDEwNi44NTUgMCAxMDYuODU1VjE0MC45MzhDMTEuMzYxMSAxNDAuOTM4IDIwLjExNDcgMTQyLjUyMSAyNi4yNjA4IDE0NS42ODdDMzIuNDA2OSAxNDguNzYxIDMzLjk5IDE1NC45NTMgMzEuMDEwMSAxNjQuMjY2TDIzLjg4NjIgMTg0LjUyQzE2LjYyMjUgMjA2LjQ5NyAxOS44ODE4IDIyMi43NDcgMzMuNjY0MSAyMzMuMjdDNDcuNDQ2NCAyNDMuODg2IDcyLjI2MzggMjQ4LjY4MiAxMDguMTE2IDI0Ny42NThaIiBmaWxsPSIjRkZGRjY0Ii8+Cjwvc3ZnPgo=\"","import {initAndRender} from './app';\r\nimport {NewDemos} from './new_demos.js';\r\n\r\nif (typeof window !== 'undefined') {\r\n    initAndRender();\r\n}\r\n"],"sourceRoot":""}